var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),defineProperty=function(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a},_extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},DropDownFormatter=function(){function a(){classCallCheck(this,a)}return createClass(a,null,[{key:"isEmpty",value:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}},{key:"formatData",value:function(b,c,d,e,f,g){e=e?" "+e.trim():"";var h=c||"";try{if(b.constructor!==Object)throw"wrong data format";for(var i in b){if(null===b[i])return{data:null};var j=i,k=b[j],l={};for(var m in k){var n=n||{},o=m.replace("a",h);a.isEmpty(n)&&(l[o]={});var p,q,r=k[m],s={},t="",u="",v="",w=0;for(var x in r){if("object"!==_typeof(r[x])){if(k[m].labelType&&"s"===k[m].labelType.toLowerCase())if(d){var y=(g?h:"")+m.slice(1);n[y]||(n[y]={}),n[y][k[m].label]={},p=k[m].label,q=y}else n[k[m].label]={},p=k[m].label;else p?d?n[q][p][h+k[m].value]=k[m].label+e:n[p]["#"+k[m].value]=k[m].label+e:l[o]=r.label+e;break}"s"===r[x].labelType.toLowerCase()?(s[r[x].label]={},t=r[x].label,x.indexOf("-")>0&&(u=x,v=r[x].label)):t?(u&&(s[t][a.labelPrefix+u.slice(1,u.indexOf("-"))+w]=v,u="",v="",w++),s[t][h+r[x].value]=r[x].label):s[h+r[x].value]=r[x].label}a.isEmpty(s)?l=a.isEmpty(n)?l:n:l[o]=s}var z=j.replace(/\-/,"&").split("&");if(!f)try{if(!z[1]){var A="";throw"version is missing"}A=z[1].split("-")[1]}catch(a){return a}return{data:l,version:A}}}catch(a){return a}}},{key:"formatCityEntityData",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dd",c=a.CITY_ENTITY,d={},e={},f=[],g=[];return Object.keys(c).forEach(function(a){var b=c[a];"S"===b.labelType?(f.push(b),d[b.id]=b):"L"===b.labelType&&g.push(b)}),f.sort(function(a,b){return a.label<b.label?-1:1}),f.forEach(function(a){e[b+a.value]=defineProperty({},a.label,{})}),g.forEach(function(a){var c=d[a.parentId],f=b+c.value,g=c.label;e[f][g][b+a.value]=a.label}),{data:e}}},{key:"formatLocation",value:function(a){var b=_extends({},a);return b.a185&&b.a185.Other&&(delete b.a185.Other.dd0,delete b.a185.Other.dd5000,delete b.a185.Other.dd5001,delete b.a185.Other.dd5002,delete b.a185.Other.dd5003,delete b.a185.Other.dd5004,delete b.a185.Other["dd68','69','70','71','72','73','74','75','76','77','78','79','80','81','93','82','145','83','84','85','86','87','88','89','5005"]),_extends({},{dd0:"Any",dd5000:"Anywhere in India",dd5001:"Anywhere in Northern India",dd5002:"Anywhere in South India",dd5003:"Anywhere in West India",dd5004:"Anywhere in East India","dd68','69','70','71','72','73','74','75','76','77','78','79','80','81','93','82','145','83','84','85','86','87','88','89','5005":"Any International Location"},b)}},{key:"formatFArea",value:function(a,b){function c(a){return a?Object.keys(a).reduce(function(b,c){return"[object Object]"===Object.prototype.toString.call(a[c])?b=_extends(b,a[c]):b[c]=a[c],b},{}):""}return b&&a?Object.keys(b).reduce(function(d,e){return d[e+"|X|"+b[e]]=c(a[e]),d},{}):null}},{key:"formatCourseData",value:function(a,b){function c(a,b){return a?Object.keys(a).reduce(function(c,d){return c[b+"."+d]=a[d],c},{}):""}return a&&b?Object.keys(a).reduce(function(d,e){return d[e+"|X|"+a[e]]=c(b[e],e),d},{}):null}},{key:"formatEntityData",value:function(a,b,c,d){for(var e={},f=b||"",g=c||"",h=0;h<a.length;h++){var i=a[h],j=i.label,k=(d?f:"")+i.id,l=i.city;if(i.customGroup&&i.customGroup.length>0)for(var m=i.customGroup,n=0;n<m.length;n++)9508==m[n].id&&l.splice(3,0,m[n]),9509==m[n].id&&l.splice(6,0,m[n]);if(void 0==k||void 0==j||void 0==l||!l.length)break;e[k]={},e[k][j]={};for(var o=0;o<l.length;o++){var p=e[k][j],q=l[o],r=q.label,s=q.id;void 0!=r&&void 0!=s&&(s=f.concat(s).concat(g),p[s]=r)}}return{data:e}}},{key:"formatAnyWhereLocData",value:function(a,b){var c={},d=b||"";c.dd0="Any";for(var e=0;e<a.length;e++){var f=a[e],g=f.label,h=f.id;void 0!=h&&void 0!=g&&(h=d.concat(h),c[h]=g)}return{data:c}}},{key:"formatEntityVersionData",value:function(a){for(var b={},c=0;c<a.length;c++){var d=a[c].entity,e=a[c].version;b[d]=e}return b}}]),a}();DropDownFormatter.labelPrefix="Label_";var TAXONOMY_CONFIG={METRO_LOC:{LABEL:"METRO_LOCATION",URL:"https://www.naukri.com/servicegateway-central-services/central-entity-services/v0/entity/group/location?withData=true&groupIds=9507"},ANYWHERE_LOC:{LABEL:"ANYWHERE_LOCATION",URL:"https://www.naukri.com/servicegateway-central-services/central-entity-services/v0/entity/group/location?withData=false&groupIds=9501,9502,9503,9504,9505,9506"},CITYSTATE_LOC:{LABEL:"CITY_ENTITY",URL:"https://apis.naukri.com/central_services/dropdowns/v0/city_entity?appid=2&languageId=1&prefix=a&formatType=nested"},COUTRY_LOC:{LABEL:"COUNTRY_ENTITY",URL:"https://apis.naukri.com/central_services/dropdowns/v0/country_entity?appid=2&languageId=1&prefix=a&formatType=nested"},CITY_LOC:{LABEL:"CITY",URL:"https://apis.naukri.com/central_services/dropdowns/v0/city?appid=2&languageId=1&prefix=a&formatType=nested"},PREFFERED_LOC_CITY:{LABEL:"PREFFERED_CITY",URL:"https://apis.naukri.com/central_services/dropdowns/v0/city_entity?appid=13&languageId=1&prefix=a&formatType=nested"}},DropDownService=function(){function a(){classCallCheck(this,a),this.versions={},this.isDdDataRequested={},this.shouldCallVersionAPI=!1,this.queues={},this.queuesItemId=0}return createClass(a,[{key:"_makeAjaxCall",value:function(a,b){var c={};return b&&(c={AppId:112,SystemId:"entity",Accept:"application/json","Content-Type":"application/json",withCredentials:!1}),new Promise(function(b,d){$.ajax({url:a,headers:c,xhrFields:{withCredentials:!1},method:"GET",success:function(a){b(a)},error:function(a){d({})}})})}},{key:"_publish",value:function(a,b){var c=this;if(!this.queues[a])return!1;var d=this.queues[a];return setTimeout(function(){d.forEach(function(c){try{c.callback(b,a,c.id)}catch(a){}}),c.queues[a]=[]},0),!0}},{key:"_subscribe",value:function(a,b){this.queues[a]||(this.queues[a]=[]);var c=(this.queuesItemId++).toString();return this.queues[a].push({id:c,callback:b}),c}},{key:"unsubscribe",value:function(a,b){return!(!this.queues[b]||!this.queues[b].length)&&(this.queues[b]=this.queues[b].filter(function(b){return b.id!==a}),!0)}},{key:"_fetchDropDownData",value:function(a,b,c,d,e,f){var g=this,h="https://apis.naukri.com/central_services/dropdowns/v0/"+a+"/list?appid=2&languageId=1&prefix=a&formatType=nested&srcAppId=112";if(this._subscribe(a,e),f)switch(a){case TAXONOMY_CONFIG.METRO_LOC.LABEL:h=TAXONOMY_CONFIG.METRO_LOC.URL;break;case TAXONOMY_CONFIG.ANYWHERE_LOC.LABEL:h=TAXONOMY_CONFIG.ANYWHERE_LOC.URL;break;case TAXONOMY_CONFIG.CITYSTATE_LOC.LABEL:h=TAXONOMY_CONFIG.CITYSTATE_LOC.URL;break;case TAXONOMY_CONFIG.COUTRY_LOC.LABEL:h=TAXONOMY_CONFIG.COUTRY_LOC.URL;break;case TAXONOMY_CONFIG.CITY_LOC.LABEL:h=TAXONOMY_CONFIG.CITY_LOC.URL;break;case TAXONOMY_CONFIG.PREFFERED_LOC_CITY.LABEL:h=TAXONOMY_CONFIG.PREFFERED_LOC_CITY.URL}if(!this.isDdDataRequested[a]){var i=this._makeAjaxCall(h,f);this.isDdDataRequested[a]=!0,i.then(function(e){var h=null;if(f)switch(a){case TAXONOMY_CONFIG.METRO_LOC.LABEL:h=DropDownFormatter.formatEntityData(e,b,"#",!0);break;case TAXONOMY_CONFIG.ANYWHERE_LOC.LABEL:h=DropDownFormatter.formatAnyWhereLocData(e,b);break;case TAXONOMY_CONFIG.PREFFERED_LOC_CITY.LABEL:case TAXONOMY_CONFIG.CITY_LOC.LABEL:h=DropDownFormatter.formatData(e,b,c,null,!0,!0);break;case TAXONOMY_CONFIG.CITYSTATE_LOC.LABEL:h=DropDownFormatter.formatCityEntityData(e,b);break;case TAXONOMY_CONFIG.COUTRY_LOC.LABEL:h=DropDownFormatter.formatData(e,b,c,null,!0)}else h=DropDownFormatter.formatData(e,b,c),d&&(h.data=DropDownFormatter.formatLocation(h.data));g.isDdDataRequested[a]=!1,g._cacheData(a,h),g._publish(a,h)}).catch(function(){g.isDdDataRequested[a]=!1,g._publish(a,{data:null})})}}},{key:"getDropdownData",value:function(a,b,c,d,e,f){var g=this._getCachedData(a),h=this._getCachedData("DDBaseVersions");return f?h&&this.versions[a]==h[a]&&g&&g.data?void c(g):(h=$.extend({},h),h[a]=this.versions[a],this._cacheData("DDBaseVersions",h),this._fetchDropDownData(a,b,d,e,c,f)):g&&g.data?this._isVersionSame(g.version,a)?void c(g):this._fetchDropDownData(a,b,d,e,c,f):void this._fetchDropDownData(a,b,d,e,c,f)}},{key:"getDDVersions",value:function(a){var b=this._getCachedData("DDversionsNew");if(b)return this.versions=b,void a(b);this._fetchDDVersions(a)}},{key:"_fetchDDVersions",value:function(a){var b=this;if(this._subscribe("versionQueue",a),!this.shouldCallVersionAPI){var c=this._makeAjaxCall("https://apis.naukri.com/central_services/dropdowns/v0/version"),d=this._makeAjaxCall("https://www.naukri.com/servicegateway-central-services/central-entity-services/v0/entity/version",!0);this.shouldCallVersionAPI=!0,Promise.all([c,d]).then(function(a){var c=a[0],d=DropDownFormatter.formatEntityVersionData(a[1]),e=b._getCustomVersion(d);data=_extends({},c,e);var f=b._getMidnightDate();b._cacheData("DDversionsNew",data,f),b.versions=data,b.shouldCallVersionAPI=!1,b._publish("versionQueue",data)}).catch(function(a){b.shouldCallVersionAPI=!1,b._publish("versionQueue",{})})}}},{key:"formatFArea",value:function(a,b){return DropDownFormatter.formatFArea(a,b)}},{key:"formatCourseData",value:function(a,b){return DropDownFormatter.formatCourseData(a,b)}},{key:"_isVersionSame",value:function(a,b){return this.versions[b]===a}},{key:"_getCachedData",value:function(a){return rdxCache.getItem(a+userId)}},{key:"_cacheData",value:function(a,b,c){rdxCache.setItem(a+window.userId,b,c?{expirationAbsolute:c}:null)}},{key:"_getCustomVersion",value:function(a){return{METRO_LOCATION:a.group_location,ANYWHERE_LOCATION:a.group_location}}},{key:"_getMidnightDate",value:function(){var a=new Date;a.setDate(a.getDate()+1);var b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear();return new Date(c+"/"+b+"/"+d)}},{key:"getAllDDData",value:function(){var a=this;return[new Promise(function(b){a.getDropdownData("LOCATION","dd",function(a){b(a.data)},!0,!0)}),new Promise(function(b){a.getDropdownData("INDUSTRY_TYPE","dd",function(a){b(a.data)})}),new Promise(function(b){var c=new Promise(function(b){a.getDropdownData("FA_ROLE","",function(a){b(a)})}),d=new Promise(function(b){a.getDropdownData("FAREA","",function(a){b(a)})});Promise.all([c,d]).then(function(c){var d=[c[0].data,c[1].data],e=a.formatFArea(d[0],d[1]);b(e)})}),new Promise(function(b){var c=new Promise(function(b){a.getDropdownData("PPGCOURSE","",function(a){b(a)})}),d=new Promise(function(b){a.getDropdownData("PPGSPEC","",function(a){b(a)})});Promise.all([c,d]).then(function(c){var d=[c[0].data,c[1].data],e=a.formatCourseData(d[0],d[1]);b(e)})}),new Promise(function(b){var c=new Promise(function(b){a.getDropdownData("PGCOURSE","",function(a){b(a)})}),d=new Promise(function(b){a.getDropdownData("PGSPEC","",function(a){b(a)})});Promise.all([c,d]).then(function(c){var d=[c[0].data,c[1].data],e=a.formatCourseData(d[0],d[1]);b(e)})}),new Promise(function(b){var c=new Promise(function(b){a.getDropdownData("UGCOURSE","",function(a){b(a)})}),d=new Promise(function(b){a.getDropdownData("UGSPEC","",function(a){b(a)})});Promise.all([c,d]).then(function(c){var d=[c[0].data,c[1].data],e=a.formatCourseData(d[0],d[1]);b(e)})})]}}]),a}();window.dropDownService=new DropDownService;