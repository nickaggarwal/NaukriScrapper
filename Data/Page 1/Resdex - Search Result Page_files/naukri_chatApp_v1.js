webpackJsonp([0],{"+SiN":function(e,t,n){"use strict";function i(e){if(!(e instanceof Date))return"";var t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return e.getDate()+" "+t[e.getMonth()]}function r(e){return e instanceof Date?i(e)+"' "+e.getFullYear().toString().substr(-2):""}function o(e){if(!(e instanceof Date))return"before";var t=new Date;return t.getFullYear()!==e.getFullYear()||t.getMonth()!==e.getMonth()?"before":t.getDate()-e.getDate()==1?"yesterday":t.getDate()-e.getDate()==0?"today":"before"}function s(e){if(!(e instanceof Date))return"";var t=e.getHours(),n=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),i="am";return t>=12&&(i="pm"),t%=12,0===t&&(t=12),t+":"+n+" "+i}function a(e){if(!(e instanceof Date))return"";var t=new Date,n=Math.abs(e-t)/1e3,i=void 0,r=void 0;return n<2700?i="now":n/60<60?(r=Math.round(n/60),i=0===r?"1 minute":r+" minute",i=r>1?i+"s":i):(r=Math.round(n/3600),i=0===r?"1 hour":r+" hour",i=r>1?i+"s":i),i}function c(e){if(!e)return[];var t=[];return Object.keys(e).forEach(function(n){t.push(e[n])}),t}function l(e,t){if(!(e instanceof Date&&t instanceof Date))return-1;var n=e-t;return n=Math.round(n/864e5)}function u(e){if("string"==typeof e&&e){for(var t=[],n=0;n<localStorage.length;n++)localStorage.key(n).substring(0,e.length)==e&&t.push(localStorage.key(n));for(var n=0;n<t.length;n++)localStorage.removeItem(t[n])}}function h(e){return"string"!=typeof e?null:e?e.split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.toLowerCase().slice(1)}).join(" "):null}t.d=i,t.f=r,t.c=o,t.b=s,t.g=a,t.i=c,t.e=l,t.a=u,t.h=h,n("/CmL"),window.interfaces.Virtual},"+uDm":function(e,t,n){"use strict";e.exports={STARTED:"started",PAUSED:"paused",FINISHED:"finished"}},0:function(e,t){},"0VJh":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("0M3w"),a=n("+SiN"),c=(n("NMAg"),n("HOS4")),l=n("p150"),u=n("25fZ"),h=n("t+iR"),d=(n.n(h),n("sgBt")),p=n("sQD6"),f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y=window.interfaces.Virtual,g="data-chat-open",v="data-trigger-chat-window",_="data-chat-askcv",m=0,b="lastCvRequestedDate",E="barredTillTime",w=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n));return o.client=u.a.getClient(),o._isCurrentUser=localStorage.getItem(_edgeChatConfig.UID+"_current_user"),o.addTooltipOnClick=function(){var e=document.getElementById("noCvAttached"),t=Object(p.i)(window.cvUploadDate);e&&isNaN(t)&&o.isCvRequestsAvailable()&&e.addEventListener("click",function(){var e=window.name||"Candidate";$(".initiate-chat").attr(""+_,!0),o.addToolTip("["+g+"]","<div class='chatMsgHover'>\n                                <span></span>\n                                "+e+" has not uploaded a CV. Send a message now to request for their CV.\n                            </div>")})},o.addToolTip=function(e,t){return $(e).append(t)},o.genarateToolTipMessage=function(e){var t=localStorage.getItem("chat-tooltip-time-"+e.userId);if(t){var n=new Date,i=new Date(t);Object(a.e)(n,i)>0&&(o.addToolTip("["+g+"]","<div class='chatMsgHover'><span></span>Message job seekers to get faster responses. This action does not consume any additional quota.</div>"),localStorage.removeItem("chat-tooltip-time-"+e.userId))}else $("[data-chat-open]").length&&(Object(a.a)("chat-tooltip-time-"),o.addToolTip("["+g+"]","<div class='chatMsgHover'><span></span>Message job seekers to get faster responses. This action does not consume any additional quota.</div>"))},o._resolveConvoPromise=function(e){Object(l.createConversation)(JSON.parse(chatData)).then(function(t){o._isCurrentUser||u.a.getClient().getIdentity().then(function(e){o.props.dispatch(Object(d.setUser)(e))}),o._conversationPromiseSuccess(t,e)})},o._conversationPromiseSuccess=function(e,t){o.dispatchOpenChatWindow(e);var n=document.querySelector(".initiate-chat").getAttribute(""+_),i=document.querySelector("["+v+"]")&&document.querySelector("["+v+"]").getAttribute(""+_);o.hideLoader();var r="cvpreview",s=!1,a=!1,c="";if("preview"===pageName){var l=$("#chatOptionDrpdwn").parents(".dropLayer").siblings(".tel");s=l.attr("data-active-now"),a=l.attr("data-response-time"),t||window.callingOptionsChat?r="callingoptions_cvpreview":"true"===n?(c="askForUpdatedCv",$(".initiate-chat").attr(""+_,!1)):"true"===i&&(c="askForUpdatedCvBtn",$("["+v+"]").attr(""+_,!1)),window.callingOptionsChat=!1}else{r="callingoptions_srppages";var u=$("#chatOptionDrpdwn").parents(".dropLayer").siblings(".tel");s=u.attr("data-active-now"),a=u.attr("data-response-time")}"undefined"!=typeof ub&&ub.track("chatButtonClick",{actionType:"click",fromId:o.props.owner&&o.props.owner.metadata&&JSON.parse(o.props.owner.metadata).rpId||"",fromType:"recruiter",buttonSource:r,pageName:pageName,toOnlineStatus:"true"===s?"online":"away",toResponseTime:a,chatSource:c,cvLastUpdatedOn:window.cvUploadDate||""})},o._openChat=function(e){var t=window.gnb_variables||{},n=$(e.target).parents(".callLater").length;if("preview"!==pageName){var i=$(e.target).parents(".tuple").attr("data-index"),r=srpTupleJson&&i&&srpTupleJson[i],s=$(e.target).parents(".tuple").find(".usrImg").attr("src")||"https://static.naukimg.com/s/4/112/i/noImg.png";if(r){var a=r.employement.current,c=a.designation,l=a.organization;window.chatData=JSON.stringify({company:l,designation:c,cv_id:r.uniqueIdOrig||"",display_name:r.name||"Candidate",chatSource:"resdex",avatar_url:s})}}if("undefined"==typeof pageName||"preview"!==pageName&&"SRP"!==pageName||window.isChatClickedOnce||(window.isChatClickedOnce=!0,o.showLoader(),window.chatBtClicked=!0,n&&(window.callingOptionsChat=!0)),localStorage.getItem("chat-tooltip-time-"+t.userId)||(localStorage.setItem("chat-tooltip-time-"+t.userId,(new Date).toString()),$(".chatMsgHover").remove()),o.showLoader(),o.props.loadJobs(),!o._isCurrentUser)return void o._resolveConvoPromise(n);o.client.loadConversation(!1).then(function(e){var t=JSON.parse(chatData).cv_id;if(e){for(var i=null,r=0;r<e.length;r++)if(t==JSON.parse(e[r].participants[0].META_DATA).cvId){i=e[r];break}i?(o.dispatchOpenChatWindow(i),o._conversationPromiseSuccess(i,n)):o._resolveConvoPromise()}else o._resolveConvoPromise(n)})},o.mouseOverChatIcon=function(){0===$("[data-chat-open] .chatMsgHover").length&&$("[data-chat-open]").append("<div class='chatMsgHover'>\n                                <span></span>\n                                Message job seekers to get faster responses. This action does not consume any additional quota.\n                            </div>")},o.mouseLeaveChatIcon=function(){var e=window.gnb_variables||{};localStorage.getItem("chat-tooltip-time-"+e.userId)&&$(".chatMsgHover").remove()},o.isNotContactable=function(){return!(!$(".initiate-chat")||1!=$(".initiate-chat").data("chat-isprefill"))},o.isVideoCallScheduled=function(){return!(!$(".initiate-chat")||1!=$(".initiate-chat").data("chat-videocall"))},o.isCVOlder=function(){var e=Object(p.i)(window.cvUploadDate);return e>m||isNaN(e)},o.isUpdatedCVRequired=function(){var e=o.isCVOlder(),t=document.querySelector(".initiate-chat").getAttribute(""+_),n=document.querySelector("["+v+"]")&&document.querySelector("["+v+"]").getAttribute(""+_);return!(!o.isCvRequestsAvailable()||!e||"true"!==t&&"true"!==n)},o.isCvRequestsAvailable=function(){var e=window.cvUpdatedRequestCount||"",t=window.lastCvRequestedDate||!1,n=window.barredTillTime||!1;return n&&-1!==Number(n)?o.isCvUpdationTimeLimitValid(n,E):Number(e)<5||t&&o.isCvUpdationTimeLimitValid(t,b)},o.askCandidateToUpdateCvVisblity=function(){o.isCvRequestsAvailable()&&o.isCVOlder()&&$("#requestCv").css("display","inline-block")},o.isCvUpdationTimeLimitValid=function(e,t){var n=1e3*e,i=new Date,r=i.getTime()-2592e6;return t===b?r>=n:t===E&&(n-i.getTime())/864e5<=0},o.conversation=null,o.clickListener=null,o.chatClickListener=null,o.mouseLeave=null,o.mouseOver=null,o.showToolTip(),o.addTooltipOnClick(),o}return o(t,e),t.prototype.dispatchOpenChatWindow=function(e){if(this.props.openChat(e),"preview"==window.pageName){var t=Object(p.a)(e.participants,e.participants[0]),n=this._getMeta(e.participants[0]),i=n.employerName;if(this.isNotContactable()){var r="Hi "+(t&&Object(a.h)(t.NAME)||"Candidate")+", I am a recruiter"+(i&&" with "+i)+". I was calling you about a role that is a good fit with your skills and profile. Please suggest a good time to call. Thanks";this.props.dispatch(s.setExternalContent(r)),this.props.dispatch(s.setChatSource("notContactable"))}else if(this.isVideoCallScheduled()){var o=$(".initiate-chat").data("chat-videocalltime"),c="Hi "+(t&&Object(a.h)(t.NAME)||"Candidate")+".\nYour video call "+(i&&" with "+i)+" is scheduled on "+o+".\nPlease check your mail for more details.\nThanks";this.props.dispatch(s.setExternalContent(c)),this.props.dispatch(s.setChatSource("videoCall")),$(".initiate-chat").attr("data-chat-videoCall",!1),$(".initiate-chat").attr("data-chat-videocalltime",!1)}else if(this.isUpdatedCVRequired()){var l=document.querySelector(".initiate-chat").getAttribute(""+_),u=document.querySelector("["+v+"]")&&document.querySelector("["+v+"]").getAttribute(""+_),h="Hi "+(t&&Object(a.h)(t.NAME)||"Candidate")+",\nI have reviewed your profile for a job opening. Kindly share your updated CV.";this.props.dispatch(s.setExternalContent(h)),"true"===l?this.props.dispatch(s.setChatSource("askForUpdatedCv")):"true"===u&&this.props.dispatch(s.setChatSource("askForUpdatedCvBtn"))}}},t.prototype._getMeta=function(e){if(e&&e.META_DATA)return JSON.parse(e.META_DATA)},t.prototype.showLoader=function(){var e='<span class="msgBtnLdr"></span>';$(".initiate-chat").html(e).css("pointer-events","none"),$(".chatWithCd").html(e).css("pointer-events","none")},t.prototype.hideLoader=function(){$(".initiate-chat").html('<span class="msg-icon"><i class="fontIcon wf-chat-message"></i></span><span class="msg-btn">Message</span>').css("pointer-events","visible"),$(".chatWithCd").html(c.c)},t.prototype.showToolTip=function(){var e=void 0;e="object"===("undefined"==typeof gnb_variables?"undefined":f(gnb_variables))?window.gnb_variables:{},e.userId&&this.genarateToolTipMessage(e)},t.prototype.componentWillMount=function(){var e=this,t=this;this.askCandidateToUpdateCvVisblity(),this.chatOptionClickListener=$(document).on("click","#chatOptionDrpdwn",this._openChat),this.clickListener=$(document).on("click","["+g+"]",this._openChat),this.chatClickListener=$(document).on("click","["+v+"]",function(){t._openChat(e),$("["+v+"]").attr(""+_,!0)}),$("["+g+"]").show(),this.mouseOver=$(document).on("mouseenter","["+g+"]",this.mouseOverChatIcon),this.mouseLeave=$(document).on("mouseleave","["+g+"]",this.mouseLeaveChatIcon)},t.prototype.componentWillUnmount=function(){this.clickListener.off("click",this._openChat),this.chatClickListener.off("click",this._openChat),this.chatOptionClickListener.off("click",this._openChat),this.mouseLeave.off("mouseleave",this.mouseLeaveChatIcon),this.mouseOver.off("mouseenter",this.mouseOverChatIcon)},t}(y.PureComponent);t.a=w},1:function(e,t){},"2Jz9":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return e?e.toISOString():null}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n("zi+W"),l=n("P+Qc"),u=n("jTMd"),h=n("kesd"),d=n("jPMo"),p=n("M3Kp"),f=9007199254740991,y=h.SYNC_STATE.NEW,g=[{name:"conversations",indexes:{created_at:["created_at"],last_message_sent:["last_message_sent"]}},{name:"channels",indexes:{created_at:["created_at"]}},{name:"messages",indexes:{conversationId:["conversationId","position"]}},{name:"identities",indexes:{}},{name:"syncQueue",indexes:{}}],v=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(window.indexedDB&&e.enabled){var o=!0;try{window.IDBKeyRange.bound(["announcement",0],["announcement",f])}catch(t){e.tables={},o=!1}o&&-1!==n.client.constructor._supportedEvents.indexOf("conversations:add")&&(n.client.on("conversations:add",function(e){return n.writeConversations(e.conversations)},n),n.client.on("conversations:change",function(e){return n._updateConversation(e.target,e.changes)},n),n.client.on("conversations:delete conversations:sent-error",function(e){return n.deleteObjects("conversations",[e.target])},n),n.client.on("channels:add",function(e){return n.writeChannels(e.channels)},n),n.client.on("channels:change",function(e){return n._updateChannel(e.target,e.changes)},n),n.client.on("channels:delete channels:sent-error",function(e){return n.deleteObjects("channels",[e.target])},n),n.client.on("messages:add",function(e){return n.writeMessages(e.messages)},n),n.client.on("messages:change",function(e){return n.writeMessages([e.target])},n),n.client.on("messages:delete messages:sent-error",function(e){return n.deleteObjects("messages",[e.target])},n),n.client.on("identities:add",function(e){return n.writeIdentities(e.identities)},n),n.client.on("identities:change",function(e){return n.writeIdentities([e.target])},n),n.client.on("identities:unfollow",function(e){return n.deleteObjects("identities",[e.target])},n)),(e.tables.conversations||e.tables.channels)&&e.tables.messages||(e.tables.syncQueue=!1)}else e.tables={};return g.forEach(function(t){n["_permission_"+t.name]=Boolean(e.tables[t.name])}),n._open(!1),n}return o(t,e),a(t,[{key:"_getDbName",value:function(){return"LayerWebSDK_"+this.client.appId}},{key:"_open",value:function(e){var t=this;if(this.db&&(this.db.close(),delete this.db),0===g.filter(function(e){return t["_permission_"+e.name]}).length)return this._isOpenError=!0,void this.trigger("error",{error:"Persistence is disabled by application"});var n=window.indexedDB.open(this._getDbName(),5);try{n.onerror=function(n){e?(t._isOpenError=!0,l.warn("Database Unable to Open (common cause: private browsing window)",n.target.error),t.trigger("error",{error:n})):t.deleteTables(function(){return t._open(!0)})},n.onupgradeneeded=function(e){return t._onUpgradeNeeded(e)},n.onsuccess=function(e){t.db=e.target.result,t.isOpen=!0,t.trigger("open"),t.db.onversionchange=function(){t.db.close(),t.isOpen=!1},t.db.onerror=function(e){return l.error("db-manager Error: ",e)}}}catch(e){this._isOpenError=!0,l.error("Database Unable to Open: ",e),this.trigger("error",{error:e})}}},{key:"onOpen",value:function(e){this.isOpen||this._isOpenError?e():this.once("open error",e)}},{key:"_onUpgradeNeeded",value:function(e){var t=this,n=e.target.result,i=function(e){t.db=n,t.isComplete=!0,t.isOpen=!0,t.trigger("open")},r=Array.prototype.slice.call(n.objectStoreNames);g.forEach(function(e){try{-1!==r.indexOf(e.name)&&n.deleteObjectStore(e.name)}catch(e){}try{var t=n.createObjectStore(e.name,{keyPath:"id"});Object.keys(e.indexes).forEach(function(n){return t.createIndex(n,e.indexes[n],{unique:!1})}),t.transaction.oncomplete=i}catch(t){l.error("Failed to create object store "+e.name,t)}})}},{key:"_getConversationData",value:function(e){var t=this;return e.filter(function(e){return e._fromDB?(e._fromDB=!1,!1):!e.isLoading&&e.syncState!==y}).map(function(e){return{id:e.id,url:e.url,participants:t._getIdentityData(e.participants,!0),distinct:e.distinct,created_at:s(e.createdAt),metadata:e.metadata,unread_message_count:e.unreadCount,last_message:e.lastMessage?e.lastMessage.id:"",last_message_sent:s(e.lastMessage?e.lastMessage.sentAt:e.createdAt),sync_state:e.syncState}})}},{key:"_updateConversation",value:function(e,t){var n=this,i=t.filter(function(e){return"id"===e.property});i.length?this.deleteObjects("conversations",[{id:i[0].oldValue}],function(){n.writeConversations([e])}):this.writeConversations([e])}},{key:"writeConversations",value:function(e,t){this._writeObjects("conversations",this._getConversationData(e.filter(function(e){return!e.isDestroyed})),t)}},{key:"_getChannelData",value:function(e){return e.filter(function(e){return e._fromDB?(e._fromDB=!1,!1):!e.isLoading&&e.syncState!==y}).map(function(e){return{id:e.id,url:e.url,created_at:s(e.createdAt),sync_state:e.syncState,membership:null,name:e.name,metadata:e.metadata}})}},{key:"_updateChannel",value:function(e,t){var n=this,i=t.filter(function(e){return"id"===e.property});i.length?this.deleteObjects("channels",[{id:i[0].oldValue}],function(){n.writeChannels([e])}):this.writeChannels([e])}},{key:"writeChannels",value:function(e,t){this._writeObjects("channels",this._getChannelData(e.filter(function(e){return!e.isDestroyed})),t)}},{key:"_getIdentityData",value:function(e,t){return e.filter(function(e){return!(e.isDestroyed||!e.isFullIdentity&&!t||(e._fromDB?(e._fromDB=!1,1):e.isLoading))}).map(function(e){return e.isFullIdentity&&!t?{id:e.id,url:e.url,user_id:e.userId,first_name:e.firstName,last_name:e.lastName,display_name:e.displayName,avatar_url:e.avatarUrl,metadata:e.metadata,public_key:e.publicKey,phone_number:e.phoneNumber,email_address:e.emailAddress,sync_state:e.syncState,type:e.type}:{id:e.id,url:e.url,user_id:e.userId,display_name:e.displayName,avatar_url:e.avatarUrl}})}},{key:"writeIdentities",value:function(e,t){this._writeObjects("identities",this._getIdentityData(e),t)}},{key:"_getMessageData",value:function(e,n){var i=this,r=e.filter(function(e){return e._fromDB?(e._fromDB=!1,!1):e.syncState!==h.SYNC_STATE.LOADING}).map(function(e){return{id:e.id,url:e.url,parts:e.parts.map(function(e){return{body:d.isBlob(e.body)&&e.body.size>t.MaxPartSize?null:e.body,id:e.id,encoding:e.encoding,mime_type:e.mimeType,content:e._content?{id:e._content.id,download_url:e._content.downloadUrl,expiration:e._content.expiration,refresh_url:e._content.refreshUrl,size:e._content.size}:null}}),position:e.position,sender:i._getIdentityData([e.sender],!0)[0],recipient_status:e.recipientStatus,sent_at:s(e.sentAt),received_at:s(e.receivedAt),conversationId:e instanceof p?"announcement":e.conversationId,sync_state:e.syncState,is_unread:e.isUnread}}),o=0,a=[];r.forEach(function(e){e.parts.forEach(function(e){d.isBlob(e.body)&&a.push(e)})}),0===a.length?n(r):a.forEach(function(e){d.blobToBase64(e.body,function(t){e.body=t,e.useBlob=!0,++o===a.length&&n(r)})})}},{key:"writeMessages",value:function(e,t){var n=this;this._getMessageData(e.filter(function(e){return!e.isDestroyed}),function(e){return n._writeObjects("messages",e,t)})}},{key:"_getSyncEventData",value:function(e){return e.filter(function(e){return!e.fromDB||(e.fromDB=!1,!1)}).map(function(e){return{id:e.id,target:e.target,depends:e.depends,isWebsocket:e instanceof u.WebsocketSyncEvent,operation:e.operation,data:e.data,url:e.url||"",headers:e.headers||null,method:e.method||null,created_at:e.createdAt}})}},{key:"writeSyncEvents",value:function(e,t){this._writeObjects("syncQueue",this._getSyncEventData(e),t)}},{key:"_writeObjects",value:function(e,t,n){var i=this;return!this["_permission_"+e]||this._isOpenError?n?n():null:t.length?void this.onOpen(function(){i.getObjects(e,t.map(function(e){return e.id}),function(r){var o={};r.forEach(function(e){o[e.id]=e});var s=i.db.transaction([e],"readwrite"),a=s.objectStore(e);s.oncomplete=s.onerror=n,t.forEach(function(e){try{o[e.id]?a.put(e):a.add(e)}catch(e){l.error(e)}})})}):void(n&&n())}},{key:"loadConversations",value:function(e,t,n,i){var r=this;try{var o=void 0,a=null,c=t?this.client.getConversation(t):null;"last_message"===e?(o="last_message_sent",c&&(a=window.IDBKeyRange.upperBound([s(c.lastMessage?c.lastMessage.sentAt:c.createdAt)]))):(o="created_at",c&&(a=window.IDBKeyRange.upperBound([s(c.createdAt)]))),this._loadByIndex("conversations",o,a,Boolean(t),n,function(e){var t=e.map(function(e){return e.last_message}).filter(function(e){return e&&!r.client.getMessage(e)});r.getObjects("messages",t,function(t){r._loadConversationsResult(e,t,i)})})}catch(e){}}},{key:"_loadConversationsResult",value:function(e,t,n){var i=this;t.forEach(function(e){return i._createMessage(e)});var r=e.map(function(e){return i._createConversation(e)||i.client.getConversation(e.id)}).filter(function(e){return e});n&&n(r)}},{key:"loadChannels",value:function(e,t,n){var i=this;try{var r=null,o=e?this.client.getChannel(e):null;o&&(r=window.IDBKeyRange.upperBound([s(o.createdAt)])),this._loadByIndex("channels","created_at",r,Boolean(e),t,function(e){i._loadChannelsResult(e,n)})}catch(e){}}},{key:"_loadChannelsResult",value:function(e,t){var n=this,i=e.map(function(e){return n._createChannel(e)||n.client.getChannel(e.id)}).filter(function(e){return e});t&&t(i)}},{key:"loadMessages",value:function(e,t,n,i){var r=this;if(!this._permission_messages||this._isOpenError)return i([]);try{var o=t?this.client.getMessage(t):null,s=window.IDBKeyRange.bound([e,0],[e,o?o.position:f]);this._loadByIndex("messages","conversationId",s,Boolean(t),n,function(e){r._loadMessagesResult(e,i)})}catch(e){}}},{key:"loadAnnouncements",value:function(e,t,n){var i=this;if(!this._permission_messages||this._isOpenError)return n([]);try{var r=e?this.client.getMessage(e):null,o=window.IDBKeyRange.bound(["announcement",0],["announcement",r?r.position:f]);this._loadByIndex("messages","conversationId",o,Boolean(e),t,function(e){i._loadMessagesResult(e,n)})}catch(e){}}},{key:"_blobifyPart",value:function(e){e.useBlob&&(e.body=d.base64ToBlob(e.body),delete e.useBlob,e.encoding=null)}},{key:"_loadMessagesResult",value:function(e,t){var n=this;e.forEach(function(e){return e.parts.forEach(function(e){return n._blobifyPart(e)})});var i=e.map(function(e){return n._createMessage(e)||n.client.getMessage(e.id)}).filter(function(e){return e});t&&t(i)}},{key:"loadIdentities",value:function(e){var t=this;this._loadAll("identities",function(n){t._loadIdentitiesResult(n,e)})}},{key:"_loadIdentitiesResult",value:function(e,t){var n=this,i=e.map(function(e){return n._createIdentity(e)||n.client.getIdentity(e.id)}).filter(function(e){return e});t&&t(i)}},{key:"_createConversation",value:function(e){if(!this.client.getConversation(e.id)){e._fromDB=!0;var t=this.client._createObject(e);return t.syncState=e.sync_state,t}}},{key:"_createChannel",value:function(e){if(!this.client.getChannel(e.id)){e._fromDB=!0;var t=this.client._createObject(e);return t.syncState=e.sync_state,t}}},{key:"_createMessage",value:function(e){if(!this.client.getMessage(e.id)){e._fromDB=!0,e.conversationId.indexOf("layer:///conversations")?e.conversation={id:e.conversationId}:e.conversationId.indexOf("layer:///channels")&&(e.channel={id:e.conversationId}),delete e.conversationId;var t=this.client._createObject(e);return t.syncState=e.sync_state,t}}},{key:"_createIdentity",value:function(e){if(!this.client.getIdentity(e.id)){e._fromDB=!0;var t=this.client._createObject(e);return t.syncState=e.sync_state,t}}},{key:"loadSyncQueue",value:function(e){var t=this;this._loadAll("syncQueue",function(n){return t._loadSyncEventRelatedData(n,e)})}},{key:"_loadSyncEventRelatedData",value:function(e,t){var n=this,i=e.filter(function(e){return"DELETE"!==e.operation&&e.target&&e.target.match(/messages/)}).map(function(e){return e.target}),r=e.filter(function(e){return"DELETE"!==e.operation&&e.target&&e.target.match(/conversations/)}).map(function(e){return e.target}),o=e.filter(function(e){return"DELETE"!==e.operation&&e.target&&e.target.match(/identities/)}).map(function(e){return e.target}),s=0;this.getObjects("messages",i,function(i){i.forEach(function(e){return n._createMessage(e)}),3==++s&&n._loadSyncEventResults(e,t)}),this.getObjects("conversations",r,function(i){i.forEach(function(e){return n._createConversation(e)}),3==++s&&n._loadSyncEventResults(e,t)}),this.getObjects("identities",o,function(i){i.forEach(function(e){return n._createIdentity(e)}),3==++s&&n._loadSyncEventResults(e,t)})}},{key:"_loadSyncEventResults",value:function(e,t){var n=this,i=e.filter(function(e){var t=Boolean(e.target&&n.client.getObject(e.target));return"DELETE"===e.operation||t}).map(function(e){return e.isWebsocket?new u.WebsocketSyncEvent({target:e.target,depends:e.depends,operation:e.operation,id:e.id,data:e.data,fromDB:!0,createdAt:e.created_at}):new u.XHRSyncEvent({target:e.target,depends:e.depends,operation:e.operation,id:e.id,data:e.data,method:e.method,headers:e.headers,url:e.url,fromDB:!0,createdAt:e.created_at})});d.sortBy(i,function(e){return e.createdAt}),t(i)}},{key:"_loadAll",value:function(e,t){var n=this;if(!this["_permission_"+e]||this._isOpenError)return t([]);this.onOpen(function(){var i=[];n.db.transaction([e],"readonly").objectStore(e).openCursor().onsuccess=function(e){if(!n.isDestroyed){var r=e.target.result;r?(i.push(r.value),r.continue()):n.isDestroyed||t(i)}}})}},{key:"_loadByIndex",value:function(e,t,n,i,r,o){var s=this;if(!this["_permission_"+e]||this._isOpenError)return o([]);var a=i;this.onOpen(function(){var i=[];s.db.transaction([e],"readonly").objectStore(e).index(t).openCursor(n,"prev").onsuccess=function(e){if(!s.isDestroyed){var t=e.target.result;t?(a?a=!1:i.push(t.value),r&&i.length>=r?o(i):t.continue()):o(i)}}})}},{key:"deleteObjects",value:function(e,t,n){var i=this;if(!this["_permission_"+e]||this._isOpenError)return n?n():null;this.onOpen(function(){var r=i.db.transaction([e],"readwrite"),o=r.objectStore(e);r.oncomplete=n,t.forEach(function(e){return o.delete(e.id)})})}},{key:"getObjects",value:function(e,t,n){var i=this;if(!this["_permission_"+e]||this._isOpenError)return n([]);for(var r=[],o=t.sort(),s=o.length-1;s>0;s--)o[s]===o[s-1]&&o.splice(s,1);var a=0;this.onOpen(function(){i.db.transaction([e],"readonly").objectStore(e).openCursor().onsuccess=function(e){if(!i.isDestroyed){var t=e.target.result;if(!t)return void n(r);for(var s=t.key;s>o[a];)a++;s===o[a]&&(r.push(t.value),a++),a===o.length?i.isDestroyed||n(r):t.continue(o[a])}}})}},{key:"getObject",value:function(e,t,n){var i=this;if(!this["_permission_"+e]||this._isOpenError)return n();this.onOpen(function(){i.db.transaction([e],"readonly").objectStore(e).openCursor(window.IDBKeyRange.only(t)).onsuccess=function(t){var r=t.target.result;if(!r)return n(null);switch(e){case"messages":return r.value.parts.forEach(function(e){return i._blobifyPart(e)}),n(r.value);case"identities":case"channels":return n(r.value);case"conversations":if(r.value.last_message){var o=i.client.getMessage(r.value.last_message);return o?i._getMessageData([o],function(e){r.value.last_message=e[0],n(r.value)}):i.getObject("messages",r.value.last_message,function(e){r.value.last_message=e,n(r.value)})}return n(r.value)}}})}},{key:"claimSyncEvent",value:function(e,t){var n=this;if(!this._permission_syncQueue||this._isOpenError)return t(!0);this.onOpen(function(){var i=n.db.transaction(["syncQueue"],"readwrite"),r=i.objectStore("syncQueue");r.get(e.id).onsuccess=function(e){return t(Boolean(e.target.result))},r.delete(e.id)})}},{key:"deleteTables",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};try{var t=window.indexedDB.deleteDatabase(this._getDbName());t.onsuccess=t.onerror=e,delete this.db}catch(t){l.error("Failed to delete database",t),e&&e(t)}}}]),t}(c);v.prototype.client=null,v.prototype.isOpen=!1,v.prototype._isOpenError=!1,v.prototype._permission_messages=!1,v.prototype._permission_conversations=!1,v.prototype._permission_channels=!1,v.prototype._permission_identities=!1,v.prototype._permission_syncQueue=!1,v.prototype.db=null,v.MaxPartSize=25e4,v._supportedEvents=["open","error"].concat(c._supportedEvents),c.initClass.apply(v,[v,"DbManager"]),e.exports=v},"2Xjr":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("/CmL"),a=n("muYO"),c=n("MRbt"),l=n("sQD6"),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},h=window.interfaces.Virtual,d=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n));return o._input=null,o.file_uploader_id="file-button",o.sendFile=function(){var e=o.props.file||{};o.props.uploadFile(e,o.props.conversationId),o.props.trackUBA("file",e)},o.sendJob=function(){var e=o.props.selectedLiveJob,t="Shared Job's Details:\n"+(e.title||"")+"\n"+(e.loc||"")+"\n"+(e.shortUrl||"");o.props.onSend(t,"job")},o.state={value:"",showAttachJobModal:!1},o._toggleAttachLightbox=o._toggleAttachLightbox.bind(o),o.removeJobs=o.removeJobs.bind(o),o.sendJob=o.sendJob.bind(o),o.blockedUserPreview=o.blockedUserPreview.bind(o),o}return o(t,e),t.prototype.componentDidMount=function(){this._input&&this._input.focus(),this.props.initFileUploader({fileId:this.file_uploader_id})},t.prototype._toggleAttachLightbox=function(){this.props.dispatchAttachLb({openAttachLightBox:!0})},t.prototype.isMessageValid=function(e){return!!e&&!!e.trim()},t.prototype.onInput=function(e){this._input.style.height="1px";var t=this._input.scrollHeight;!$.trim(this._input.value)&&this.props.externalContent&&this.props.setExternalContent(null),t>=39&&t<=160?this._input.style.height=t+"px":t<39?this._input.style.height="39px":t>160&&(this._input.style.height="160px"),this.props.onInput(e),this.setState({value:this._input.value})},t.prototype.onSend=function(){this.props.hideAttachmentError(),this.props.onSend(this.state.value),this._input&&(this._input.style.height="39px"),this.setState({value:null});try{this._input.focus()}catch(e){}},t.prototype.componentWillReceiveProps=function(e){var t=this;e.externalContent&&this.setState({value:e.externalContent},function(){e.blocked||t.onInput({currentTarget:{style:{height:160}}})})},t.prototype.getAttachmentOptions=function(){return h.createElement("div",null,h.createElement(a.a,{icon:"icon-attachment",cls:"_doc",iconCls:"wf-chat-attachment",panelCls:"chat-attachments",preserveDom:!0},h.createElement("ul",{className:"_list"},h.createElement("li",{onClick:this._toggleAttachLightbox},h.createElement("i",{className:"fontIcon wf-chat-attach-job"}),h.createElement("p",null,s.a.ATTACH_JOB_LABEL)),h.createElement("li",null,h.createElement(c.a,u({},this.props,{file_uploader_id:this.file_uploader_id}))))))},t.prototype.blockedUserPreview=function(){var e=this;try{this._input.value=""}catch(e){}return h.createElement("div",{className:"chat-block-wrapper"},h.createElement("p",null,s.a.USER_BLOCKED),h.createElement("p",null,s.a.USER_UNBLOCK_MESSAGE),h.createElement("span",{onClick:function(){e.props.unBlockUser()}},s.a.USER_UNBLOCK))},t.prototype.removeJobs=function(){this.props.selectJob(null)},t.prototype.attachedJobPreview=function(){var e=this.props.selectedLiveJob.title,t=s.a.POSTED_BY_LABEL+": "+this.props.selectedLiveJob.postedBy;return this.props.selectedLiveJob.jobId,this.fileUploadPreview(e,t,this.removeJobs,this.sendJob)},t.prototype.fileUploadPreview=function(e,t,n,i){return h.createElement("div",{class:"_inner file__preview"},h.createElement("div",{className:"file-icon"},h.createElement("i",{class:"fontIcon wf-chat-attach-doc"})),h.createElement("div",{className:"file-info"},h.createElement("div",{className:"file-name _ellipses",title:e},e),h.createElement("div",{className:"file-size _ellipses",title:t},t),h.createElement("div",{className:"remove-btn",onClick:function(){return n()}},"Remove")),h.createElement("div",{className:"submit-btn"},h.createElement("button",{class:"_send",onClick:function(){return i()}},h.createElement("i",{class:"fontIcon wf-chat-send"}))))},t.prototype.defaultInput=function(){var e=this,t=this.props.user.NAME;return h.createElement("div",null,h.createElement("textarea",{rows:1,placeholder:"Send a message "+(t?"to "+t:""),onInput:this.onInput.bind(this),required:"true",ref:function(t){return e._input=t},value:Object(l.c)(this.state.value),maxLength:"1500"}),this.isMessageValid(this.state.value)&&h.createElement("button",{className:"_send",onClick:this.onSend.bind(this)},h.createElement("i",{className:"fontIcon wf-chat-send"})))},t.prototype.render=function(){var e=this.props.file||{},t=e.fileSize&&Math.floor(Number(e.fileSize)/1024)+" KB"||"0 KB";return h.createElement("div",{className:"_input"},h.createElement("div",{className:"_inner"},h.createElement("input",{type:"file",id:this.file_uploader_id,className:"file_upload",onClick:function(e){e.target.value=null}}),h.createElement("div",{className:"message-attachment "+(this.state.value||this.props.selectedLiveJob||e.showPreview||this.props.blocked?"hide":"show")},this.getAttachmentOptions()),this.props.blocked?this.blockedUserPreview():this.props.selectedLiveJob?this.attachedJobPreview():e.showPreview?this.fileUploadPreview(e.fileName,t,this.props.cancelUpload,this.sendFile):this.defaultInput()))},t}(h.PureComponent);t.a=d},"2zqC":function(e,t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){"use strict";function e(e){this.time=e.time,this.target=e.target,this.rootBounds=e.rootBounds,this.boundingClientRect=e.boundingClientRect,this.intersectionRect=e.intersectionRect||l(),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,i=this.intersectionRect,r=i.width*i.height;this.intersectionRatio=n?Number((r/n).toFixed(4)):this.isIntersecting?1:0}function t(e,t){var n=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(n.root&&1!=n.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=r(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(n.rootMargin),this.thresholds=this._initThresholds(n.threshold),this.root=n.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" ")}function i(){return window.performance&&performance.now&&performance.now()}function r(e,t){var n=null;return function(){n||(n=setTimeout(function(){e(),n=null},t))}}function o(e,t,n,i){"function"==typeof e.addEventListener?e.addEventListener(t,n,i||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function s(e,t,n,i){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,i||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function a(e,t){var n=Math.max(e.top,t.top),i=Math.min(e.bottom,t.bottom),r=Math.max(e.left,t.left),o=Math.min(e.right,t.right),s=o-r,a=i-n;return s>=0&&a>=0&&{top:n,bottom:i,left:r,right:o,width:s,height:a}}function c(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):l()}function l(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function u(e,t){for(var n=t;n;){if(n==e)return!0;n=h(n)}return!1}function h(e){var t=e.parentNode;return t&&11==t.nodeType&&t.host?t.host:t&&t.assignedSlot?t.assignedSlot.parentNode:t}if("object"===("undefined"==typeof window?"undefined":n(window))){if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)return void("isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}}));var d=window.document,p=[];t.prototype.THROTTLE_TIMEOUT=100,t.prototype.POLL_INTERVAL=null,t.prototype.USE_MUTATION_OBSERVER=!0,t.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},t.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},t.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},t.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},t.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter(function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]})},t.prototype._parseRootMargin=function(e){var t=e||"0px",n=t.split(/\s+/).map(function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return n[1]=n[1]||n[0],n[2]=n[2]||n[0],n[3]=n[3]||n[1],n},t.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(o(window,"resize",this._checkForIntersections,!0),o(d,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in window&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(d,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},t.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,s(window,"resize",this._checkForIntersections,!0),s(d,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},t.prototype._checkForIntersections=function(){var t=this._rootIsInDom(),n=t?this._getRootRect():l();this._observationTargets.forEach(function(r){var o=r.element,s=c(o),a=this._rootContainsTarget(o),l=r.entry,u=t&&a&&this._computeTargetAndRootIntersection(o,n),h=r.entry=new e({time:i(),target:o,boundingClientRect:s,rootBounds:n,intersectionRect:u});l?t&&a?this._hasCrossedThreshold(l,h)&&this._queuedEntries.push(h):l&&l.isIntersecting&&this._queuedEntries.push(h):this._queuedEntries.push(h)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},t.prototype._computeTargetAndRootIntersection=function(e,t){if("none"!=window.getComputedStyle(e).display){for(var n=c(e),i=n,r=h(e),o=!1;!o;){var s=null,l=1==r.nodeType?window.getComputedStyle(r):{};if("none"==l.display)return;if(r==this.root||r==d?(o=!0,s=t):r!=d.body&&r!=d.documentElement&&"visible"!=l.overflow&&(s=c(r)),s&&!(i=a(s,i)))break;r=h(r)}return i}},t.prototype._getRootRect=function(){var e;if(this.root)e=c(this.root);else{var t=d.documentElement,n=d.body;e={top:0,left:0,right:t.clientWidth||n.clientWidth,width:t.clientWidth||n.clientWidth,bottom:t.clientHeight||n.clientHeight,height:t.clientHeight||n.clientHeight}}return this._expandRectByRootMargin(e)},t.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map(function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100}),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},t.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,i=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==i)for(var r=0;r<this.thresholds.length;r++){var o=this.thresholds[r];if(o==n||o==i||o<n!=o<i)return!0}},t.prototype._rootIsInDom=function(){return!this.root||u(d,this.root)},t.prototype._rootContainsTarget=function(e){return u(this.root||d,e)},t.prototype._registerInstance=function(){p.indexOf(this)<0&&p.push(this)},t.prototype._unregisterInstance=function(){var e=p.indexOf(this);-1!=e&&p.splice(e,1)},window.IntersectionObserver=t,window.IntersectionObserverEntry=e}}()},"36Uf":function(e,t,n){"use strict";var i=n("zTev"),r=n("ozQU"),o=n("pLky").dictionary;e.exports={events:["messages:notify","messages:add","messages:remove","messages:sent","messages:sending","messages:sent-error","messages:change","messages:loaded","messages:delete"],lifecycle:{constructor:function(e){this._models.messages={}},cleanup:function(){var e=this;Object.keys(this._models.messages).forEach(function(t){var n=e._models.messages[t];n&&!n.isDestroyed&&n.destroy()}),this._models.messages=null},reset:function(){this._models.messages={}}},methods:{getMessage:function(e,t){if("string"!=typeof e)throw new Error(o.idParamRequired);return 0!==e.indexOf("layer:///")&&(e=r.prefixUUID+e),this._models.messages[e]?this._models.messages[e]:t?i.load(e,this):null},getMessagePart:function(e){if("string"!=typeof e)throw new Error(o.idParamRequired);var t=e.replace(/\/parts.*$/,""),n=this.getMessage(t);return n?n.getPartById(e):null},_addMessage:function(e){if(!this._models.messages[e.id]){this._models.messages[e.id]=e,this._triggerAsync("messages:add",{messages:[e]}),e._notify&&(this._triggerAsync("messages:notify",{message:e}),e._notify=!1);var t=e.getConversation(!1);if(t&&(!t.lastMessage||t.lastMessage.position<e.position)){var n=t.lastMessage;t.lastMessage=e,n&&this._scheduleCheckAndPurgeCache(n)}else this._scheduleCheckAndPurgeCache(e)}},_removeMessage:function(e){var t="string"==typeof e?e:e.id;if((e=this._models.messages[t])&&(delete this._models.messages[t],!this._inCleanup)){this._triggerAsync("messages:remove",{messages:[e]});var n=e.getConversation(!1);!this._inCheckAndPurgeCache&&n&&n.lastMessage===e&&(n.lastMessage=null,n._lastMessagePosition=e.position)}},_purgeMessagesByPosition:function(e,t){var n=this;Object.keys(this._models.messages).forEach(function(i){var r=n._models.messages[i];r.conversationId===e&&r.position<=t&&r.destroy()})},forEachMessage:function(e){var t=this;Object.keys(this._models.messages).forEach(function(n){return e(t._models.messages[n])})}}}},"4wNg":function(e,t,n){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},l=n("zi+W"),u=n("pLky"),h=n("P+Qc"),d=(n("jPMo"),function(e){function t(){r(this,t);for(var e=void 0,n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];2===i.length?(e=i[1].build(),e.client=i[0]):e=i[0];var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(a.predicate=a._fixPredicate(e.predicate||""),"paginationWindow"in e){var c=e.paginationWindow;a.paginationWindow=Math.min(a._getMaxPageSize(),e.paginationWindow),e.paginationWindow!==c&&h.warn("paginationWindow value "+c+" in Query constructor excedes Query.MaxPageSize of "+a._getMaxPageSize())}if(a.data=[],a._initialPaginationWindow=a.paginationWindow,!a.client)throw new Error(u.dictionary.clientMissing);return a.client.on("all",a._handleEvents,a),a.client.isReady?a._run():a.client.once("ready",function(){return a._run()},a),a}return s(t,e),a(t,[{key:"destroy",value:function(){this.data=[],this._triggerChange({data:[],type:"reset"}),this.client.off(null,null,this),this.client._removeQuery(this),this.data=null,c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_getMaxPageSize",value:function(){return this.constructor.MaxPageSize}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=void 0,n=void 0,i="function"==typeof e.build?e.build():e;if("paginationWindow"in i&&this.paginationWindow!==i.paginationWindow&&(this.paginationWindow=Math.min(this._getMaxPageSize()+this.size,i.paginationWindow),this.paginationWindow<i.paginationWindow&&h.warn("paginationWindow value "+i.paginationWindow+" in Query.update() increases size greater than Query.MaxPageSize of "+this._getMaxPageSize()),t=!0),"model"in i&&this.model!==i.model)throw new Error(u.dictionary.modelImmutable);if("predicate"in i){var r=this._fixPredicate(i.predicate||"");this.predicate!==r&&(this.predicate=r,n=!0)}return"sortBy"in i&&JSON.stringify(this.sortBy)!==JSON.stringify(i.sortBy)&&(this.sortBy=i.sortBy,n=!0),n&&this._reset(),(n||t)&&this._run(),this}},{key:"_fixPredicate",value:function(e){if(e)throw new Error(u.dictionary.predicateNotSupported);return""}},{key:"_reset",value:function(){this.totalSize=0;var e=this.data;this.data=[],this.client._checkAndPurgeCache(e),this.isFiring=!1,this._predicate=null,this._nextDBFromId="",this._nextServerFromId="",this.pagedToEnd=!1,this.paginationWindow=this._initialPaginationWindow,this._triggerChange({data:[],type:"reset"})}},{key:"reset",value:function(){this._reset(),this._run()}},{key:"_run",value:function(){var e=Math.min(this.paginationWindow-this.size,this._getMaxPageSize());if(e<0){var t=this.data.slice(this.paginationWindow);this.data=this.data.slice(0,this.paginationWindow),this.client._checkAndPurgeCache(t),this.pagedToEnd=!1,this._triggerAsync("change",{data:[]})}else 0===e||this.pagedToEnd||this._fetchData(e)}},{key:"_fetchData",value:function(e){}},{key:"_getSortField",value:function(){}},{key:"_processRunResults",value:function(e,t,n){var i=this;t!==this._firingRequest||this.isDestroyed||(this.isFiring=!1,this._firingRequest="",e.success?(this.totalSize=Number(e.xhr.getResponseHeader("Layer-Count")),(e.data.length<n||e.data.length===this.totalSize)&&(this.pagedToEnd=!0),this._appendResults(e,!1)):e.data.getNonce()?this.client.once("ready",function(){i._run()}):this.trigger("error",{error:e.data}))}},{key:"_appendResults",value:function(e,n){var i=this;e.data.forEach(function(e){e instanceof l||i.client._createObject(e)});var r=e.data.filter(function(e){return-1===i._getIndex(e.id)}),o=e.data.length;o&&(n?this._nextDBFromId=e.data[o-1].id:this._nextServerFromId=e.data[o-1].id),this.dataType===t.ObjectDataType&&(this.data=[].concat(this.data)),r.forEach(function(e){var t=i.client.getObject(e.id);t&&i._appendResultsSplice(t)}),this._triggerChange({type:"data",data:r.map(function(e){return i._getData(i.client.getObject(e.id))}),query:this,target:this.client})}},{key:"_appendResultsSplice",value:function(e){}},{key:"_getData",value:function(e){return this.dataType===t.ObjectDataType?e.toObject():e}},{key:"_getInstance",value:function(e){return e instanceof l?e:this.client.getObject(e.id)}},{key:"_getItem",value:function(e){var t=this._getIndex(e);return-1===t?null:this.data[t]}},{key:"_getIndex",value:function(e){for(var t=0;t<this.data.length;t++)if(this.data[t].id===e)return t;return-1}},{key:"_handleEvents",value:function(e,t){}},{key:"_handleChangeEvent",value:function(e,n){var r=this._getIndex(n.target.id);-1!==r&&(this.dataType===t.ObjectDataType&&(this.data=[].concat(i(this.data.slice(0,r)),[n.target.toObject()],i(this.data.slice(r+1)))),this._triggerChange({type:"property",target:this._getData(n.target),query:this,isChange:!0,changes:n.changes}))}},{key:"_handleAddEvent",value:function(e,n){var i=this,r=n[e].filter(function(e){return-1===i._getIndex(e.id)}).map(function(e){return i._getData(e)});if(r.length){var o=this.data=this.dataType===t.ObjectDataType?[].concat(this.data):this.data;r.forEach(function(e){o.push(e),i.totalSize+=1,i._triggerChange({type:"insert",index:o.length-1,target:e,query:i})})}}},{key:"_handleRemoveEvent",value:function(e,n){var r=this,o=[];n[e].forEach(function(e){var n=r._getIndex(e.id);-1!==n&&(e.id===r._nextDBFromId&&(r._nextDBFromId=r._updateNextFromId(n)),e.id===r._nextServerFromId&&(r._nextServerFromId=r._updateNextFromId(n)),o.push({data:e,index:n}),r.dataType===t.ObjectDataType?r.data=[].concat(i(r.data.slice(0,n)),i(r.data.slice(n+1))):r.data.splice(n,1))}),this.totalSize-=o.length,o.forEach(function(e){r._triggerChange({type:"remove",target:r._getData(e.data),index:e.index,query:r})})}},{key:"_updateNextFromId",value:function(e){return e>0?this.data[e-1].id:""}},{key:"_triggerChange",value:function(e){this.isDestroyed||this.client._inCleanup||(this.trigger("change",e),this.trigger("change:"+e.type,e))}},{key:"toString",value:function(){return this.id}}]),t}(l));d.prefixUUID="layer:///queries/",d.Conversation="Conversation",d.Channel="Channel",d.Message="Message",d.Announcement="Announcement",d.Identity="Identity",d.Membership="Membership",d.ObjectDataType="object",d.InstanceDataType="instance",d.MaxPageSize=100,Object.defineProperty(d.prototype,"size",{enumerable:!0,get:function(){return this.data?this.data.length:0}}),d.prototype.totalSize=0,d.prototype.client=null,d.prototype.data=null,d.prototype.model="",d.prototype.returnType="object",d.prototype.dataType=d.InstanceDataType,d.prototype.paginationWindow=100,d.prototype.sortBy=null,d.prototype._initialPaginationWindow=100,d.prototype.predicate=null,d.prototype.isFiring=!1,d.prototype.pagedToEnd=!1,d.prototype._firingRequest="",d.prototype._nextServerFromId="",d.prototype._nextDBFromId="",d._supportedEvents=["change","change:data","change:reset","change:property","change:insert","change:remove","change:move","error"].concat(l._supportedEvents),l.initClass.apply(d,[d,"Query"]),e.exports=d},"59JX":function(e,t,n){(function(t){var n,i=t.crypto||t.msCrypto;if(i&&i.getRandomValues){var r=new Uint8Array(16);n=function(){return i.getRandomValues(r),r}}if(!n){var o=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}e.exports=n}).call(t,n("DuR2"))},"5WAC":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n("NOS6"),s=n("+uDm"),a=s.STARTED,c=(s.PAUSED,s.FINISHED),l=function(){function e(t){i(this,e),this.clientId=t.clientId,this.conversation=t.conversation,this.publisher=new o({clientId:this.clientId,conversation:this.conversation}),this.intervalId=0,this.lastKeyId=0,this._handleKeyPress=this._handleKeyPress.bind(this),this._handleKeyDown=this._handleKeyDown.bind(this),this.setInput(t.input)}return r(e,[{key:"destroy",value:function(){this._removeInput(this.input),this.publisher.destroy()}},{key:"setInput",value:function(e){e!==this.input&&(this._removeInput(this.input),this.input=e,this.input.addEventListener("keypress",this._handleKeyPress),this.input.addEventListener("keydown",this._handleKeyDown))}},{key:"_removeInput",value:function(e){e&&(e.removeEventListener("keypress",this._handleKeyPress),e.removeEventListener("keydown",this._handleKeyDown),this.input=null)}},{key:"setConversation",value:function(e){e!==this.conversation&&(this.conversation=e,this.publisher.setConversation(e))}},{key:"_handleKeyPress",value:function(e){var t=this;this.lastKeyId&&window.clearTimeout(this.lastKeyId),this.lastKeyId=window.setTimeout(function(){t.lastKeyId=0;var e=!t.input.value;t.send(e?c:a)},50)}},{key:"_handleKeyDown",value:function(e){-1!==[8,46,13].indexOf(e.keyCode)&&this._handleKeyPress()}},{key:"send",value:function(e){this.publisher.setState(e)}}]),e}();e.exports=l},"6hGd":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n("jPMo"),s=n("P+Qc"),a=n("ozQU"),c=n("H8F6"),l=n("VdYS"),u=function(){function e(t){i(this,e),this.client=t.client,t.socketManager.on("message",this._handleChange,this)}return r(e,[{key:"_handleChange",value:function(e){"change"===e.data.type?this._processChange(e.data.body):"operation"===e.data.type&&this.client.trigger("websocket:operation",{data:e.data.body})}},{key:"_processChange",value:function(e){switch(e.operation){case"create":s.info("Websocket Change Event: Create "+e.object.type+" "+e.object.id),s.debug(e.data),this._handleCreate(e);break;case"delete":s.info("Websocket Change Event: Delete "+e.object.type+" "+e.object.id),s.debug(e.data),this._handleDelete(e);break;case"update":s.info("Websocket Change Event: Patch "+e.object.type+" "+e.object.id+": "+e.data.map(function(e){return e.property}).join(", ")),s.debug(e.data),this._handlePatch(e)}}},{key:"_handleCreate",value:function(e){e.data.fromWebsocket=!0,this.client._createObject(e.data)}},{key:"_handleDelete",value:function(e){var t=this.getObject(e);t&&t._handleWebsocketDelete(e.data)}},{key:"_handlePatch",value:function(e){var t=this.getObject(e);if(t)try{t._inLayerParser=!0,o.layerParse({object:t,type:e.object.type,operations:e.data,client:this.client}),t._inLayerParser=!1}catch(t){s.error("websocket-manager: Failed to handle event",e.data)}else switch(o.typeFromID(e.object.id)){case"channels":l._loadResourceForPatch(e.data)&&this.client.getObject(e.object.id,!0);break;case"conversations":c._loadResourceForPatch(e.data)&&this.client.getObject(e.object.id,!0);break;case"messages":a._loadResourceForPatch(e.data)&&this.client.getMessage(e.object.id,!0)}}},{key:"getObject",value:function(e){return this.client.getObject(e.object.id)}},{key:"destroy",value:function(){this.client=null}}]),e}();u.prototype.client=null,e.exports=u},"9HRS":function(e,t){e.exports="//static.naukimg.com/s/5/102/i/chat-icebreaker.png"},ANxG:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=window.interfaces,a=s.Virtual,c=(s.VirtualDom,function(e){function t(){var n,o,s;i(this,t);for(var a=arguments.length,c=Array(a),l=0;l<a;l++)c[l]=arguments[l];return n=o=r(this,e.call.apply(e,[this].concat(c))),o.state={isSearchShown:!1},o._searchInput=null,s=n,r(o,s)}return o(t,e),t.prototype._search=function(e){this.props.onFilter(e.target.value)},t.prototype._toogleSearch=function(){var e=this;this.setState({isSearchShown:!this.state.isSearchShown},function(){e.state.isSearchShown?e._searchInput.focus():e.props.onFilter(null)})},t.prototype.render=function(){var e=this,t=this.props.conversations,n=t.filter(function(e){return e.unreadCount>0}).length,i=0===n?"All Messages":"New Messages ("+n+")";return a.createElement("div",{className:"_header"},this.state.isSearchShown?a.createElement("div",{className:"_search"},a.createElement("input",{id:"convSearchField",placeholder:"Search on Name, Company or Designation",ref:function(t){return e._searchInput=t},onInput:this._search.bind(this)}),a.createElement("a",{href:"javascript:void(0);",className:"_action",onClick:this._toogleSearch.bind(this)},a.createElement("i",{class:"fontIcon wf-chat-cross"}))):a.createElement("div",{className:"_inner"},a.createElement("p",{className:"_bold"},i),a.createElement("a",{href:"javascript:void(0);",className:"_action",onClick:this._toogleSearch.bind(this)},a.createElement("i",{className:"fontIcon wf-chat-search"}))))},t}(a.PureComponent));t.a=c},Aw5G:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("+SiN"),a=n("UG01"),c=n("/CmL"),l=n("+SiN"),u=n("sQD6"),h=window.interfaces.Virtual,d=function(e){function t(){return i(this,t),r(this,e.apply(this,arguments))}return o(t,e),t.prototype._getMeta=function(e){return e&&e.META_DATA?JSON.parse(e.META_DATA):{}},t.prototype.getMessageStatus=function(e,t){return e?h.createElement("span",{className:"tick-font-wrapper"},h.createElement("i",{class:"fontIcon wf-chat-double-tick read-tick"})):t?h.createElement("span",{className:"tick-font-wrapper"},h.createElement("i",{class:"fontIcon wf-chat-double-tick"})):h.createElement("span",{className:"tick-font-wrapper"},h.createElement("i",{class:"fontIcon wf-chat-single-tick"}))},t.prototype.getMessage=function(e){return"text/plain"==e.mimeType?e.content:"File Attached"},t.prototype.renderUnreadCount=function(e){var t=e,n=2==t.toString().length?"11px":t.toString().length>=3?"9px":"";if(t)return h.createElement("span",{className:"unreadMessages _info",style:{fontSize:n}},t)},t.prototype.renderLastMessageDate=function(e){var t=void new Date;switch(e instanceof Date||(e=new Date),s.c(e)){case"today":t=s.b(e);break;case"yesterday":t=c.a.YESTERDAY_LABEL;break;case"before":default:t=s.d(e)}return h.createElement("span",null,t)},t.prototype.getMessage=function(e){return e.mimeType?"text/plain"==e.mimeType?Object(u.d)(e.content):"File Attached":""},t.prototype._openChat=function(e){this.props.onClick(e)},t.prototype.render=function(e){var t=e.conversation,n=e.conversation.lastMessage||{},i=n.readTime||n.deliveryTime?"translate-X":"",r=Object(u.a)(t.participants,this.props.user),o=this._getMeta(r),s=o&&o.designation,c=o&&o.employerName,d=s+" at "+c,p=n.senderIdentityId&&n.senderIdentityId.toLowerCase(),f=r.IDENTITY_ID.toLowerCase()==p;s||c?o&&!o.employerName&&o.designation&&(d=s):d="Fresher";var y=r.NAME&&Object(l.h)(r.NAME)||"Candidate",g=this.renderUnreadCount(parseInt(t.unreadMessageCount)),v=n&&this.getMessage(n)||"NA";return h.createElement("li",{className:"_item",key:key,onClick:this._openChat.bind(this,t)},h.createElement("div",{style:{width:"100%"}},h.createElement("div",{className:"_user"},h.createElement(a.a,{user:r})),h.createElement("p",{className:"_name _ellipses",title:y},y),h.createElement("p",{className:"_desc _ellipses",title:d},d),h.createElement("p",{class:"_msg _ellipses",title:v},v)),h.createElement("div",null,h.createElement("span",null,g),h.createElement("p",{className:"last-chat"},n.createdAt&&h.createElement("span",{className:"_info "+i},h.createElement("span",{className:"_time"},this.renderLastMessageDate(new Date(n.createdAt))),!f&&this.getMessageStatus(n.readTime,n.deliveryTime)))))},t}(h.PureComponent);t.a=d},"B+kz":function(e,t,n){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},l=n("zi+W"),u=n("jPMo"),h=n("kesd"),d=h.SYNC_STATE,p=n("4wNg"),f=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),a(t,[{key:"_fetchData",value:function(e){var t=this,n=this._getSortField();this.client.dbManager.loadConversations(n,this._nextDBFromId,e,function(e){e.length&&t._appendResults({data:e},!0)});var i="conversations?sort_by="+n+"&page_size="+e+(this._nextServerFromId?"&from_id="+this._nextServerFromId:"");i!==this._firingRequest&&(this.isFiring=!0,this._firingRequest=i,this.client.xhr({telemetry:{name:"conversation_query_time"},url:this._firingRequest,method:"GET",sync:!1},function(n){return t._processRunResults(n,i,e)}))}},{key:"_getSortField",value:function(){return this.sortBy&&this.sortBy[0]&&this.sortBy[0]["lastMessage.sentAt"]?"last_message":"created_at"}},{key:"_getItem",value:function(e){switch(u.typeFromID(e)){case"messages":for(var n=0;n<this.data.length;n++){var i=this.data[n];if(i.lastMessage&&i.lastMessage.id===e)return i.lastMessage}return null;case"conversations":return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_getItem",this).call(this,e)}}},{key:"_appendResultsSplice",value:function(e){var t=this.data,n=this._getInsertIndex(e,t);t.splice(n,0,this._getData(e))}},{key:"_handleEvents",value:function(e,t){switch(e){case"conversations:change":this._handleChangeEvent("conversations",t);break;case"conversations:add":this._handleAddEvent("conversations",t);break;case"conversations:remove":this._handleRemoveEvent("conversations",t)}}},{key:"_handleChangeEvent",value:function(e,t){var n=this._getIndex(t.target.id);if(this.dataType===p.ObjectDataType){var r=t.getChangesFor("id");r.length&&(n=this._getIndex(r[0].oldValue))}if(-1!==n){var o=this._getSortField(),s=t.hasProperty("lastMessage")&&"last_message"===o,a=void 0;this.dataType===p.ObjectDataType?s?(a=this._getInsertIndex(t.target,this.data),this.data.splice(n,1),this.data.splice(a,0,this._getData(t.target)),this.data=this.data.concat([])):this.data=[].concat(i(this.data.slice(0,n)),[t.target.toObject()],i(this.data.slice(n+1))):s&&(a=this._getInsertIndex(t.target,this.data))!==n&&(this.data.splice(n,1),this.data.splice(a,0,t.target)),this._triggerChange({type:"property",target:this._getData(t.target),query:this,isChange:!0,changes:t.changes}),s&&a!==n&&this._triggerChange({type:"move",target:this._getData(t.target),query:this,isChange:!1,fromIndex:n,toIndex:a})}}},{key:"_getInsertIndex",value:function(e,t){if(!e.isSaved())return 0;var n=this._getSortField(),i=void 0;if("created_at"===n){for(i=0;i<t.length;i++){var r=t[i];if(r.syncState===d.NEW||r.syncState===d.SAVING);else if(e.createdAt>=r.createdAt)break}return i}var o=-1,s=e.lastMessage?e.lastMessage.sentAt:e.createdAt;for(i=0;i<t.length;i++){var a=t[i];if(a.id===e.id)o=i;else if(a.syncState===d.NEW||a.syncState===d.SAVING);else{var c=a.lastMessage?a.lastMessage.sentAt:a.createdAt;if(s>=c)break}}return-1===o||o>i?i:i-1}},{key:"_handleAddEvent",value:function(e,t){var n=this,i=t[e].filter(function(e){return-1===n._getIndex(e.id)});if(i.length){var r=this.data;i.forEach(function(e){var t=n._getInsertIndex(e,r);r.splice(t,0,n._getData(e)),n.dataType===p.ObjectDataType&&(n.data=[].concat(r)),n.totalSize+=1;var i=n._getData(e);n._triggerChange({type:"insert",index:t,target:i,query:n})})}}},{key:"_handleRemoveEvent",value:function(e,t){var n=this,r=[];t[e].forEach(function(e){var t=n._getIndex(e.id);-1!==t&&(e.id===n._nextDBFromId&&(n._nextDBFromId=n._updateNextFromId(t)),e.id===n._nextServerFromId&&(n._nextServerFromId=n._updateNextFromId(t)),r.push({data:e,index:t}),n.dataType===p.ObjectDataType?n.data=[].concat(i(n.data.slice(0,t)),i(n.data.slice(t+1))):n.data.splice(t,1))}),this.totalSize-=r.length,r.forEach(function(e){n._triggerChange({type:"remove",index:e.index,target:n._getData(e.data),query:n})})}}]),t}(p);f._supportedEvents=[].concat(p._supportedEvents),f.MaxPageSize=100,f.prototype.model=p.Conversation,l.initClass.apply(f,[f,"ConversationsQuery"]),e.exports=f},BoTL:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("VLJS"),a=n("2Xjr"),c=n("kAR7"),l=n("pnr+"),u=n("YE0g"),h=n("IpBb"),d=n("sgBt"),p=n("sQD6"),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},y=window.interfaces.Virtual,g=function(e){function t(n){i(this,t);var o=r(this,e.apply(this,arguments));return o._message=null,o._list=null,o._jobseeker=null,o._index=null,o.uba=h.a.getInstance(),o.trackUBA=function(e,t,n,i,r){var s=n||o.props.conversation,a=o.props.user,c=a&&a.META_DATA&&JSON.parse(a.META_DATA)||{},l=s&&s.receiver.META_DATA&&JSON.parse(s.receiver.META_DATA)||{},u={};"file"==e&&(u={hasAttachment:!0,attachmentSize:t.fileSize&&parseInt(t.fileSize/1024)+" KB"||"0 KB",attachmentType:t.fileType&&function(e){return e.substr(e.lastIndexOf(".")+1)}(t.fileName)||""});var h=s&&s.receiver&&s.receiver.IDENTITY_ID,d=t&&t.isFirstMsg||!1;o.uba.track("chatMsgEvent",f({chatId:s.conversationId,lastMsgReceivedTime:o.lastMsgReceivedTime,fromId:a.IDENTITY_ID,fromCompany:c.employerName||c.cvId,toId:h||"",status:i,msgId:o.lastMessageId,cvId:l.cvId||"",hasJob:"job"==e||!1,isFirstMsg:d,chatSource:r},u)),o.lastMessageId="",o.props.chats.chatSource&&o.props.setChatSource("")},o.uploadFile=function(e,t){var n=o.props.chats.messages,i=!(n[t].length>0);e.isFirstMsg=i,o.props.uploadFile(e,t,i,function(t){o.lastMessageId=t.messageId,o.trackUBA("file",e,o.props.conversation),o.props.setExternalContent(null)})},o.initFileUploader=function(e){o.props.initFileUploader(e,o.props.conversation)},o.unBlockUser=function(){o.props.unBlockUser(o.props.conversation)},o.blockUser=function(){o.props.blockUser(o.props.conversation)},o.trackUBA=o.trackUBA.bind(o),o}return o(t,e),t.prototype.componentDidMount=function(){this.props.loadMessages(this.props.conversation,1)},t.prototype.componentWillReceiveProps=function(e){var t=e.conversation;e.chats.messages[t.conversationId]&&e.chats.messages[t.conversationId].length>0&&this._scrollBottom()},t.prototype._has_date_changed=function(e,t){return e instanceof Date&&t instanceof Date&&e.toDateString()!==t.toDateString()},t.prototype.chatTimeline=function(e){if(!e instanceof Date)return"";switch(Object(p.f)(e)){case"today":return y.createElement("p",{className:"_timeline"},y.createElement("span",null,"Today"));case"yesterday":return y.createElement("p",{className:"_timeline"},y.createElement("span",null,"Yesterday"));case"before":return y.createElement("p",{className:"_timeline"},y.createElement("span",null,Object(p.e)(e,!0)));default:return""}},t.prototype.closeChat=function(e,t){this.props.dispatch(Object(d.closeChatWindow)(e,t)),this.props.dispatch({type:"TOGGLE_ATTACHMENT_ERROR",payload:{show:!1}})},t.prototype._scrollBottom=function(){var e=this;setTimeout(function(){e._message&&(e._message.scrollTop=e._message.scrollHeight)},0)},t.prototype.onInput=function(e,t){var n=parseInt(t.currentTarget.style.height);this._message.style.height=329-n+"px",this._list&&(this._list.style.minHeight=329-n+"px"),this._scrollBottom()},t.prototype._resetHeight=function(){this._message.style.height="290px",this._list&&(this._list.style.minHeight="290px")},t.prototype._isYou=function(e,t,n){return!n||e.toLowerCase()===t.toLowerCase()},t.prototype._breakAndSendMessage=function(e,t,n){var i=this,r=this.props.chats.messages,o=!(r[e.conversationId].length>0),s=this.props.chats.multiPartContent.length,a=this.props.chats.chatSource,c=s?this.props.chats.multiPartContent:[t];this.props.sendMessage(c,e,this._index,o,function(t){i.lastMessageId=t.messageId,i.trackUBA(n||"message",{isFirstMsg:o},e,null,a)}),this.props.chats.externalContent&&this.props.setExternalContent(null),this.props.chats.multiPartContent&&this.props.setMultiPartContent([]),this._resetHeight(),this._scrollBottom()},t.prototype.sendMessage=function(e,t,n){var i=this;t&&this.props.chats.externalContent&&t.trim().toLowerCase()===this.props.chats.externalContent.trim().toLowerCase()?this._breakAndSendMessage(e,t,n):(this.props.chats.multiPartContent&&this.props.setMultiPartContent([]),this.props.chats.externalContent&&this.props.setExternalContent(null),setTimeout(function(){i._breakAndSendMessage(e,t,n)},0))},t.prototype._loadMore=function(e){},t.prototype.getFileUploadChip=function(e){var t=this;if(!e||!e.content||-1==e.content.indexOf("{"))return null;var n=e.content&&JSON.parse(e.content)||{},i=n.fileName||"",r=n.fileSize&&Math.floor(Number(n.fileSize)/1024)+" KB"||"0 KB";return y.createElement("div",{className:"msg-with-attachment _msg"},y.createElement("div",{className:"msg-part-icon"},y.createElement("div",{className:"fontIcon wf-chat-attach-doc"})),y.createElement("div",{className:"msg-attach-val"},y.createElement("p",null,i),y.createElement("p",null,r),y.createElement("p",{className:"preview-attach"},y.createElement("a",{onClick:function(){return t.props.downloadFile({conversationId:e.conversationId,messageId:e.messageId,fileName:i})}},"View File"))))},t.prototype.getMessageStatus=function(e,t,n){return t?y.createElement("i",{className:"fontIcon chatwindow-tick wf-chat-double-tick read-tick"}):e?y.createElement("i",{className:"fontIcon chatwindow-tick wf-chat-double-tick"}):n?y.createElement("i",{className:"fontIcon chatwindow-tick wf-chat-single-tick"}):y.createElement("i",{className:"fontIcon chatwindow-not-send wf-chat-msg-not-send"})},t.prototype.render=function(){var e=this,t=this.props,n=t.conversation,i=t.index,r=t.chats,o=(t.loading,this.props.user||this.props.conversation.participants[0]),h=n.conversationId;this._jobseeker=Object(p.a)(n.participants,o),this._index=i,"jobseeker"===this.props.mode&&(this._index=i+1);var d={right:310*this._index+10+"px"},f=r.messages[h]&&r.messages[h].length||!1;return y.createElement("div",{className:"_message",style:d},y.createElement(s.a,{recruiter:o,user:this._jobseeker,closeChat:this.closeChat.bind(this,this._jobseeker,i),dispatch:this.props.dispatch,conversationId:h,isMsg:f,conversation:this.props.conversation,blocked:n.blocked,unBlockUser:function(){return e.unBlockUser()},blockUser:function(){return e.blockUser()},deleteConversation:function(){return e.props.deleteConversation(n)},getLastSeen:this.props.getLastSeen}),r.attachmentError.showAttachmentError?y.createElement(l.a,{hideAttachmentError:function(){return e.props.hideAttachmentError()},attachmentError:r.attachmentError}):null,r.loading&&r.loading==h?y.createElement(c.a,null):y.createElement("div",{className:"_message_inner",ref:function(t){return e._message=t}},f?y.createElement("ul",{className:"_list",ref:function(t){return e._list=t}},r.messages[h]&&r.messages[h].map(function(t,i){var o=e._isYou(n.p2IdentityId,t.senderIdentityId,t.messageId);return y.createElement("li",{className:"_item "+(o?"_you":"_user"),key:t.messageId},(0===i||e._has_date_changed(new Date(t.createdAt),new Date(r.messages[h][i-1].createdAt)))&&e.chatTimeline(new Date(t.createdAt)),y.createElement("div",{className:"_inner"},"text/plain"===t.mimeType||"app/text"===t.mimeType?y.createElement("p",{className:"_msg"},Object(p.h)(t.content)):e.getFileUploadChip(t),y.createElement("p",{className:"_info"},y.createElement("span",null,Object(p.g)(new Date(t.createdAt))),o&&e.getMessageStatus(t.deliveryTime,t.readTime,t.messageId))))})):y.createElement(u.a,null)),y.createElement(a.a,{setMultiPartContent:this.props.setMultiPartContent,setChatSource:this.props.setChatSource,multiPartContent:this.props.chats.multiPartContent,setExternalContent:this.props.setExternalContent,externalContent:r.externalContent,selectJob:this.props.selectJob,selectedLiveJob:r.selectedLiveJob,onInput:this.onInput.bind(this,i),onSend:this.sendMessage.bind(this,n),conversationId:h,initFileUploader:this.initFileUploader,unBlockUser:function(){return e.unBlockUser()},blocked:n.blocked,user:this._jobseeker,file:r.file,cancelUpload:function(){return e.props.cancelUpload()},uploadFile:this.uploadFile,uploadJob:this.props.uploadJob,dispatchAttachLb:this.props.dispatchAttachLb,hideAttachmentError:function(){return e.props.hideAttachmentError()},trackUBA:this.trackUBA}))},t}(y.PureComponent);t.a=g},Cehq:function(e,t){e.exports="//static.naukimg.com/s/5/102/i/no-search-result.png"},E7xV:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n("zi+W"),c=n("4wNg"),l=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),s(t,[{key:"_fetchData",value:function(e){var t=this;this._nextDBFromId||this.client.dbManager.loadIdentities(function(e){e.length&&t._appendResults({data:e},!0)});var n="identities?page_size="+e+(this._nextServerFromId?"&from_id="+this._nextServerFromId:"");n!==this._firingRequest&&(this.isFiring=!0,this._firingRequest=n,this.client.xhr({telemetry:{name:"identity_query_time"},url:n,method:"GET",sync:!1},function(i){return t._processRunResults(i,n,e)}))}},{key:"_appendResultsSplice",value:function(e){this.data.push(this._getData(e))}},{key:"_handleEvents",value:function(e,t){switch(e){case"identities:change":this._handleChangeEvent("identities",t);break;case"identities:add":this._handleAddEvent("identities",t);break;case"identities:remove":this._handleRemoveEvent("identities",t)}}}]),t}(c);l._supportedEvents=[].concat(c._supportedEvents),l.MaxPageSize=500,l.prototype.model=c.Identity,a.initClass.apply(l,[l,"IdentitiesQuery"]),e.exports=l},Er7U:function(e,t,n){"use strict";(function(t){var n=t.getNativeSupport&&t.getNativeSupport("setImmediate");if(n)e.exports=n;else{var i=function(){for(s=!1,clearTimeout(r),r=0,o=0,a.push(o);a.length;){var e=a.shift();if("function"==typeof e)try{e()}catch(e){}else e>=c&&(a=[])}},r=0,o=0,s=!1,a=[],c=10;e.exports=function(e){if("function"!=typeof e)throw new Error("Function expected in defer");a.push(e),s||(s=!0,"undefined"!=typeof document?window.postMessage({type:"layer-set-immediate"},"*"):window.postMessage({type:"layer-set-immediate"}),r=setTimeout(i,0))},e.exports.flush=function(){return i()},e.exports.reset=function(){a=[]},addEventListener("message",function(e){"layer-set-immediate"===e.data.type&&i()})}}).call(t,n("DuR2"))},EvUg:function(e,t,n){"use strict";function i(e){if(!e)return{};var t=e.split(","),n={};return t.forEach(function(e){var t=e.split(";");if(2===t.length){var i=t[0].replace(/<(.*)>/,"$1").trim(),r=t[1].replace(/rel='?(.*)'?/,"$1").trim();n[r]=i}}),n}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o="undefined"==typeof window?n(0):null;e.exports=function(t,n){var s=Date.now(),a=o?new o:new XMLHttpRequest,c=(t.method||"GET").toUpperCase(),l=function(){var o={"content-type":this.getResponseHeader("content-type")},a={status:this.status,success:this.status&&this.status<300,xhr:this},c=String(o["content-type"]).split(/;/)[0].match(/^application\/json/)||"json"===t.format;if("blob"===this.responseType||"arraybuffer"===this.responseType)0===this.status?a.data=new Error("Connection Failed"):a.data="function"==typeof this.response?this.responseText:this.response;else{if(c&&this.responseText)try{a.data=JSON.parse(this.responseText)}catch(e){a.data={code:999,message:"Invalid JSON from server",response:this.responseText},a.status=999}else a.data=this.responseText;e.exports.trigger({target:this,status:this.responseText||this.status?"connection:success":"connection:error",duration:Date.now()-s,request:t}),this.responseText||this.status?404===this.status&&"object"!==r(a.data)?a.data={id:"operation_not_found",message:"Endpoint "+(t.method||"GET")+" "+t.url+" does not exist",status:this.status,httpStatus:404,code:106,url:"https://docs.layer.com/reference/client_api/errors"}:"string"==typeof a.data&&this.status>=400&&(a.data={id:"unknown_error",message:a.data,status:this.status,httpStatus:this.status,code:0,url:"https://www.google.com/search?q=doh!"}):(a.status=408,a.data={id:"request_timeout",message:"The server is not responding please try again in a few minutes",url:"https://docs.layer.com/reference/client_api/errors",code:0,status:408,httpStatus:408})}if(t.headers&&(t.headers.accept||"").match(/application\/vnd.layer\+json/)){var l=this.getResponseHeader("link");l&&(a.Links=i(l))}a.xhr=this,n&&n(a)};a.onload=l,a.onerror=a.ontimeout=l;var u=Object.keys(t.headers||{}),h={};u.forEach(function(e){"content-type"===e.toLowerCase()?h["content-type"]=t.headers[e]:h[e.toLowerCase()]=t.headers[e]}),t.headers=h;var d="";t.data&&("undefined"!=typeof Blob&&t.data instanceof Blob?d=t.data:t.headers&&(String(t.headers["content-type"]).match(/^application\/json/)||"application/vnd.layer-patch+json"===String(t.headers["content-type"]))?d="string"==typeof t.data?t.data:JSON.stringify(t.data):t.data&&"object"===r(t.data)?Object.keys(t.data).forEach(function(e){d&&(d+="&"),d+=e+"="+t.data[e]}):d=t.data),d&&"GET"===c&&(t.url+="?"+d),a.open(c,t.url,!0),t.timeout&&(a.timeout=t.timeout),t.withCredentials&&(a.withCredentials=!0),t.responseType&&(a.responseType=t.responseType),t.headers&&Object.keys(t.headers).forEach(function(e){return a.setRequestHeader(e,t.headers[e])});try{"GET"===c?a.send():a.send(d)}catch(e){}};var s=[];e.exports.addConnectionListener=function(e){return s.push(e)};var a=!1;e.exports.trigger=function(e){if(!a){a=!0;try{s.forEach(function(t){return t(e)})}catch(e){}a=!1}}},FyQ2:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r={chatId:"",fromType:"recruiter",fromId:"",fromCompany:"",toId:"",toType:"jobseeker",toCompany:"",actionType:"click"},o={getDefaultObj:function(){return{chatMsgEvent:i({},r,{lastMsgReceivedTime:"",msgId:"",isFirstMsg:!1,hasAttachment:!1,attachmentSize:"",attachmentType:"",hasJob:!1,jobId:""}),chatBlocked:i({},r,{blockedBy:"recruiter"}),chatButtonClick:{actionType:"click",fromId:"",fromType:"recruiter",buttonSource:""},debugView:{actionType:"view",recruiterId:"undefined"!=typeof userId?userId:"",companyId:"undefined"!=typeof companyId?companyId:"",moduleName:"chat",pageName:"undefined"!=typeof pageName?pageName:""},debugClick:{actionType:"click",recruiterId:"undefined"!=typeof userId?userId:"",companyId:"undefined"!=typeof companyId?companyId:"",moduleName:"chat",pageName:"undefined"!=typeof pageName?pageName:""}}}}},H8F6:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},c=n("zi+W"),l=n("zTev"),u=n("XsJf"),h=n("sDhs"),d=n("pLky"),p=n("jPMo"),f=n("kesd"),y=n("yUvy"),g=n("P+Qc"),v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),e.participants||(e.participants=[]);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.isInitializing=!0;var o=n.getClient();return e&&e.fromServer||(n.participants=o._fixIdentities(n.participants),-1===n.participants.indexOf(o.user)&&n.participants.push(o.user)),n._register(),n.isInitializing=!1,n}return o(t,e),s(t,[{key:"destroy",value:function(){this.lastMessage=null,this.clientId&&this.getClient()._removeConversation(this),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.participants=null,this.metadata=null}},{key:"createMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="string"==typeof e?{parts:[{body:e,mimeType:"text/plain"}]}:e;return t.clientId=this.clientId,t.conversationId=this.id,new h(t)}},{key:"_setupMessage",value:function(e){var t=void 0;this.lastMessage?t=this.lastMessage.position+1:this._lastMessagePosition?(t=this._lastMessagePosition+1,this._lastMessagePosition=0):t=0,e.position=t,this.lastMessage=e}},{key:"send",value:function(e){var n=this.getClient();if(!n)throw new Error(d.dictionary.clientMissing);var i=Boolean(this._sendDistinctEvent);return this._sendDistinctEvent&&this._handleLocalDistinctConversation(),i||this.syncState!==f.SYNC_STATE.NEW?(e&&this._setupMessage(e),this):(-1===this.participants.indexOf(n.user)&&this.participants.push(n.user),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"send",this).call(this,e))}},{key:"_handleLocalDistinctConversation",value:function(){var e=this._sendDistinctEvent;return this._sendDistinctEvent=null,this._triggerAsync("conversations:sent",e),this}},{key:"_getSendData",value:function(e){var t=p.isEmpty(this.metadata);return{method:"Conversation.create",data:{participants:this.participants.map(function(e){return e.id}),distinct:this.distinct,metadata:t?null:this.metadata,id:this.id}}}},{key:"markAllMessagesAsRead",value:function(e){if(!this.isSaved())return this;e||(e=this.lastMessage);var t=e&&e.isSaved()?e.position:null;return this._xhr({method:"POST",url:"/mark_all_read",data:{position:t},sync:{operation:"RECEIPT"}},function(e){e.success||g.error("Mark all as read failed; currently this error is not handled by Layer WebSDK")}),this}},{key:"_populateFromServer",value:function(e){var n=this,i=this.getClient();this._disableEvents=this.syncState===f.SYNC_STATE.NEW,this.participants=i._fixIdentities(e.participants),this.participants.forEach(function(e){return e.on("identities:change",n._handleParticipantChangeEvent,n)}),this.distinct=e.distinct,this.unreadCount=e.unread_message_count,this.totalMessageCount=e.total_message_count,this.isCurrentParticipant=-1!==this.participants.indexOf(i.user),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_populateFromServer",this).call(this,e),"string"==typeof e.last_message?this.lastMessage=i.getMessage(e.last_message):e.last_message&&(this.lastMessage=i._createObject(e.last_message)),this._register(),this._disableEvents=!1}},{key:"_createResultConflict",value:function(e){this._populateFromServer(e.data),this._triggerAsync(this.constructor.eventPrefix+":sent",{result:t.FOUND_WITHOUT_REQUESTED_METADATA})}},{key:"addParticipants",value:function(e){var t=this,n=this.getClient(),i=n._fixIdentities(e),r=i.filter(function(e){return-1===t.participants.indexOf(e)});return this._patchParticipants({add:r,remove:[]}),this}},{key:"removeParticipants",value:function(e){var t={};this.participants.forEach(function(e){return t[e.id]=!0});var n=this.getClient(),i=n._fixIdentities(e),r=i.filter(function(e){return t[e.id]});if(0===r.length)return this;if(r.length===this.participants.length)throw new Error(d.dictionary.moreParticipantsRequired);return this._patchParticipants({add:[],remove:r}),this}},{key:"replaceParticipants",value:function(e){if(!e||!e.length)throw new Error(d.dictionary.moreParticipantsRequired);var t=this.getClient(),n=t._fixIdentities(e),i=this._getParticipantChange(n,this.participants);return this._patchParticipants(i),this}},{key:"_patchParticipants",value:function(e){var t=this;this._applyParticipantChange(e),this.isCurrentParticipant=-1!==this.participants.indexOf(this.getClient().user);var n=[];e.remove.forEach(function(e){n.push({operation:"remove",property:"participants",id:e.id})}),e.add.forEach(function(e){n.push({operation:"add",property:"participants",id:e.id})}),this._xhr({url:"",method:"PATCH",data:JSON.stringify(n),headers:{"content-type":"application/vnd.layer-patch+json"}},function(e){e.success||"authentication_required"===e.data.id||t._load()})}},{key:"_applyParticipantChange",value:function(e){var t=[].concat(this.participants);e.add.forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),e.remove.forEach(function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}),this.participants=t}},{key:"leave",value:function(){if(this.isDestroyed)throw new Error(d.dictionary.isDestroyed);this._delete("mode="+f.DELETION_MODE.MY_DEVICES+"&leave=true")}},{key:"delete",value:function(e){if(this.isDestroyed)throw new Error(d.dictionary.isDestroyed);var t=void 0;switch(e){case f.DELETION_MODE.ALL:case!0:t="mode="+f.DELETION_MODE.ALL;break;case f.DELETION_MODE.MY_DEVICES:t="mode="+f.DELETION_MODE.MY_DEVICES+"&leave=false";break;default:throw new Error(d.dictionary.deletionModeUnsupported)}this._delete(t)}},{key:"_handlePatchEvent",value:function(e,n,i){this._inLayerParser=!1;try{var r=this._disableEvents;if(this._disableEvents=!1,"participants"===i[0]){var o=this.getClient();n=n.map(function(e){return o.getIdentity(e.id)}),e=e.map(function(e){return o.getIdentity(e.id)}),this.__updateParticipants(e,n)}else a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_handlePatchEvent",this).call(this,e,n,i);this._disableEvents=r}catch(e){}this._inLayerParser=!0}},{key:"_getParticipantChange",value:function(e,t){var n={};return n.add=e.filter(function(e){return-1===t.indexOf(e)}),n.remove=t.filter(function(t){return-1===e.indexOf(t)}),n}},{key:"_deleteResult",value:function(e,n){var i=this.getClient();e.success||e.data&&("not_found"===e.data.id||"authentication_required"===e.data.id)||t.load(n,i)}},{key:"_register",value:function(){var e=this.getClient();e&&e._addConversation(this)}},{key:"__adjustUnreadCount",value:function(e){if(e<0)return 0}},{key:"__updateUnreadCount",value:function(e,t){var n=this;this._inLayerParser?(void 0===this._oldUnreadCount&&(this._oldUnreadCount=t),this._updateUnreadCountTimeout&&clearTimeout(this._updateUnreadCountTimeout),this._updateUnreadCountTimeout=setTimeout(function(){return n._updateUnreadCountEvent()},1e3)):this._updateUnreadCountEvent()}},{key:"_updateUnreadCountEvent",value:function(){if(!this.isDestroyed){var e=this._oldUnreadCount,t=this.__unreadCount;this._oldUnreadCount=void 0,t!==e&&this._triggerAsync("conversations:change",{newValue:t,oldValue:e,property:"unreadCount"})}}},{key:"__updateLastMessage",value:function(e,t){e&&t&&e.id===t.id||this._triggerAsync("conversations:change",{property:"lastMessage",newValue:e,oldValue:t})}},{key:"__updateParticipants",value:function(e,t){var n=this;if(!this._inLayerParser){var i=this._getParticipantChange(e,t);i.add.forEach(function(e){return e.on("identities:change",n._handleParticipantChangeEvent,n)}),i.remove.forEach(function(e){return e.off("identities:change",n._handleParticipantChangeEvent,n)}),(i.add.length||i.remove.length)&&(i.property="participants",i.oldValue=t,i.newValue=e,this._triggerAsync("conversations:change",i))}}},{key:"_handleParticipantChangeEvent",value:function(e){var t=this;e.changes.forEach(function(n){t._triggerAsync("conversations:change",{property:"participants."+n.property,identity:e.target,oldValue:n.oldValue,newValue:n.newValue})})}}],[{key:"_createFromServer",value:function(e,n){return new t({client:n,fromServer:e,_fromDB:e._fromDB})}},{key:"create",value:function(e){if(!e.client)throw new Error(d.dictionary.clientMissing);var n={distinct:e.distinct,participants:e.client._fixIdentities(e.participants),metadata:e.metadata,client:e.client};if(n.distinct){var i=this._createDistinct(n);if(i)return i}return new t(n)}},{key:"_createDistinct",value:function(e){-1===e.participants.indexOf(e.client.user)&&e.participants.push(e.client.user);var n={};e.participants.forEach(function(e){n[e.id]=e});var i=e.client.findCachedConversation(function(t){if(t.distinct&&t.participants.length===e.participants.length){for(var i=0;i<t.participants.length;i++)if(!n[t.participants[i].id])return!1;return!0}});if(i)return i._sendDistinctEvent=new y({target:i,result:!e.metadata||p.doesObjectMatch(e.metadata,i.metadata)?t.FOUND:t.FOUND_WITHOUT_REQUESTED_METADATA},"conversations:sent"),i}}]),t}(u);v.prototype.participants=null,v.prototype.unreadCount=0,v.prototype.distinct=!0,v.prototype.lastMessage=null,v.prototype._lastMessagePosition=0,v.prototype._inMarkAllAsRead=!1,v.eventPrefix="conversations",v.FOUND_WITHOUT_REQUESTED_METADATA="FoundMismatch",v.prefixUUID="layer:///conversations/",v._supportedEvents=["conversations:sent","conversations:sent-error","conversations:loaded","conversations:loaded-error","conversations:delete","conversations:change"].concat(l._supportedEvents),c.initClass.apply(v,[v,"Conversation"]),l.subclasses.push(v),e.exports=v},I0H9:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return a});var s=(n("Kd6K"),window.interfaces.Virtual),a=function(e){function t(){return i(this,t),r(this,e.apply(this,arguments))}return o(t,e),t.prototype.componentWillMount=function(){},t.prototype.render=function(){return s.createElement("div",{className:"chat-list-empty-search"},s.createElement("div",{className:"no-result-icon "+this.props.class},s.createElement("img",{src:this.props.icon})),this.props.children)},t}(s.PureComponent)},IIOl:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},c=n("zi+W"),l=n("jPMo"),u=n("P+Qc"),h=n("pLky"),d=n("kesd"),p=d.WEBSOCKET_PROTOCOL,f=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(!n.client)throw new Error("SocketManager requires a client");return n._onMessage=n._onMessage.bind(n),n._onOpen=n._onOpen.bind(n),n._onSocketClose=n._onSocketClose.bind(n),n._onError=n._onError.bind(n),n.client.isAuthenticated&&n.client.onlineManager.isOnline&&(n.trigger("connecting",{from:"constructor",why:"initialization"}),n.connect()),n.client.on("online",n._onlineStateChange,n),n.client.on("authenticated",function(){n.trigger("connecting",{from:"constructor",why:"authenticated"}),n.connect()},n),n._lastTimestamp=Date.now(),n}return o(t,e),s(t,[{key:"_reset",value:function(){this._lastTimestamp=0,this._lastDataFromServerTimestamp=0,this._lastCounter=null,this._hasCounter=!1,this._needsReplayFrom=null}},{key:"_onlineStateChange",value:function(e){this.client.isAuthenticated&&(e.isOnline?(this.trigger("connecting",{from:"_onlineStateChange",why:"detect change to online"}),this._reconnect(e.reset)):(u.info("Websocket closed due to ambigious connection state"),this.trigger("disconnecting",{from:"_onlineStateChange",why:"detect change to offline"}),this.close()))}},{key:"_reconnect",value:function(e){this.close(),e&&this._reset(),this.connect()}},{key:"connect",value:function(e){if(!this.client.isDestroyed&&this.client.isOnline&&this.client._wantsToBeConnected){if(this._socket)return this._reconnect();this._closing=!1,this._lastCounter=-1;var t=this.client.websocketUrl+"/?session_token="+this.client.sessionToken+"&client-id="+this.client._tabId+"&layer-xdk-version="+this.client.constructor.version;u.info("Websocket Connecting");var i="undefined"==typeof WebSocket?n(1).w3cwebsocket:WebSocket;this._socket=new i(t,p),"undefined"==typeof WebSocket?(this._socket.onmessage=this._onMessage,this._socket.onclose=this._onSocketClose,this._socket.onopen=this._onOpen,this._socket.onerror=this._onError):(this._socket.addEventListener("message",this._onMessage),this._socket.addEventListener("close",this._onSocketClose),this._socket.addEventListener("open",this._onOpen),this._socket.addEventListener("error",this._onError)),this._connectionFailedId=setTimeout(this._connectionFailed.bind(this),5e3)}}},{key:"_clearConnectionFailed",value:function(){this._connectionFailedId&&(clearTimeout(this._connectionFailedId),this._connectionFailedId=0)}},{key:"_connectionFailed",value:function(){this._connectionFailedId=0;var e="Websocket failed to connect to server";u.warn(e);try{this.isOpen=!1,this._removeSocketEvents(),this._socket&&(this._socket.close(),this._socket=null)}catch(e){}this._onError(new Error(e))}},{key:"_onOpen",value:function(){this._clearConnectionFailed(),this._isOpen()&&(this._lostConnectionCount=0,this._lastSkippedCounter=0,this.isOpen=!0,this.trigger("connected"),u.debug("Websocket Connected"),this._hasCounter&&this._lastTimestamp?(this.trigger("replaying-events",{from:"resync",why:"reconnected"}),this.resync(this._lastTimestamp)):(this._enablePresence(),this._reschedulePing()))}},{key:"_isOpen",value:function(){return!!this._socket&&("undefined"==typeof WebSocket||this._socket&&this._socket.readyState===WebSocket.OPEN)}},{key:"_onError",value:function(e){this._closing||(this._clearConnectionFailed(),u.debug("Websocket Error causing websocket to close",e),this.isOpen?(this._onSocketClose(),this._socket.close(),this._socket=null):(this._removeSocketEvents(),this._lostConnectionCount++,this.trigger("schedule-reconnect",{from:"_onError",why:"websocket failed to open"}),this._scheduleReconnect()))}},{key:"sendSignal",value:function(e){this._isOpen()&&this._socket.send(JSON.stringify({type:"signal",body:e}))}},{key:"getCounter",value:function(e){var t=this;if(Date.now()-this._lastGetCounterRequest<1e3)return void(this._lastGetCounterId||(this._lastGetCounterId=setTimeout(function(){t._lastGetCounterId=0,t.getCounter(e)},Date.now()-this._lastGetCounterRequest-1e3)));this._lastGetCounterRequest=Date.now(),this._lastGetCounterId&&(clearTimeout(this._lastGetCounterId),this._lastGetCounterId=0),u.debug("Websocket request: getCounter"),this.client.socketRequestManager.sendRequest({data:{method:"Counter.read"},callback:function(t){u.debug("Websocket response: getCounter "+t.data.counter),e&&(t.success?e(!0,t.data.counter,t.fullData.counter):e(!1))},isChangesArray:!1})}},{key:"resync",value:function(e,t){var n=this;if(!e)throw new Error(h.dictionary.valueNotSupported);"number"==typeof e&&(e=new Date(e).toISOString()),this.client.socketRequestManager.cancelOperation("Event.replay"),this.client.socketRequestManager.cancelOperation("Presence.sync"),this._replayEvents(e,function(){n._enablePresence(e,function(){n.trigger("synced"),t&&t()})})}},{key:"_replayEvents",value:function(e,t){var n=this;this._isOpen()||this._needsReplayFrom?(u.info("Websocket request: _replayEvents"),this.client.socketRequestManager.sendRequest({data:{method:"Event.replay",data:{from_timestamp:e}},callback:function(i){return n._replayEventsComplete(e,t,i.success)},isChangesArray:!1})):(u.debug("Websocket request: _replayEvents updating _needsReplayFrom"),this._needsReplayFrom=e)}},{key:"_replayEventsComplete",value:function(e,t,n){var i=this;if(n)if(this._replayRetryCount=0,this._needsReplayFrom){if(this._needsReplayFrom){u.info("Websocket replay partially complete");var r=this._needsReplayFrom;this._needsReplayFrom=null,this.trigger("replaying-events",{from:"_replayEventsComplete",why:"_needsReplayFrom: "+r}),this._replayEvents(r)}}else u.info("Websocket replay complete"),t&&t();else if(this._replayRetryCount<8){var o=Math.min(this._replayRetryCount+4,11),s=l.getExponentialBackoffSeconds(20,o);u.info("Websocket replay retry in "+s+" ms"),setTimeout(function(){i.trigger("replaying-events",{from:"_replayEventsComplete",why:"_replayRetryCount: "+i._replayRetryCount}),i._replayEvents(e)},1e3*s),this._replayRetryCount++}else u.error("Websocket Event.replay has failed")}},{key:"_enablePresence",value:function(e,t){this.client.socketRequestManager.sendRequest({data:{method:"Presence.subscribe"},callback:null,isChangesArray:!1}),this.client.isPresenceEnabled&&this.client.socketRequestManager.sendRequest({data:{method:"Presence.update",data:[{operation:"set",property:"status",value:"auto"}]},callback:null,isChangesArray:!1}),e?this.syncPresence(e,t):t&&t({success:!0})}},{key:"syncPresence",value:function(e,t){if(e)return this.client.socketRequestManager.sendRequest({data:{method:"Presence.sync",data:{since:e}},isChangesArray:!0,callback:t})}},{key:"_onMessage",value:function(e){this._lostConnectionCount=0;try{var n=JSON.parse(e.data),i=this._lastCounter,r=this._lastCounter+1!==n.counter;this._hasCounter=!0,this._lastCounter=n.counter,this._lastDataFromServerTimestamp=Date.now(),r?(!this._lastSkippedCounter||this._lastSkippedCounter+t.IGNORE_SKIPPED_COUNTER_INTERVAL<Date.now()?(this.trigger("replaying-events",{from:"resync",why:"Counter skipped from "+i+" to "+n.counter}),this.resync(this._lastTimestamp)):this.trigger("ignore-skipped-counter",{from:"resync",why:"Counter skipped from "+i+" to "+n.counter+" but last resync was "+(Date.now()-this._lastSkippedCounter)+" seconds ago"}),this._lastSkippedCounter=Date.now()):this._lastTimestamp=new Date(n.timestamp).getTime(),this.trigger("message",{data:n}),this._reschedulePing()}catch(t){u.error("Layer-Websocket: Failed to handle websocket message: "+t+"\n",e.data)}}},{key:"_reschedulePing",value:function(){this._nextPingId&&clearTimeout(this._nextPingId),this._nextPingId=setTimeout(this._ping.bind(this),this.pingFrequency)}},{key:"_ping",value:function(){u.debug("Websocket ping"),this._nextPingId=0,this._isOpen()&&this.getCounter(this._reschedulePing.bind(this))}},{key:"close",value:function(){u.debug("Websocket close requested"),this._closing=!0,this.isOpen=!1,this._socket&&(this._onSocketClose(),this._socket.close(),this._socket=null)}},{key:"send",value:function(e){this._socket.send(JSON.stringify(e))}},{key:"destroy",value:function(){this.trigger("disconnecting",{from:"destroy",why:"client is being destroyed"}),this.close(),this._nextPingId&&clearTimeout(this._nextPingId),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_onSocketClose",value:function(){u.debug("Websocket closed"),this.isOpen=!1,this._closing||(this.trigger("schedule-reconnect",{from:"_onSocketClose",why:"Socket closed"}),this._scheduleReconnect()),this._removeSocketEvents(),this.trigger("disconnected")}},{key:"_removeSocketEvents",value:function(){"undefined"!=typeof WebSocket&&this._socket?(this._socket.removeEventListener("message",this._onMessage),this._socket.removeEventListener("close",this._onSocketClose),this._socket.removeEventListener("open",this._onOpen),this._socket.removeEventListener("error",this._onError)):this._socket&&(this._socket.onmessage=null,this._socket.onclose=null,this._socket.onopen=null,this._socket.onerror=null),this._clearConnectionFailed()}},{key:"_scheduleReconnect",value:function(){var e=this;if(!this.isDestroyed&&this.client.isOnline&&this.client.isAuthenticated){var t=Math.min(this._lostConnectionCount+4,13),n=l.getExponentialBackoffSeconds(this.maxDelaySecondsBetweenReconnect,t);this.trigger("scheduling-reconnect",{counter:t,delay:n}),u.warn("Websocket Reconnect in "+n+" seconds"),this._reconnectId||(this._reconnectId=setTimeout(function(){e._reconnectId=0,e._validateSessionBeforeReconnect()},1e3*n))}}},{key:"_validateSessionBeforeReconnect",value:function(){var e=this;!this.isDestroyed&&this.client.isOnline&&this.client.isAuthenticated&&this.client.xhr({url:"/?action=validateConnectionForWebsocket&client="+this.client.constructor.version,method:"GET",sync:!1},function(t){t.success?(e.trigger("connecting",{from:"_validateSessionBeforeReconnect",why:"has valid session token"}),e.connect()):401===t.status||(e.trigger("schedule-reconnect",{from:"_validateSessionBeforeReconnect",why:"Unexpected error: "+t.status}),e._scheduleReconnect())})}}]),t}(c);f.prototype.isOpen=!1,f.prototype._reconnectId=0,f.prototype._connectionFailedId=0,f.prototype._lastTimestamp=0,f.prototype._lastDataFromServerTimestamp=0,f.prototype._lastCounter=null,f.prototype._hasCounter=!1,f.prototype._needsReplayFrom=null,f.prototype._replayRetryCount=0,f.prototype._lastGetCounterRequest=0,f.prototype._lastGetCounterId=0,f.prototype.pingFrequency=3e4,f.prototype.maxDelaySecondsBetweenReconnect=480,f.prototype.client=null,f.prototype._socket=null,f.prototype._closing=!1,f.prototype._lostConnectionCount=0,f.IGNORE_SKIPPED_COUNTER_INTERVAL=6e4,f._supportedEvents=["message","connected","disconnected","syncing","synced","connecting","disconnecting","replaying-events","scheduling-reconnect","schedule-reconnect","ignore-skipped-counter"].concat(c._supportedEvents),c.initClass.apply(f,[f,"SocketManager"]),e.exports=f},IpBb:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return s});var r=n("FyQ2"),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},s=function(){function e(t){i(this,e),this.trackingObj=o({},t)}return e.getInstance=function(){if(!e.trackingInstance){var t=new e(r.a.getDefaultObj());e.trackingInstance=t}return e.trackingInstance},e.prototype.track=function(e,t){var n=o({},this.trackingObj[e],t);"undefined"!=typeof ub&&ub.track(e,n)},e}();s.trackingInstance=null},"Kzi/":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("/CmL"),a=n("+SiN"),c=n("l27T"),l=window.interfaces,u=l.Virtual,h=l.VirtualDom,d=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n));return o.lightbox=null,o.lightboxModal=null,o.lightboxRef=o.lightboxRef.bind(o),o.closeLightbox=o.closeLightbox.bind(o),o.attachJobRef=null,o.setJobRefModal=o.setJobRefModal.bind(o),o.state={liveJobs:[]},o}return o(t,e),t.prototype.attachedCallback=function(){var e=this;this.getLiveJobs().then(function(t){e.initalizeDrawer(t)},function(t){e.initalizeDrawer([])})},t.prototype.componentWillUnmount=function(){this.lightboxModal.destroy()},t.prototype.setJobRefModal=function(e){this.attachJobRef=e},t.prototype.getLiveJobs=function(){return new Promise(function(e,t){c.a().then(function(t){var n=Object(a.i)(t.data);e(n)},function(e){t(e)})})},t.prototype.closeLightbox=function(){this.props.dispatch({type:"TOGGLE_ATTACH_LIGHTBOX",payload:!1}),this.lightboxModal.close()},t.prototype.componentWillReceiveProps=function(e){!this.props.chats.openAttachLightBox&&e.chats.openAttachLightBox&&this.lightboxModal.open()},t.prototype.lightboxRef=function(e){this.lightbox=e&&e.firstChild},t.prototype.initalizeDrawer=function(e){var t=this;requirejs(["pathStatic0_0/j/model_v5/modelWindow.amd"],function(n){var i=n.lightBox,r={trigger:$("<div>"),model:$(t.lightbox),dir:"right",routing:!1,fixed:!0,open:{event:"",anim:"",success:function(){}},dimens:{width:"751px",height:"452px"},close:{esc:!0,layer:!1,anim:"",success:function(){t.closeLightbox()}}};t.lightboxModal=i(r),h.render(u.createElement(p,{liveJobs:e,selectJob:t.props.selectJob,closeLightbox:t.closeLightbox}),t.attachJobRef)})},t.prototype.render=function(){return u.createElement("div",{ref:this.lightboxRef},u.createElement("div",{className:"attach-job-lightbox lightbox",ref:this.setJobRefModal,style:{background:"white",zIndex:99999}}))},t}(u.Component);t.a=d;var p=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n));return o.state={liveJobs:n.liveJobs,isSearchClicked:!1},o}return o(t,e),t.prototype.componentDidMount=function(){},t.prototype.filterLiveJobs=function(e){var t=e.target.value,n=this.props.liveJobs.filter(function(e){return-1!==e.title.indexOf(t)||-1!==e.postedBy.indexOf(t)||-1!==e.postedOn.indexOf(t)});this.setState({liveJobs:n})},t.prototype.reInitialiseCustomScroll=function(){$(".job-rows").removeClass("nScrollable"),$(".job-rows").addClass("nScroll")},t.prototype.setSearchModel=function(e){var t=this;this.searchBar=e,$(this.searchBar).on("focusout",function(){t.setState({isSearchClicked:!1})})},t.prototype.selectJob=function(e){this.props.selectJob(e),this.closeModal()},t.prototype.closeModal=function(){this.searchBar.value=null,this.setState({liveJobs:this.props.liveJobs}),this.props.closeLightbox()},t.prototype.showSearchBar=function(){var e=this;this.setState({isSearchClicked:!0},function(){e.searchBar.focus()})},t.prototype.render=function(){var e=this,t=this.state.liveJobs.slice(0),n=t.slice().map(function(t){return u.createElement("tr",{className:"row",onClick:function(){return e.selectJob(t)}},u.createElement("td",{className:"col s4 m4 l4 xl4 chat-align-center ellipses",title:t.title},u.createElement("div",{className:"row job-description"},u.createElement("div",{className:"col s12 m12 l12"},u.createElement("p",{title:t.title,className:"ellipses job-title"},t.title))),u.createElement("div",{className:"row"},u.createElement("div",{className:"col s12 m12 l12"},u.createElement("p",{className:"ellipses"},t.minExp+"-"+t.maxExp+" yrs-"+t.loc)))),u.createElement("td",{className:"col s3 m3 l3 xl3 chat-align-center ellipses",title:t.postedOn},t.postedOn),u.createElement("td",{className:"col s3 m3 l3 xl3 chat-align-center ellipses",title:t.postedBy},t.postedBy),u.createElement("td",{className:"col s2 m2 l2 xl2 chat-align-center ellipses"},u.createElement("span",null)))});return u.createElement("div",null,u.createElement("div",{className:"attach-job-lightbox-wrapper"},u.createElement("div",{class:"attach-job-text"},u.createElement("p",null,s.a.ATTACH_JOB_TITLE)),u.createElement("div",{class:"attach-job-close"},u.createElement("span",{onClick:function(){e.closeModal()}},u.createElement("i",{className:"fontIcon wf-chat-cross"})))),u.createElement("div",{className:"job-lists materialize"},u.createElement("table",{className:"centered"},u.createElement("tbody",null,u.createElement("div",{className:"job-lists-head"},u.createElement("tr",{className:"row"},u.createElement("td",{className:"col s4 m4 l4 xl4"},s.a.POSTED_JOBS_LABEL),u.createElement("td",{className:"col s3 m3 l3 xl3"},s.a.POSTED_ON_LABEL),u.createElement("td",{className:"col s3 m3 l3 xl3"},s.a.POSTED_BY_LABEL),u.createElement("td",{className:"col s2 m2 l2 xl2"},u.createElement("div",{style:{width:this.state.isSearchClicked?"100%":"30%"}},u.createElement("input",{id:"search-job-input",ref:function(t){e.setSearchModel(t)},type:"text",placeholder:"Search Jobs",style:{display:this.state.isSearchClicked?"block":"none"},onChange:function(t){e.filterLiveJobs(t)}}),u.createElement("i",{style:{display:this.state.isSearchClicked?"none":"block"},className:"fontIcon wf-chat-search",onClick:function(){return e.showSearchBar()}}))))),u.createElement("div",{className:"job-rows"},n)))))},t}(u.Component)},"LM/i":function(e,t,n){!function(){function t(e){return this.camelCase=e.camelCase,this.propertyNameMap=e.propertyNameMap,this.changeCallbacks=e.changeCallbacks,this.abortCallbacks=e.abortCallbacks,this.getObjectCallback=e.getObjectCallback,this.createObjectCallback=e.createObjectCallback,this.doesObjectMatchIdCallback=e.doesObjectMatchIdCallback||function(e,t){return t.id==e},this.returnIds=e.returnIds,this}function n(e,t,n){this.changeCallbacks&&n&&this.changeCallbacks[n]&&Object.keys(e).forEach(function(i){this.changeCallbacks[n].all?this.changeCallbacks[n].all(t,t[i],e[i].before,e[i].paths):this.changeCallbacks[n][i]&&this.changeCallbacks[n][i](t,t[i],e[i].before,e[i].paths)},this)}function i(e,t,n,i){var r=t.object,o=String.fromCharCode(145);e=e.replace(/\\\./g,o),e=e.replace(/\\(.)/g,"$1");var a=e.split(/\./),c=new RegExp(o,"g");if(a=a.map(function(e){return e.replace(c,".")}),this.camelCase&&(a[0]=a[0].replace(/[-_]./g,function(e){return e[1].toUpperCase()})),this.propertyNameMap){var l=this.propertyNameMap[t.type];a[0]=l&&l[a[0]]||a[0]}s.apply(this,[{baseName:a[0],fullPath:e,object:t.object,options:t,changes:n,operation:i}]);for(var u=r,h=0;h<a.length-1;h++){var d=a[h];if(d in u){if(null===(u=u[d])||"object"!=typeof u)throw new Error("Can not access property '"+e+"'")}else u[d]={},u=u[d]}return{pointer:u,lastName:a[a.length-1],baseName:a[0],fullPath:e,abortHandler:this.abortCallbacks&&this.abortCallbacks[t.type]&&(this.abortCallbacks[t.type].all||this.abortCallbacks[t.type][a[0]])}}function r(e,t){if(e.id){if(!this.getObjectCallback)throw new Error("Must provide getObjectCallback in constructor to use ids");var n=this.getObjectCallback(e.id);return!n&&e.value&&(n=this.createObjectCallback?this.createObjectCallback(e.id,e.value):e.value),n||(this.returnIds?e.id:null)}return e.value}function o(e){if(Array.isArray(e))return e.map(function(e){return o(e)});if(e instanceof Set){var t=new Set;return e.forEach(function(e){t.add(e)}),t}if(e instanceof Date)return new Date(e);if(e&&"object"==typeof e){var n=Object.keys(e).filter(function(e){return 0!==e.indexOf("_")}),t={};return n.forEach(function(n){t[n]=o(e[n])}),t}return e}function s(e){if(!e.changes[e.baseName]){var t=e.object[e.baseName];("set"===e.operation||"delete"===e.operation)&&"id"in e.operation&&t&&(t=t.id),(e.changes[e.baseName]={paths:[]}).before=t&&"object"==typeof t?o(t):t}var n=e.changes[e.baseName].paths;-1===n.indexOf(e.fullPath)&&n.push(e.fullPath)}function a(e,t,n,i,r){e.abortHandler&&e.abortHandler(e.fullPath,"set",t)||(e.pointer[e.lastName]=t)}function c(e,t,n,i,r){e.abortHandler&&e.abortHandler(e.fullPath,"delete",t)||delete e.pointer[e.lastName]}function l(e,t,n,i,r){if(!e.abortHandler||!e.abortHandler(e.fullPath,"add",t)){var o;if(o=e.lastName in e.pointer?e.pointer[e.lastName]:e.pointer[e.lastName]=[],!(Array.isArray(o)||o instanceof Set))throw new Error("The add operation requires an array or new structure to add to.");if(Array.isArray(t))throw new Error("The add operation will not add arrays to sets.");if(n.id){for(var s=0;s<o.length;s++)if(this.doesObjectMatchIdCallback(n.id,o[s]))return;o instanceof Set?o.add(t):o.push(t)}else{if(t&&"object"==typeof t)throw new Error("The add operation will not add objects to sets.");-1===o.indexOf(t)&&o.push(t)}}}function u(e,t,n,i,r){if(!e.abortHandler||!e.abortHandler(e.fullPath,"remove",t)){var o;if(o=e.lastName in e.pointer?e.pointer[e.lastName]:e.pointer[e.lastName]=[],!(Array.isArray(o)||o instanceof Set))throw new Error("The remove operation requires an array or new structure to remove from.");if(n.id){if(o instanceof Set)o.delete(t);else for(var s=0;s<o.length;s++)if(this.doesObjectMatchIdCallback(n.id,o[s])){o.splice(s,1);break}}else{if(Array.isArray(t))throw new Error("The remove operation will not remove arrays from sets.");if(t&&"object"==typeof t)throw new Error("The remove operation will not remove objects from sets.");if(o instanceof Set)o.remove(t);else{var a=o.indexOf(t);-1!==a&&o.splice(a,1)}}}}var h={set:a,delete:c,add:l,remove:u};e.exports=t,t.prototype.parse=function(e){var t={};e.operations.forEach(function(n){var o=i.apply(this,[n.property,e,t,n]);h[n.operation].call(this,o,r.apply(this,[n,e]),n,e,t)},this),n.apply(this,[t,e.object,e.type])}}()},M3Kp:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n("sDhs"),c=n("zTev"),l=n("zi+W"),u=n("pLky"),h=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),s(t,[{key:"send",value:function(){}},{key:"_send",value:function(){}},{key:"getConversation",value:function(){}},{key:"_loaded",value:function(e){this.getClient()._addMessage(this)}},{key:"delete",value:function(){if(this.isDestroyed)throw new Error(u.dictionary.isDestroyed);var e=this.id,t=this.getClient();this._xhr({url:"",method:"DELETE"},function(n){n.success||n.data&&("not_found"===n.data.id||"authentication_required"===n.data.id)||c.load(e,t)}),this._deleted(),this.destroy()}}],[{key:"_createFromServer",value:function(e,n){var i=e.fromWebsocket;return new t({fromServer:e,clientId:n.appId,_notify:i&&e.is_unread})}}]),t}(a);h.prefixUUID="layer:///announcements/",h.bubbleEventParent="getClient",h._supportedEvents=[].concat(a._supportedEvents),h.inObjectIgnore=a.inObjectIgnore,l.initClass.apply(h,[h,"Announcement"]),c.subclasses.push(h),e.exports=h},MRbt:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("/CmL"),a=window.interfaces.Virtual,c=function(e){function t(){return i(this,t),r(this,e.call(this))}return o(t,e),t.prototype.componentDidMount=function(){var e=$("#"+this.props.file_uploader_id);$("#fileLabel").unbind("click").bind("click",function(){e.click()})},t.prototype.render=function(){var e=this;return a.createElement("div",{className:"_file_uploader"},a.createElement("label",{id:"fileLabel",for:this.props.file_uploader_id,onClick:function(){return e.props.hideAttachmentError()}},a.createElement("i",{class:"fontIcon wf-chat-attach-doc"}),a.createElement("p",null,s.a.ATTACH_DOC_LABEL)))},t}(a.PureComponent);t.a=c},MfyV:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n("Z1pN"),o=n("p150"),s=n("sgBt"),a=n("0M3w"),c=n("25fZ"),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},u=function e(){i(this,e),this._params={mode:"recruiter"},this.client=null,this.messages=[],this._params=l({},this._params,window._edgeChatConfig),this.client=c.a.getClient(),this.client.removeChatWindows(),r.a.dispatch(Object(s.loadChat)(this._params)),this.client.subscribe("onConversation",function(e,t){e.forEach(function(e){r.a.dispatch(Object(o.markConversation)(e))})}),this.client.subscribe("onMessage",function(e,t){r.a.dispatch(Object(a.onNewMessage)(e,t))}),this.client.subscribe("onChatnewmessage",function(e){var t=e.event,n=t.conversationId;t.messageId,e.conversations.forEach(function(e){r.a.dispatch(Object(o.markConversation)(e))}),r.a.dispatch(Object(a.onNewMessage)(n,e.messages))}),this.client.subscribe("onChatconversationread",function(e){var t=e.conversations,n=e.messages,i=e.event,s=i.conversationId;i.messageId,r.a.dispatch(Object(a.messagesLoaded)(n,s)),r.a.dispatch(Object(o.conversationLoaded)(t))}),this.client.subscribe("onChatconversationdelivered",function(e){var t=e.conversations,n=e.messages,i=e.event,s=i.conversationId;i.messageId,r.a.dispatch(Object(a.messagesLoaded)(n,s)),r.a.dispatch(Object(o.conversationLoaded)(t))}),this.client.subscribe("onChatmessagedelivered",function(e){})};t.a=u},NMAg:function(e,t,n){"use strict"},NOS6:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n("+uDm"),s=o.STARTED,a=o.PAUSED,c=o.FINISHED,l=n("Z/oI"),u=function(){function e(t){i(this,e),this.clientId=t.clientId,t.conversation&&(this.conversation=this._getClient().getObject(t.conversation.id)),this.state=c,this._lastMessageTime=0}return r(e,[{key:"setConversation",value:function(e){this.setState(c),this.conversation=e?this._getClient().getObject(e.id):null,this.state=c}},{key:"setState",value:function(e){if(this._pauseLoopId&&(clearInterval(this._pauseLoopId),this._pauseLoopId=0),this.conversation){if(this.state!==e)this.state=e,this._send(e);else{if(e===c)return;Date.now()>this._lastMessageTime+2500?this._send(e):this._scheduleNextMessage(e)}this.state!==c&&this._startPauseLoop()}}},{key:"_startPauseLoop",value:function(){var e=this;this._pauseLoopId||(this._pauseLoopId=window.setInterval(function(){e.state===a?e.setState(c):e.state===s&&e.setState(a)},2500))}},{key:"_scheduleNextMessage",value:function(e){var t=this;this._scheduleId&&clearTimeout(this._scheduleId);var n=2500-Math.min(Date.now()-this._lastMessageTime,2500);this._scheduleId=setTimeout(function(){t._scheduleId=0,t.state===e&&t._send(e)},n)}},{key:"_send",value:function(e){this.conversation.isSaved()&&(this._lastMessageTime=Date.now(),this._getClient().socketManager.sendSignal({type:"typing_indicator",object:{id:this.conversation.id},data:{action:e}}))}},{key:"_getClient",value:function(){return l.get(this.clientId)}},{key:"destroy",value:function(){delete this.conversation,this.isDestroyed=!0,clearTimeout(this._scheduleId),clearInterval(this._pauseLoopId)}}]),e}();e.exports=u},NoJc:function(e,t,n){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n("zi+W"),l=n("kesd"),u=l.SYNC_STATE,h=n("4wNg"),d=n("B+kz"),p=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),a(t,[{key:"_fetchData",value:function(e){var t=this;this.client.dbManager.loadChannels(this._nextDBFromId,e,function(e){e.length&&t._appendResults({data:e},!0)});var n="channels?page_size="+e+(this._nextServerFromId?"&from_id="+this._nextServerFromId:"");n!==this._firingRequest&&(this.isFiring=!0,this._firingRequest=n,this.client.xhr({telemetry:{name:"channel_query_time"},url:this._firingRequest,method:"GET",sync:!1},function(n){return t._processRunResults(n,t._firingRequest,e)}))}},{key:"_getSortField",value:function(){return"created_at"}},{key:"_getItem",value:function(e){return h.prototype._getItem.apply(this,[e])}},{key:"_handleEvents",value:function(e,t){switch(e){case"channels:change":this._handleChangeEvent("channels",t);break;case"channels:add":this._handleAddEvent("channels",t);break;case"channels:remove":this._handleRemoveEvent("channels",t)}}},{key:"_appendResultsSplice",value:function(e){this.data.unshift(this._getData(e))}},{key:"_handleChangeEvent",value:function(e,t){var n=this._getIndex(t.target.id);if(this.dataType===h.ObjectDataType){var r=t.getChangesFor("id");r.length&&(n=this._getIndex(r[0].oldValue))}if(-1!==n){var o=this._getSortField(),s=t.hasProperty("lastMessage")&&"last_message"===o,a=void 0;this.dataType===h.ObjectDataType?s?(a=this._getInsertIndex(t.target,this.data),this.data.splice(n,1),this.data.splice(a,0,this._getData(t.target)),this.data=this.data.concat([])):this.data=[].concat(i(this.data.slice(0,n)),[t.target.toObject()],i(this.data.slice(n+1))):s&&(a=this._getInsertIndex(t.target,this.data))!==n&&(this.data.splice(n,1),this.data.splice(a,0,t.target)),this._triggerChange({type:"property",target:this._getData(t.target),query:this,isChange:!0,changes:t.changes}),s&&a!==n&&this._triggerChange({type:"move",target:this._getData(t.target),query:this,isChange:!1,fromIndex:n,toIndex:a})}}},{key:"_getInsertIndex",value:function(e,t){if(!e.isSaved())return 0;var n=this._getSortField(),i=void 0;if("created_at"===n){for(i=0;i<t.length;i++){var r=t[i];if(r.syncState===u.NEW||r.syncState===u.SAVING);else if(e.createdAt>=r.createdAt)break}return i}var o=-1,s=e.lastMessage?e.lastMessage.sentAt:e.createdAt;for(i=0;i<t.length;i++){var a=t[i];if(a.id===e.id)o=i;else if(a.syncState===u.NEW||a.syncState===u.SAVING);else{var c=a.lastMessage?a.lastMessage.sentAt:a.createdAt;if(s>=c)break}}return-1===o||o>i?i:i-1}},{key:"_handleAddEvent",value:function(e,t){var n=this,i=t[e].filter(function(e){return-1===n._getIndex(e.id)});if(i.length){var r=this.data;i.forEach(function(e){var t=n._getInsertIndex(e,r);r.splice(t,0,n._getData(e)),n.dataType===h.ObjectDataType&&(n.data=[].concat(r)),n.totalSize+=1;var i=n._getData(e);n._triggerChange({type:"insert",index:t,target:i,query:n})})}}},{key:"_handleRemoveEvent",value:function(e,t){var n=this,r=[];t[e].forEach(function(e){var t=n._getIndex(e.id);-1!==t&&(e.id===n._nextDBFromId&&(n._nextDBFromId=n._updateNextFromId(t)),e.id===n._nextServerFromId&&(n._nextServerFromId=n._updateNextFromId(t)),r.push({data:e,index:t}),n.dataType===h.ObjectDataType?n.data=[].concat(i(n.data.slice(0,t)),i(n.data.slice(t+1))):n.data.splice(t,1))}),this.totalSize-=r.length,r.forEach(function(e){n._triggerChange({type:"remove",index:e.index,target:n._getData(e.data),query:n})})}}]),t}(d);p._supportedEvents=[].concat(d._supportedEvents),p.MaxPageSize=100,p.prototype.model=h.Channel,c.initClass.apply(p,[p,"ChannelsQuery"]),e.exports=p},"P+Qc":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n("kesd").LOG,a=s.DEBUG,c=s.INFO,l=s.WARN,u=s.ERROR,h=s.NONE,d=(Boolean(console.assert&&"".match(/assert/)),function(){function e(){i(this,e)}return o(e,[{key:"log",value:function(e,t,n,i){"object"===(void 0===e?"undefined":r(e))&&(e=""),(new Date).toLocaleTimeString()}},{key:"debug",value:function(e,t){this.level>=a&&this.log(e,t,a,"#888")}},{key:"info",value:function(e,t){this.level>=c&&this.log(e,t,c,"black")}},{key:"warn",value:function(e,t){this.level>=l&&this.log(e,t,l,"orange")}},{key:"error",value:function(e,t){this.level>=u&&this.log(e,t,u,"red")}}]),e}());d.prototype.level="undefined"==typeof jasmine?u:h;var p=new d;e.exports=p},PT5i:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n("zi+W"),c=n("ozQU"),l=n("Z/oI"),u=n("pLky"),h=n("kesd"),d=n("P+Qc"),p=function(e){function t(e){i(this,t),e.channel&&(e.conversationId=e.channel.id);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),o=n.getClient();return n.isInitializing=!1,e&&e.fromServer&&o._addMessage(n),n}return o(t,e),s(t,[{key:"getConversation",value:function(e){return this.conversationId?l.get(this.clientId).getChannel(this.conversationId,e):null}},{key:"sendReceipt",value:function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:h.RECEIPT_STATE.READ,d.warn("Receipts not supported for Channel Messages yet"),this}},{key:"delete",value:function(){if(this.isDestroyed)throw new Error(u.dictionary.isDestroyed);var e=this.id,t=this.getClient();this._xhr({url:"",method:"DELETE"},function(n){n.success||n.data&&("not_found"===n.data.id||"authentication_required"===n.data.id)||c.load(e,t)}),this._deleted(),this.destroy()}},{key:"_loaded",value:function(e){this.conversationId=e.channel.id,this.getClient()._addMessage(this)}}],[{key:"_createFromServer",value:function(e,n){var i=e.fromWebsocket,r=void 0;return r=e.channel?e.channel.id:e.conversationId,new t({conversationId:r,fromServer:e,clientId:n.appId,_fromDB:e._fromDB,_notify:i&&e.is_unread&&e.sender.user_id!==n.user.userId})}}]),t}(c);p.prototype.isRead=!1,p.inObjectIgnore=c.inObjectIgnore,p._supportedEvents=[].concat(c._supportedEvents),a.initClass.apply(p,[p,"ChannelMessage"]),e.exports=p},PydB:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("xrGV"),a=n.n(s),c=n("IpBb"),l=window.interfaces,u=l.Virtual,h=(l.VirtualDom,function(e){function t(n){i(this,t);var o=r(this,e.call(this,n));return o.uba=c.a.getInstance(),o}return o(t,e),t.prototype.render=function(){var e=this;return this.props.userEmail,u.createElement("div",{className:"cht-feedback"},u.createElement("div",{className:"cht-feedback-icon"},u.createElement("img",{src:a.a})),u.createElement("div",{className:"cht-feedback-main"},u.createElement("div",{className:"cht-feedback-msg"},u.createElement("p",{className:"cht-feedback-msg1"},"Your feedback is important to us"),u.createElement("p",{className:"cht-feedback-msg2"},"Tell us about how we can improve the messaging experience for you.")),u.createElement("div",{className:"cht-feedback-actions"},u.createElement("span",{className:"cht-feedback-share",onClick:function(){e.uba.track("chatButtonClick",{fromId:e.props.owner&&JSON.parse(e.props.owner.META_DATA).rpId||"",buttonSource:"chatList",status:"shareFeedback",conversationsCount:e.props.convCount})}},u.createElement("a",{href:"https://forms.gle/AWf69fV1mPDPJ1hf6",target:"_blank"},"SHARE FEEDBACK")),u.createElement("span",{className:"cht-feedback-dismiss",onClick:function(){e.uba.track("chatButtonClick",{fromId:e.props.owner&&JSON.parse(e.props.owner.META_DATA).rpId||"",buttonSource:"chatList",status:"dismissFeedback",conversationsCount:e.props.convCount}),e.props.dismissFeedback()}},"Dismiss"))))},t}(u.PureComponent));t.a=h},QDPI:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("0M3w"),a=n("ivJ1"),c=n("sQD6"),l=n("BoTL"),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},h=window.interfaces.connect,d=window.interfaces.Virtual,p=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n));return o.dispatchAttachLb=o.dispatchAttachLb.bind(o),o._selectJobs=o._selectJobs.bind(o),o}return o(t,e),t.prototype.dispatchAttachLb=function(e){this.props.dispatch(Object(s.toggleAttachLightbox)(e))},t.prototype._selectJobs=function(e){this.props.dispatch(Object(s.selectLiveJob)(e))},t.prototype.render=function(e){var t=this,n=e.main,i=e.chats.isChatPrefilled;return d.createElement("div",{className:"_chats chat-window"},n.chatWindows&&n.chatWindows.map(function(e,r){return d.createElement(l.a,u({},t.props,{index:r,key:e.conversationId,conversation:e,user:n.user,mode:n.params.mode,isChatPrefilled:i,dispatchAttachLb:t.dispatchAttachLb,selectJob:t._selectJobs}))}))},t}(d.PureComponent);t.a=h(a.a,Object(c.b)(s))(p)},QX7m:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=window.interfaces,a=s.Virtual,c=(s.VirtualDom,function(e){function t(){return i(this,t),r(this,e.apply(this,arguments))}return o(t,e),t.prototype.render=function(){return a.createElement("div",{className:"_conversation_loader"},a.createElement("box",{className:"_shine"}),a.createElement("div",null,a.createElement("lines",{className:"_shine"}),a.createElement("lines",{className:"_shine"}),a.createElement("lines",{className:"_shine"})),a.createElement("br",null),a.createElement("box",{className:"_shine"}),a.createElement("div",null,a.createElement("lines",{className:"_shine"}),a.createElement("lines",{className:"_shine"}),a.createElement("lines",{className:"_shine"})),a.createElement("br",null),a.createElement("box",{className:"_shine"}),a.createElement("div",null,a.createElement("lines",{className:"_shine"}),a.createElement("lines",{className:"_shine"}),a.createElement("lines",{className:"_shine"})),a.createElement("br",null),a.createElement("box",{className:"_shine"}),a.createElement("div",null,a.createElement("lines",{className:"_shine"}),a.createElement("lines",{className:"_shine"}),a.createElement("lines",{className:"_shine"})),a.createElement("br",null),a.createElement("box",{className:"_shine"}),a.createElement("div",null,a.createElement("lines",{className:"_shine"}),a.createElement("lines",{className:"_shine"}),a.createElement("lines",{className:"_shine"})),a.createElement("br",null),a.createElement("box",{className:"_shine"}),a.createElement("div",null,a.createElement("lines",{className:"_shine"}),a.createElement("lines",{className:"_shine"}),a.createElement("lines",{className:"_shine"})))},t}(a.PureComponent));t.a=c},"S/PF":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n("zi+W"),c=n("EvUg"),l=function(e){function t(e){return i(this,t),"string"==typeof e&&(e={id:e}),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),s(t,[{key:"loadContent",value:function(e,t){c({url:this.downloadUrl,responseType:"arraybuffer"},function(n){if(n.success)if("undefined"!=typeof Blob){var i=new Blob([n.data],{type:e});t(null,i)}else t(null,n.data);else t(n.data,null)})}},{key:"refreshContent",value:function(e,t){var n=this;e.xhr({url:this.refreshUrl,method:"GET",sync:!1},function(e){var i=e.data;n.expiration=new Date(i.expiration),n.downloadUrl=i.download_url,t&&t(n.downloadUrl)})}},{key:"isExpired",value:function(){return this.expiration.getTime()-6e5<Date.now()}}],[{key:"_createFromServer",value:function(e){return new t({id:e.id,downloadUrl:e.download_url,expiration:new Date(e.expiration),refreshUrl:e.refresh_url})}}]),t}(a);l.prototype.id="",l.prototype.blob=null,l.prototype.downloadUrl="",l.prototype.refreshUrl="",l.prototype.size=0,l.prototype.expiration=null,a.initClass.apply(l,[l,"Content"]),e.exports=l},SyvT:function(e,t){e.exports="//static.naukimg.com/s/5/102/i/no-conversation.png"},TGOB:function(e,t,n){"use strict";var i=n("VdYS"),r=n("pLky").dictionary;e.exports={events:["channels:add","channels:remove","channels:change","channels:loaded","channels:delete","channels:sent","channels:sent-error"],lifecycle:{constructor:function(e){this._models.channels={}},cleanup:function(){var e=this;Object.keys(this._models.channels).forEach(function(t){var n=e._models.channels[t];n&&!n.isDestroyed&&n.destroy()}),this._models.channels=null},reset:function(){this._models.channels={}}},methods:{getChannel:function(e,t){if("string"!=typeof e)throw new Error(r.idParamRequired);return i.isValidId(e)||(e=i.prefixUUID+e),this._models.channels[e]?this._models.channels[e]:t?i.load(e,this):null},_addChannel:function(e){var t=e.id;this._models.channels[t]||(this._models.channels[t]=e,e.clientId!==this.appId&&(e.clientId=this.appId),this._triggerAsync("channels:add",{channels:[e]}),this._scheduleCheckAndPurgeCache(e))},_removeChannel:function(e){var t=this;e.off(null,null,this),this._models.channels[e.id]&&(delete this._models.channels[e.id],this._triggerAsync("channels:remove",{channels:[e]})),Object.keys(this._models.messages).forEach(function(n){t._models.messages[n].channelId===e.id&&t._models.messages[n].destroy()})},_updateChannelId:function(e,t){var n=this;this._models.channels[t]&&(this._models.channels[e.id]=e,delete this._models.channels[t],Object.keys(this._models.messages).filter(function(e){return n._models.messages[e].conversationId===t}).forEach(function(t){return n._models.messages[t].conversationId=e.id}))},findCachedChannel:function(e,t){for(var n=t?e.bind(t):e,i=Object.keys(this._models.channels),r=i.length,o=0;o<r;o++){var s=i[o],a=this._models.channels[s];if(n(a,o))return a}return null},createChannel:function(e){if(!this.isAuthenticated)throw new Error(r.clientMustBeReady);return"private"in e||(e.private=!1),e.client=this,i.create(e)}}}},Tqr5:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n("zi+W"),c=n("pLky"),l=n("P+Qc"),u=n("4wNg"),h=new RegExp(/^channel.id\s*=\s*['"]((layer:\/\/\/channels\/)?.{8}-.{4}-.{4}-.{4}-.{12})['"]$/),d=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),s(t,[{key:"_fixPredicate",value:function(e){if(""===e)return"";if(-1!==e.indexOf("channel.id")){var t=e.match(h)?e.replace(h,"$1"):null;if(!t)throw new Error(c.dictionary.invalidPredicate);return 0!==t.indexOf("layer:///channels/")&&(t="layer:///channels/"+t),"channel.id = '"+t+"'"}throw new Error(c.dictionary.invalidPredicate)}},{key:"_getChannelPredicateIds",value:function(){if(this.predicate.match(h)){var e=this.predicate.replace(h,"$1"),t=(this._predicate||e).replace(/^layer:\/\/\/channels\//,"");if(t)return{uuid:t,id:e,type:u.Channel}}}},{key:"_fetchData",value:function(e){var t=this,n=this._getChannelPredicateIds();if(!n)return void(this.predicate&&!this.predicate.match(/['"]/)&&l.error("This query may need to quote its value"));var i="layer:///channels/"+n.uuid;this._predicate||(this._predicate=n.id);var r=this.client.getChannel(i),o="channels/"+n.uuid+"/members?page_size="+e+(this._nextServerFromId?"&from_id="+this._nextServerFromId:"");r&&!r.isSaved()||o===this._firingRequest||(this.isFiring=!0,this._firingRequest=o,this.client.xhr({telemetry:{name:"member_query_time"},url:o,method:"GET",sync:!1},function(n){return t._processRunResults(n,o,e)}))}},{key:"_appendResultsSplice",value:function(e){this.data.push(this._getData(e))}},{key:"_handleEvents",value:function(e,t){switch(e){case"members:change":this._handleChangeEvent("members",t);break;case"members:add":this._handleAddEvent("members",t);break;case"members:remove":this._handleRemoveEvent("members",t)}}}]),t}(u);d._supportedEvents=[].concat(u._supportedEvents),d.MaxPageSize=500,d.prototype.model=u.Membership,a.initClass.apply(d,[d,"MembersQuery"]),e.exports=d},"UD6+":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},c=n("zi+W"),l=n("jTMd"),u=l.WebsocketSyncEvent,h=n("EvUg"),d=n("P+Qc"),p=n("jPMo"),f=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.client=e.client,n.client&&n.client.on("ready",function(){n._processNextRequest(),n._loadPersistedQueue()},n),n.queue=[],n.receiptQueue=[],n.onlineManager.on("disconnected",n._onlineStateChange,n),n.socketManager.on("connected disconnected",n._onlineStateChange,n),n}return o(t,e),s(t,[{key:"isOnline",value:function(){return this.onlineManager.isOnline}},{key:"_onlineStateChange",value:function(e){var t=this;"connected"===e.eventName?(this.queue.length&&this.queue[0].returnToOnlineCount++,setTimeout(function(){return t._processNextRequest()},100)):"disconnected"===e.eventName&&(this.queue.length&&(this.queue[0].isFiring=!1),this.receiptQueue.length&&this.receiptQueue.forEach(function(e){return e.isFiring=!1}))}},{key:"request",value:function(e){"PATCH"===e.operation&&this._findUnfiredCreate(e)?d.info("Sync Manager Request PATCH "+e.target+" request ignored; create request still enqueued",e.toObject()):(d.info("Sync Manager Request "+e.operation+" on target "+e.target,e.toObject()),"RECEIPT"===e.operation?this.receiptQueue.push(e):this.queue.push(e),this.trigger("sync:add",{request:e,target:e.target})),"DELETE"===e.operation&&this._purgeOnDelete(e),this._processNextRequest(e)}},{key:"_processNextRequest",value:function(e){var t=this;this.queue.length&&!this.queue[0].isFiring&&(e?this.client.dbManager.writeSyncEvents([e],function(){return t._processNextStandardRequest()}):this._processNextStandardRequest()),this.receiptQueue.length&&this._processNextReceiptRequest()}},{key:"_findUnfiredCreate",value:function(e){return Boolean(this.queue.filter(function(t){return t.target===e.target&&"POST"===t.operation&&!t.isFiring}).length)}},{key:"_processNextStandardRequest",value:function(){var e=this;if(!this.isDestroyed&&this.client.isAuthenticated){var t=this.queue[0];this.isOnline()&&t&&!t.isFiring&&!t._isValidating&&(t._isValidating=!0,this._validateRequest(t,function(n){if(t._isValidating=!1,!n)return e._removeRequest(t,!1),e._processNextStandardRequest();e._fireRequest(t)}))}}},{key:"_processNextReceiptRequest",value:function(){var e=this,t=0;this.receiptQueue.forEach(function(n){e.isOnline()&&n&&(n.isFiring||n._isValidating?t++:t<4&&(t++,e._fireRequest(n)))})}},{key:"_fireRequest",value:function(e){e instanceof u?this._fireRequestWebsocket(e):this._fireRequestXHR(e)}},{key:"_fireRequestXHR",value:function(e){var t=this;e.isFiring=!0,e.headers||(e.headers={}),e.headers.authorization='Layer session-token="'+this.client.sessionToken+'"',d.info("Sync Manager XHR Request Firing "+e.operation+" "+e.target+" at "+(new Date).toISOString(),e.toObject()),h(e._getRequestData(this.client),function(n){return t._xhrResult(n,e)})}},{key:"_fireRequestWebsocket",value:function(e){var t=this;this.socketManager&&this.socketManager._isOpen()?(d.debug("Sync Manager Websocket Request Firing "+e.operation+" on target "+e.target,e.toObject()),e.isFiring=!0,this.requestManager.sendRequest({data:e._getRequestData(this.client),callback:function(n){return t._xhrResult(n,e)},isChangesArray:e.returnChangesArray})):d.debug("Sync Manager Websocket Request skipped; socket closed")}},{key:"_validateRequest",value:function(e,t){this.client.dbManager.claimSyncEvent(e,function(e){return t(e)})}},{key:"_handleDeduplicationErrors",value:function(e){e.data&&"id_in_use"===e.data.id&&e.data.data&&e.data.data.id===e.request._getCreateId()&&(e.success=!0,e.data=e.data.data)}},{key:"_xhrResult",value:function(e,t){this.isDestroyed||(e.request=t,t.isFiring=!1,this._handleDeduplicationErrors(e),e.success?this._xhrSuccess(e):this._xhrError(e))}},{key:"_getErrorState",value:function(e,n,i){var r=e.data?e.data.id:"";return i?"not_found"===r?"notFound":"id_in_use"===r?"invalidId":408===e.status||"request_timeout"===r?n.retryCount>=t.MAX_RETRIES?"tooManyFailuresWhileOnline":"validateOnlineAndRetry":-1!==[502,503,504].indexOf(e.status)?n.retryCount>=t.MAX_RETRIES?"tooManyFailuresWhileOnline":"serverUnavailable":"authentication_required"===r&&e.data.data&&e.data.data.nonce?"reauthorize":"serverRejectedRequest":n.returnToOnlineCount>=t.MAX_RETRIES_BEFORE_CORS_ERROR?"CORS":"offline"}},{key:"_xhrError",value:function(e){var t=e.request;d.warn("Sync Manager "+(t instanceof u?"Websocket":"XHR")+" "+t.operation+" Request on target "+t.target+" has Failed",t.toObject());var n=this._getErrorState(e,t,this.isOnline());switch(d.warn("Sync Manager Error State: "+n),n){case"tooManyFailuresWhileOnline":this._xhrHandleServerError(e,"Sync Manager Server Unavailable Too Long; removing request",!1);break;case"notFound":this._xhrHandleServerError(e,"Resource not found; presumably deleted",!1);break;case"invalidId":this._xhrHandleServerError(e,"ID was not unique; request failed",!1);break;case"validateOnlineAndRetry":case"serverUnavailable":this._xhrHandleServerUnavailableError(e);break;case"reauthorize":t.callback&&t.callback(e);break;case"serverRejectedRequest":this._xhrHandleServerError(e,"Sync Manager Server Rejects Request; removing request",!0);break;case"CORS":this._xhrHandleServerError(e,"Sync Manager Server detects CORS-like errors; removing request",!1);break;case"offline":this._xhrHandleConnectionError()}-1===this.queue.indexOf(t)&&-1===this.receiptQueue.indexOf(t)||this.client.dbManager.writeSyncEvents([t])}},{key:"_xhrHandleServerUnavailableError",value:function(e){var n=e.request;this.trigger("sync:error-will-retry",{target:n.target,request:n,error:e.data,retryCount:n.retryCount});var i=t.MAX_UNAVAILABLE_RETRY_WAIT,r=p.getExponentialBackoffSeconds(i,Math.min(15,n.retryCount++));d.warn("Sync Manager Server Unavailable; retry count "+n.retryCount+"; retrying in "+r+" seconds"),setTimeout(this._processNextRequest.bind(this),1e3*r)}},{key:"_xhrHandleServerError",value:function(e,t,n){e.request.callback&&e.request.callback(e),n?d.error(t+"\nREQUEST: "+JSON.stringify(e.request.toObject(),null,4)+"\nRESPONSE: "+JSON.stringify(e.data,null,4)):d.error(t,e),this.trigger("sync:error",{target:e.request.target,request:e.request,error:e.data}),e.request.success=!1,"POST"===e.request.operation&&this._purgeDependentRequests(e.request),this._removeRequest(e.request,!0),this._processNextRequest()}},{key:"_xhrHandleConnectionError",value:function(){}},{key:"_xhrValidateIsOnline",value:function(e){var t=this;d.debug("Sync Manager verifying online state"),this.onlineManager.checkOnlineStatus(function(n){return t._xhrValidateIsOnlineCallback(n,e)})}},{key:"_xhrValidateIsOnlineCallback",value:function(e,t){d.debug("Sync Manager online check result is "+e),e?(t.retryCount++,this._processNextRequest()):this._xhrHandleConnectionError()}},{key:"_xhrSuccess",value:function(e){var t=e.request;d.debug("Sync Manager "+(t instanceof u?"Websocket":"XHR")+" "+t.operation+" Request on target "+t.target+" has Succeeded",t.toObject()),e.data&&d.debug(e.data),t.success=!0,this._removeRequest(t,!0),t.callback&&t.callback(e),this._processNextRequest(),this.trigger("sync:success",{target:t.target,request:t,response:e.data})}},{key:"_removeRequest",value:function(e,t){var n="RECEIPT"===e.operation?this.receiptQueue:this.queue,i=n.indexOf(e);-1!==i&&n.splice(i,1),t&&this.client.dbManager.deleteObjects("syncQueue",[e])}},{key:"_purgeDependentRequests",value:function(e){this.queue=this.queue.filter(function(t){return-1===t.depends.indexOf(e.target)||t===e}),this.receiptQueue=this.receiptQueue.filter(function(t){return-1===t.depends.indexOf(e.target)||t===e})}},{key:"_purgeOnDelete",value:function(e){var t=this;this.queue.filter(function(t){return-1!==t.depends.indexOf(e.target)&&e!==t}).forEach(function(e){t.trigger("sync:abort",{target:e.target,request:e}),t._removeRequest(e,!0)})}},{key:"destroy",value:function(){this.queue.forEach(function(e){return e.destroy()}),this.queue=null,this.receiptQueue.forEach(function(e){return e.destroy()}),this.receiptQueue=null,a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_loadPersistedQueue",value:function(){var e=this;this.client.dbManager.loadSyncQueue(function(t){t.length&&(e.queue=e.queue.concat(t),e._processNextRequest())})}}]),t}(c);f.prototype.socketManager=null,f.prototype.requestManager=null,f.prototype.onlineManager=null,f.prototype.queue=null,f.prototype.receiptQueue=null,f.prototype.client=null,f.MAX_UNAVAILABLE_RETRY_WAIT=60,f.MAX_RETRIES_BEFORE_CORS_ERROR=3,f.MAX_RETRIES=20,f._supportedEvents=["sync:error","sync:error-will-retry","sync:success","sync:add","sync:abort"].concat(c._supportedEvents),c.initClass(f),e.exports=f},UG01:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=window.interfaces.Virtual,a=function(e){function t(){return i(this,t),r(this,e.apply(this,arguments))}return o(t,e),t.prototype.render=function(){var e=this.props.user,t=e.AVATAR_URL||"https://static.naukimg.com/s/4/112/i/noImg.png";return s.createElement("div",{className:"_avatar"},s.createElement("div",{className:"_inner"},s.createElement("span",{className:"_img",style:{backgroundImage:"url("+t+")"}})))},t}(s.PureComponent);t.a=a},VLJS:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("UG01"),a=n("muYO"),c=n("ZRT1"),l=n("+SiN"),u=n("25fZ"),h=n("/CmL"),d=n("IpBb"),p=n("0M3w"),f=window.interfaces.Virtual,y=function(e){function t(n){i(this,t);var o=r(this,e.call(this,n));o.blockUserHandler=function(){o.props.blocked?(o.setState({showLightbox:!1}),o.trackBlocking("unblock"),o.props.unBlockUser()):o.setState({showLightbox:!0})},o._blockUser=function(){o.props.blockUser(),o.trackBlocking("block"),o.setState({showLightbox:!1})},o.closeLightBox=function(){o.setState({showLightbox:!1})},o.state={showLightbox:!1,lastSeenAt:""},o.uba=d.a.getInstance();var s=o.props.user.META_DATA&&JSON.parse(o.props.user.META_DATA).cvId||null;return o._getLastSeenProm(s).then(function(e){if(e.LAST_ONLINE){var t=new Date(1e3*parseInt(e.LAST_ONLINE));o.setState({lastSeenAt:t||""})}},function(e){403===e.status&&(window.location.href="//resdex.naukri.com/v2/ResetLogin/displayResetLogin?requrl="+window.location.href)}),o}return o(t,e),t.prototype._getMeta=function(e){if(e&&e.META_DATA)return JSON.parse(e.META_DATA)},t.prototype._toggleTemplate=function(){this.props.dispatch(Object(p.toggleTemplate)())},t.prototype._setContent=function(e){this.props.dispatch(Object(p.setExternalContent)(e.currentTarget.innerHTML))},t.prototype.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t.prototype._getLastSeenProm=function(e){return u.a.getLastActiveTime(e)},t.prototype.trackBlocking=function(e){var t=this.props,n=t.conversation,i=t.user,r=t.recruiter,o=i&&i.META_DATA&&JSON.parse(i.META_DATA)||{},s=r&&r.META_DATA&&JSON.parse(r.META_DATA)||{};this.uba.track("chatBlocked",{blockedBy:s.IDENTITY_ID,fromId:s.rpId||"",fromCompany:s.employerName||s.cvId,toId:o.cvId||"",toCompany:o.employerName||o.cvId,chatId:n.conversationId,status:e})},t.prototype.render=function(){var e=this.props,t=e.user,n=e.closeChat,i=e.recruiter,r=this._getMeta(i),o=r.designation,u=r.employerName,d=t.META_DATA&&JSON.parse(t.META_DATA).cvId||null,p=this.state.lastSeenAt,y=void 0;if(p){var g=new Date(p),v=l.c(g);switch(y=h.a.LAST_SEEN_LABEL,v){case"today":"now"===l.g(g)?y=h.a.ACTIVE_NOW_LABEL:y+=l.g(g)+" "+h.a.AGO_LABEL;break;case"yesterday":y+=h.a.YESTERDAY_LABEL;break;case"before":y+=h.a.ON_LABEL+l.f(g);break;default:y+=h.a.AT_LABEL+l.d(g)}}return f.createElement("div",{className:"_header"},f.createElement("div",{className:"_user"},f.createElement(s.a,{user:t||{}})),t&&f.createElement("p",{className:"_name _ellipses"},t&&d?f.createElement("a",{style:{color:"white"},target:"_blank",href:"//resdex.naukri.com/v2/preview/preview?uniqId="+d+"&hfFlowName=chat"},Object(l.h)(t.NAME||"Candidate")):Object(l.h)(t.NAME||"Candidate")),y&&f.createElement("p",{className:"_last_seen _ellipses"},f.createElement("span",{className:"dot "+(y==h.a.ACTIVE_NOW_LABEL?"green":"grey")}),y),f.createElement("div",{className:"_action"},f.createElement(a.a,{icon:"icon-template",panelCls:"_template_panel",iconCls:"wf-chat-predefined-template"},f.createElement("ul",{className:"_template"},f.createElement("li",{onClick:this._setContent.bind(this)},"Hi ",t&&Object(l.h)(t.NAME)||"Candidate",",",f.createElement("br",null)," I am ",o||"Recruiter"," ",u&&" at "+u,". I am working on a job opportunity for which your profile seems a perfect match. If interested, do ping back."),f.createElement("li",{onClick:this._setContent.bind(this)},"Hi ",t&&Object(l.h)(t.NAME)||"Candidate",",",f.createElement("br",null)," I am a recruitment consultant, currently looking for a ",t&&t.metadata&&t.metadata.designation||"Candidate"," for a job opening with one of my renowned clients.",f.createElement("br",null),"I have reviewed your profile and it seems a good match. If interested, do ping back. "),f.createElement("li",{onClick:this._setContent.bind(this)},"Hi ",t&&Object(l.h)(t.NAME)||"Candidate",",",f.createElement("br",null)," I came across your profile on Naukri.com. I have some openings for which your profile seems to be a good match. If you are interested we can take it forward.",f.createElement("br",null),"Regards,",f.createElement("br",null),i.NAME,f.createElement("br",null),o||"Recruiter"," ",u&&" at "+u))),this.props.isMsg&&f.createElement(a.a,{icon:"icon-menu",iconCls:"wf-chat-three-dots"},f.createElement("ul",{className:"_list"},f.createElement("li",{onClick:this.blockUserHandler},this.props.blocked?"UNBLOCK USER":"BLOCK USER"))),f.createElement("a",{href:"javascript:void(0);",onClick:n},f.createElement("i",{class:"fontIcon wf-chat-cross"})),this.state.showLightbox&&f.createElement(c.a,{targetNode:this.lightboxBtn,jobseeker:t,block:this._blockUser.bind(this),close:this.closeLightBox.bind(this)})))},t}(f.PureComponent);t.a=y},VdYS:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},c=n("zi+W"),l=n("zTev"),u=n("XsJf"),h=n("PT5i"),d=n("pLky"),p=n("yUvy"),f=n("jPMo"),y=n("kesd"),g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),e.membership||(e.membership={});var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._members=n.getClient()._fixIdentities(e.members||[]).map(function(e){return e.id}),n._register(),n}return o(t,e),s(t,[{key:"destroy",value:function(){this.lastMessage=null,this.getClient()._removeChannel(this),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.membership=null}},{key:"createMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="string"==typeof e?{parts:[{body:e,mimeType:"text/plain"}]}:e;return t.clientId=this.clientId,t.conversationId=this.id,new h(t)}},{key:"_setupMessage",value:function(e){e.position=t.nextPosition,t.nextPosition+=8192}},{key:"_getSendData",value:function(e){var t=f.isEmpty(this.metadata),n=this._members||[];return-1===n.indexOf(this.getClient().user.id)&&n.push(this.getClient().user.id),{method:"Channel.create",data:{name:this.name,metadata:t?null:this.metadata,id:this.id,members:n}}}},{key:"_populateFromServer",value:function(e){this._inPopulateFromServer=!0,this._disableEvents=this.syncState===y.SYNC_STATE.NEW,this.name=e.name,this.isCurrentParticipant=Boolean(e.membership),this.membership=e.membership&&e.membership.id?this.getClient()._createObject(e.membership):null,a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_populateFromServer",this).call(this,e),this._register(),this._disableEvents=!1}},{key:"_createResultConflict",value:function(e){var t=e.data;t?this._createSuccess(t):(this.syncState=y.SYNC_STATE.NEW,this._syncCounter=0,this.trigger("channels:sent-error",{error:e})),this._inPopulateFromServer=!1}},{key:"__adjustName",value:function(e){if(!(this._inPopulateFromServer||this._inLayerParser||this.isNew()||this.isLoading))throw new Error(d.dictionary.permissionDenied)}},{key:"__updateName",value:function(e,t){this._triggerAsync("channels:change",{property:"name",oldValue:t,newValue:e})}},{key:"addMembers",value:function(e){var t=this;return e=this.getClient()._fixIdentities(e).map(function(e){return e.id}),this.syncState===y.SYNC_STATE.NEW?(this._members=this._members.concat(e),this):(e.forEach(function(e){t._xhr({url:"/members/"+e.replace(/^layer:\/\/\/identities\//,""),method:"PUT"})}),this)}},{key:"removeMembers",value:function(e){var t=this;return e=this.getClient()._fixIdentities(e).map(function(e){return e.id}),this.syncState===y.SYNC_STATE.NEW?(e.forEach(function(e){var n=t._members.indexOf(e);-1!==n&&t._members.splice(n,1)}),this):(e.forEach(function(e){t._xhr({url:"/members/"+e.replace(/^layer:\/\/\/identities\//,""),method:"DELETE"})}),this)}},{key:"join",value:function(){return this.addMembers([this.getClient().user.id])}},{key:"leave",value:function(){return this.removeMembers([this.getClient().user.id])}},{key:"getMember",value:function(e){e=this.getClient()._fixIdentities([e])[0].id;var t=this.id+"/members/"+e.replace(/layer:\/\/\/identities\//,"");return this.getClient().getMember(t,!0)}},{key:"delete",value:function(){this._delete("")}},{key:"_handlePatchEvent",value:function(e,n,i){this._inLayerParser=!1;try{var r=this._disableEvents;this._disableEvents=!1,a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_handlePatchEvent",this).call(this,e,n,i),this._disableEvents=r}catch(e){}this._inLayerParser=!0}},{key:"_register",value:function(){this.getClient()._addChannel(this)}},{key:"_deleteResult",value:function(e,n){var i=this.getClient();e.success||e.data&&("not_found"===e.data.id||"authentication_required"===e.data.id)||t.load(n,i)}},{key:"toObject",value:function(){return this._toObject||(this._toObject=a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toObject",this).call(this),this._toObject.membership=f.clone(this.membership)),this._toObject}}],[{key:"_createFromServer",value:function(e,n){return new t({client:n,fromServer:e,_fromDB:e._fromDB})}},{key:"create",value:function(e){if(!e.client)throw new Error(d.dictionary.clientMissing);e.name||(e.name="channel-"+String(Math.random()).replace(/\./,""));var n={name:e.name,private:e.private,members:e.members?e.client._fixIdentities(e.members).map(function(e){return e.id}):[],metadata:e.metadata,client:e.client},i=e.client.findCachedChannel(function(e){return e.name===n.name});return i&&(i._sendDistinctEvent=new p({target:i,result:!e.metadata||f.doesObjectMatch(e.metadata,i.metadata)?t.FOUND:t.FOUND_WITHOUT_REQUESTED_METADATA},"channels:sent")),i||new t(n)}}]),t}(u);g.prototype.name="",g.prototype.membership=null,g.prototype._members=null,g.eventPrefix="channels",g.nextPosition=0x10000000000000000,g.prefixUUID="layer:///channels/",g._supportedEvents=["channels:sent","channels:sent-error","channels:loaded","channels:loaded-error","channels:delete","channels:change"].concat(l._supportedEvents),c.initClass.apply(g,[g,"Channel"]),l.subclasses.push(g),e.exports=g},XoSQ:function(e,t,n){"use strict";var i=n("4wNg"),r=n("E7xV"),o=n("B+kz"),s=n("NoJc"),a=n("Tqr5"),c=n("dGzY"),l=n("iZkC"),u=n("pLky").dictionary;e.exports={events:[],lifecycle:{constructor:function(e){this._models.queries={}},cleanup:function(){var e=this;Object.keys(this._models.queries).forEach(function(t){var n=e._models.queries[t];n&&!n.isDestroyed&&n.destroy()}),this._models.queries=null},reset:function(){this._models.queries={}}},methods:{getQuery:function(e){if("string"!=typeof e)throw new Error(u.idParamRequired);return this._models.queries[e]||null},createQuery:function(e){var t=void 0;switch("function"==typeof e.build&&(e=e.build()),e.client=this,e.model){case i.Identity:t=new r(e);break;case i.Conversation:t=new o(e);break;case i.Channel:t=new s(e);break;case i.Membership:t=new a(e);break;case i.Message:t=new c(e);break;case i.Announcement:t=new l(e);break;default:t=new i(e)}return this._addQuery(t),t},_addQuery:function(e){this._models.queries[e.id]=e},_removeQuery:function(e){var t=this;if(e){if(delete this._models.queries[e.id],!this._inCleanup){var n=e.data.map(function(e){return t.getObject(e.id)}).filter(function(e){return e});this._checkAndPurgeCache(n)}this.off(null,null,e)}}}}},XsJf:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},l=n("zTev"),u=n("pLky"),h=n("jPMo"),d=n("kesd"),p=n("zi+W"),f=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),e.fromServer&&(e.id=e.fromServer.id),e.client&&(e.clientId=e.client.appId),e.metadata||(e.metadata={});var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(!n.clientId)throw new Error(u.dictionary.clientMissing);return n.isInitializing=!0,e&&e.fromServer&&n._populateFromServer(e.fromServer),n.metadata||(n.metadata={}),n.createdAt||(n.createdAt=new Date),n.isInitializing=!1,n}return o(t,e),a(t,[{key:"send",value:function(e){var t=this;return this.isNew()&&(this.createdAt=new Date,this._setSyncing(),this.getClient()._triggerAsync("state-change",{started:!0,type:"send_"+h.typeFromID(this.id),telemetryId:"send_"+h.typeFromID(this.id)+"_time",id:this.id}),this.getClient().sendSocketRequest({method:"POST",body:{},sync:{depends:this.id,target:this.id}},function(e){return t._createResult(e)})),e&&this._setupMessage(e),this}},{key:"_populateFromServer",value:function(e){var t=this.getClient();this._setSynced();var n=this.id;this.id=e.id,n!==this.id&&(t._updateContainerId(this,n),this._triggerAsync(this.constructor.eventPrefix+":change",{oldValue:n,newValue:this.id,property:"id"})),this.url=e.url,this.createdAt=new Date(e.created_at),this.metadata=e.metadata}},{key:"_createResult",value:function(e){var t=e.success,n=e.data;this.getClient()._triggerAsync("state-change",{ended:!0,type:"send_"+h.typeFromID(this.id),telemetryId:"send_"+h.typeFromID(this.id)+"_time",id:this.id}),this.isDestroyed||(t?this._createSuccess(n):"conflict"===n.id?this._createResultConflict(n):(this.trigger(this.constructor.eventPrefix+":sent-error",{error:n}),this.destroy()))}},{key:"_createSuccess",value:function(e){var n=this.id;this._populateFromServer(e),this._triggerAsync(this.constructor.eventPrefix+":sent",{result:n===this.id?t.CREATED:t.FOUND})}},{key:"setMetadataProperties",value:function(e){var t=this,n=[];return Object.keys(e).forEach(function(t){var i=t;t&&("metadata"!==t&&0!==t.indexOf("metadata.")&&(i="metadata."+t),n.push({operation:"set",property:i,value:e[t]}))}),this._inLayerParser=!0,h.layerParse({object:this,type:"Conversation",operations:n,client:this.getClient()}),this._inLayerParser=!1,this._xhr({url:"",method:"PATCH",data:JSON.stringify(n),headers:{"content-type":"application/vnd.layer-patch+json"}},function(e){e.success||t.isDestroyed||"authentication_required"===e.data.id||t._load()}),this}},{key:"deleteMetadataProperties",value:function(e){var t=this,n=[];return e.forEach(function(e){"metadata"!==e&&0!==e.indexOf("metadata.")&&(e="metadata."+e),n.push({operation:"delete",property:e})},this),this._inLayerParser=!0,h.layerParse({object:this,type:"Conversation",operations:n,client:this.getClient()}),this._inLayerParser=!1,this._xhr({url:"",method:"PATCH",data:JSON.stringify(n),headers:{"content-type":"application/vnd.layer-patch+json"}},function(e){e.success||"authentication_required"===e.data.id||t._load()}),this}},{key:"_delete",value:function(e){var t=this,n=this.id;this._xhr({method:"DELETE",url:"?"+e},function(e){return t._deleteResult(e,n)}),this._deleted(),this.destroy()}},{key:"_handleWebsocketDelete",value:function(e){e.mode===d.DELETION_MODE.MY_DEVICES&&e.from_position?this.getClient()._purgeMessagesByPosition(this.id,e.from_position):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_handleWebsocketDelete",this).call(this)}},{key:"_getUrl",value:function(e){return this.url+(e||"")}},{key:"_loaded",value:function(e){this._register(this)}},{key:"on",value:function(e,n,i){var r=this.constructor.eventPrefix+":loaded";if((e===r||e&&"object"===(void 0===e?"undefined":s(e))&&e[r])&&!this.isLoading){var o=e===r?n:e[r];h.defer(function(){return o.apply(i)})}return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).call(this,e,n,i),this}},{key:"_triggerAsync",value:function(e,n){this._clearObject(),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_triggerAsync",this).call(this,e,n)}},{key:"trigger",value:function(e,n){this._clearObject(),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"trigger",this).call(this,e,n)}},{key:"__updateMetadata",value:function(e,t,n){this._inLayerParser||JSON.stringify(e)!==JSON.stringify(t)&&this._triggerAsync(this.constructor.eventPrefix+":change",{property:"metadata",newValue:e,oldValue:t,paths:n})}},{key:"_handlePatchEvent",value:function(e,t,n){0===n[0].indexOf("metadata")&&this.__updateMetadata(e,t,n)}},{key:"toObject",value:function(){return this._toObject||(this._toObject=c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toObject",this).call(this),this._toObject.metadata=h.clone(this.metadata)),this._toObject}}],[{key:"_loadResourceForPatch",value:function(e){return!0}}]),t}(l);f.prototype.createdAt=null,f.prototype.metadata=null,f.prototype.isCurrentParticipant=!0,f.prototype._sendDistinctEvent=null,f.prototype._toObject=null,f.bubbleEventParent="getClient",f.CREATED="Created",f.FOUND="Found",f.FOUND_WITHOUT_REQUESTED_METADATA="FoundMismatch",p.initClass.apply(f,[f,"Container"]),l.subclasses.push(f),e.exports=f},YE0g:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("9HRS"),a=n.n(s),c=window.interfaces.Virtual,l=function(e){function t(n){return i(this,t),r(this,e.call(this,n))}return o(t,e),t.prototype.render=function(){return c.createElement("div",{className:"message-list"},c.createElement("div",{className:"icebreaker"},c.createElement("img",{src:a.a}),c.createElement("div",{className:"middle-text"},c.createElement("p",{className:"mt-first"},"Unsure how to start?"),c.createElement("p",{className:"mt-second"}," Send the predefined ice-breaker & have a great conversation"))))},t}(c.PureComponent);t.a=l},"Z/oI":function(e,t,n){"use strict";function i(e){var t=e.appId;l[t]&&!l[t].isDestroyed&&l[t].destroy(),l[t]=e,d(function(){return u.forEach(function(t){return t(e)})})}function r(e){l[e.appId]&&delete l[e.appId]}function o(e){return l[e]||null}function s(){return Object.keys(l).map(function(e){return l[e]})}function a(e){u.push(e)}function c(e){if(e){var t=u.indexOf(e);t>=0&&u.splice(t,1)}else u.splice(0,u.length)}var l={},u=[],h=n("jPMo"),d=h.defer;e.exports={get:o,getAll:s,register:i,unregister:r,addListener:a,removeListener:c}},ZRT1:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("/CmL"),a=n("IpBb"),c=window.interfaces,l=c.Virtual,u=(c.VirtualDom,function(e){function t(){i(this,t);var n=r(this,e.call(this));return n.lightbox=null,n.lightboxModal=null,n.lightboxRef=n.lightboxRef.bind(n),n.state={dataLoading:!1},n.uba=a.a.getInstance(),n}return o(t,e),t.prototype.attachedCallback=function(){this.initalizeDrawer()},t.prototype.componentWillUnmount=function(){this.lightboxModal&&this.lightboxModal.destroy()},t.prototype.closeLightbox=function(){this.props.close(),this.lightboxModal.close()},t.prototype.lightboxRef=function(e){this.lightbox=e&&e.firstChild},t.prototype.initalizeDrawer=function(){var e=this;requirejs(["pathStatic0_0/j/model_v5/modelWindow.amd"],function(t){var n=t.lightBox,i={trigger:$("<div>"),model:$(e.lightbox),dir:"right",routing:!1,minZIndex:"999999999",fixed:!0,open:{event:"",anim:"",success:function(){}},dimens:{width:"457px",height:"201px"},close:{esc:!0,layer:!1,anim:"",success:function(){e.closeLightbox()}}};e.lightboxModal=n(i),e.lightboxModal.open()})},t.prototype.render=function(){var e=this,t=this.props.jobseeker,n=(JSON.parse(window.chatData||"{}"),t.NAME);return n||(n=" this candidate"),l.createElement("div",{className:"block-chat-lightbox-wrapper",ref:this.lightboxRef},l.createElement("div",{className:"block-chat-lightbox lightbox",style:{background:"white",zIndex:99999}},l.createElement("div",null,l.createElement("div",{className:"block-chat-wrapper"},l.createElement("div",{class:"block-chat-text"},l.createElement("p",null,s.a.BLOCK_USER_LABEL+" "+n+s.a.QUESTION_MARK_LABEL)),l.createElement("div",{class:"block-chat-close"},l.createElement("span",{onClick:function(){e.closeLightbox()}},l.createElement("i",{className:"fontIcon wf-chat-cross"})))),l.createElement("div",{className:"bock-chat-actions"},l.createElement("div",{className:"text-level2"},l.createElement("p",null,s.a.BLOCK_USER_WARNING_LABEL_1+n+" "+s.a.BLOCK_USER_WARNING_LABEL_2)),l.createElement("div",{className:"bock-chat-action-bt"},l.createElement("span",{className:"chat-button-left",onClick:function(){e.props.block()}},s.a.BLOCK_LABEL),l.createElement("span",{className:"chat-button-right",onClick:function(){e.closeLightbox()}},s.a.DONT_BLOCK_LABEL))))))},t}(l.Component));t.a=u},ZXdQ:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("p150"),a=n("h7zK"),c=n("sQD6"),l=n("Aw5G"),u=n("ANxG"),h=n("QX7m"),d=n("ZXrB"),p=n.n(d),f=n("SyvT"),y=n.n(f),g=n("Cehq"),v=n.n(g),_=n("PydB"),m=n("I0H9"),b=n("+SiN"),E=n("2zqC"),w=(n.n(E),n("sgBt")),k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O=window.interfaces.connect,C=window.interfaces.Virtual,S=function(e){function t(n){i(this,t);var o=r(this,e.apply(this,arguments));return o.handleIntersect=function(e){var t=void 0;e.forEach(function(e){t=e.intersectionRatio,"loadMoreLnk"==e.target.id&&t>0&&"convSearchField"!=document.activeElement.id&&o.setState({readyToSearch:!1},function(){o.isObserverAttached=!1,o.loadMore()})})},o.state={searchData:null,chatList_visible:!1,showFeedbackSection:getCookie("chat-feedback-dismiss-timestamp")||!0,jobsLoaded:!1,readyToSearch:o.props.conversation.paging.readyToSearch},o._outsideHandler=o._handleOutsideClick.bind(o),o.popup=null,o.focusEvt=null,o.blurEvt=null,o.isObserverAttached=!1,o.iObserver=new IntersectionObserver(o.handleIntersect,{}),localStorage&&o.showToolTip(),o}return o(t,e),t.prototype.componentDidUpdate=function(){var e=document.querySelector("#loadMoreLnk");e&&!this.isObserverAttached&&(this.iObserver.observe(e),this.isObserverAttached=!0)},t.prototype.componentDidMount=function(){this.props.persistOnClick||document.body.addEventListener("click",this._outsideHandler,!1);var e=document.querySelector("#loadMoreLnk");e&&!this.isObserverAttached&&(this.iObserver.observe(e),this.isObserverAttached=!0),this.props.loadConversation()},t.prototype.componentWillUnmount=function(){document.body.removeEventListener("click",this._outsideHandler,!1)},t.prototype.showToolTip=function(){var e=void 0;if(e="object"===("undefined"==typeof gnb_variables?"undefined":k(gnb_variables))?window.gnb_variables:{},e.userId){var t=localStorage.getItem("chat-tooltip-time-"+e.userId);if(t){var n=new Date,i=new Date(t);Object(b.e)(n,i)>0&&($("[data-chat-open]").length&&$("[data-chat-open]").append("<div class='chatMsgHover'><span></span>Message job seekers to get faster responses. This action does not consume any additional quota.</div>"),localStorage.removeItem("chat-tooltip-time-"+e.userId))}else Object(b.a)("chat-tooltip-time-"),$("[data-chat-open]").length&&$("[data-chat-open]").append("<div class='chatMsgHover'><span></span>Message job seekers to get faster responses. This action does not consume any additional quota.</div>")}},t.prototype._handleOutsideClick=function(e){"cht-feedback-dismiss"!=e.target.className&&(this._conversation&&this._conversation.contains(e.target)||(this.props.closeConversation(),document.body.removeEventListener("click",this._outsideHandler,!1)))},t.prototype.onFilter=function(e){this.props.filterConversation(e,this.props.main.user)},t.prototype.componentWillReceiveProps=function(e){this.state.readyToSearch!=e.conversation.paging.readyToSearch&&this.setState({readyToSearch:e.conversation.paging.readyToSearch})},t.prototype.loadMore=function(){var e=this.props.conversation;this.props.loadConversation(e.paging.page)},t.prototype.dismissFeedback=function(){this.owner&&this.owner.IDENTITY_ID,setCookie("chat-feedback-dismiss-timestamp",(new Date).toString(),30,"/",".naukri.com"),this.setState({showFeedbackSection:!1})},t.prototype.shouldComponentUpdate=function(e,t){return this.props!=e||this.state!=t},t.prototype.shouldFeedbackDisplay=function(){var e=this.state.showFeedbackSection;if(!e)return!1;if("string"==typeof e){var t=new Date(e);return(new Date-t)/864e5>=30}return!0},t.prototype.onClick=function(e){this.props.dispatch(Object(w.openChatWindow)(e)),this.props.dispatch({type:"TOGGLE_ATTACHMENT_ERROR",payload:{show:!1}}),this.props.persistOnClick||this.props.closeConversation()},t.prototype.renderFeedackSection=function(){var e="undefined"!=typeof gnb_variables&&gnb_variables.recruiterUsername||"";return C.createElement(_.a,{convCount:this.props.conversation.conversations.length,dismissFeedback:this.dismissFeedback.bind(this),owner:this.props.main.user,userEmail:e})},t.prototype.loadJobs=function(){this.state.jobsLoaded||this.setState({jobsLoaded:!0})},t.prototype.isLastMsg=function(e){var t=!1;return e.map(function(e){e.lastMessage&&(t=!0)}),t},t.prototype.noConversation=function(e){return C.createElement("div",{className:"_conversation "+(e.shown?"shown":"")},C.createElement(m.a,{icon:p.a,class:"noConversationIcon"},C.createElement("div",{className:"no-result noconversations"},C.createElement("p",null,"You have no conversations yet."),C.createElement("p",{className:"no-conv-message"},"To start talking with candidates, go to their CV detail page and click the 'Chat' button."),C.createElement("img",{src:y.a,alt:""})),C.createElement("div",{className:"chat-help"},C.createElement("div",null,C.createElement("p",null,"Recruiter chat is still in early release."),C.createElement("p",null,C.createElement("a",{href:"http://www.naukri.com/tieups/tieups.php?othersrcp=30007",target:"_black"},"Learn more on Naukri Recruiter blog"))))))},t.prototype.render=function(){var e=this,t=this.props,n=t.conversation,i=t.main,r=n.conversations,o=i.chatWindows,s=o&&o[0];return r&&0!==r.length&&this.isLastMsg(r)?C.createElement("div",{ref:function(t){return e._conversation=t},className:"_conversation "+(this.props.close?"slideUp":"")},n.loading?C.createElement("div",{className:"_loader"},C.createElement(h.a,null)):C.createElement("div",{className:"_inner"},C.createElement(u.a,{conversations:r,onFilter:this.onFilter.bind(this)}),this.shouldFeedbackDisplay()&&r&&r.length>=2&&this.renderFeedackSection(),n.filtered.length?C.createElement("ul",{className:"_list",id:"conversationList"},n.filtered.map(function(t){return t.lastMessage?C.createElement(l.a,{key:t.conversationId,conversation:t,user:i.user,onClick:e.onClick.bind(e),activeConversation:s}):null}),this.state.readyToSearch&&C.createElement("li",{id:"loadMoreLnk",style:{height:"5px"}})):C.createElement(m.a,{icon:v.a,class:"no-result-img"},C.createElement("div",{class:"no-result"},C.createElement("span",null,"No search result found."))))):this.noConversation(n)},t}(C.PureComponent);t.a=O(a.a,Object(c.b)(s))(S)},ZXrB:function(e,t){e.exports="//static.naukimg.com/s/5/102/i/no-conversation-yet.png"},aAY6:function(e,t,n){"use strict";function i(e){e.client.once("destroy",function(){return o=null}),o=new r({camelCase:!0,getObjectCallback:function(t){return e.client.getObject(t)},createObjectCallback:function(t,n){return e.client._createObject(n)},propertyNameMap:{Conversation:{unreadMessageCount:"unreadCount"},Identity:{presence:"_presence"}},changeCallbacks:{Message:{all:function(e,t,n,i){e._handlePatchEvent(t,n,i)}},Conversation:{all:function(e,t,n,i){e._handlePatchEvent(t,n,i)}},Channel:{all:function(e,t,n,i){e._handlePatchEvent(t,n,i)}},Identity:{all:function(e,t,n,i){e._handlePatchEvent(t,n,i)}}}})}var r=n("LM/i"),o=void 0;e.exports=function(e){o||i(e),o.parse(e)}},aslY:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n("ZXdQ"),a=(n("QDPI"),n("Kzi/")),c=n("0VJh"),l=n("0M3w"),u=(n("25fZ"),window.interfaces.Virtual),h=function(e){function t(){i(this,t);var n=r(this,e.apply(this,arguments));return n.state={close:!0},n._selectJobs=n._selectJobs.bind(n),n}return o(t,e),t.prototype._selectJobs=function(e){this.props.dispatch(Object(l.selectLiveJob)(e))},t.prototype.render=function(e){var t=this,n=(e.main,e.conversation);return u.createElement("div",null,n.shown&&u.createElement(s.a,{persistOnClick:!1,close:this.props.conversationClose}),this.props.jobsLoaded&&u.createElement(a.a,{dispatch:this.props.dispatch,selectJob:this._selectJobs,chats:e.chats,toggleAttachJobLightbox:l.toggleAttachLightbox}),u.createElement(c.a,{dispatch:this.props.dispatch,loadJobs:function(){return t.props.loadJobs()},openChat:this.props.openChat,owner:this.props.owner}))},t}(u.PureComponent);t.a=h},b0HG:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"FlowContainer",function(){return v});var s=n("sgBt"),a=n("Nx0o"),c=n("sQD6"),l=n("QDPI"),u=n("aslY"),h=n("p150"),d=(n("25fZ"),n("MfyV")),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},f=window.interfaces.connect,y=window.interfaces.Virtual,g=function(e){function t(){i(this,t);var n=r(this,e.apply(this,arguments));return n._unreadCountElement=null,n.state={jobsLoaded:!1,close:!0},n.loadJobs=n.loadJobs.bind(n),new d.a,n}return o(t,e),t.prototype.loadJobs=function(){this.state.jobsLoaded||this.setState({jobsLoaded:!0})},t.prototype.componentDidMount=function(){this.props.getIdentity()},t.prototype.toggleConversation=function(e){var t=this;e.preventDefault(),e.stopPropagation(),this.setState({close:!this.state.close}),this.loadJobs(),this.props.conversation.shown?setTimeout(function(){t.props.dispatch(Object(h.closeConversation)())},500):this.props.dispatch(Object(h.openConversation)({}))},t.prototype._openChatWindow=function(e){this.props.dispatch(Object(s.openChatWindow)(e))},t.prototype.render=function(e){var t=this.props,n=(t.main,t.conversation),i=n.unreadConversationCount;return y.createElement("div",{className:"right"},y.createElement("div",{className:"gnbChatIcon left",style:{background:this.props.conversation.shown?"white":"none"},tabIndex:"-1"},y.createElement("span",{className:"fontIcon wf-chat-icon right",style:{opacity:null===this.props.conversation.shown?"0.5":"0.9",color:this.props.conversation.shown?"#666":"inherit"},onClick:this.toggleConversation.bind(this)},i>0&&y.createElement("span",{className:"chat-count"},i))),y.createElement("div",{class:"clearfix"}),y.createElement("div",{className:"edge-chat"},y.createElement(u.a,p({},e,{jobsLoaded:this.state.jobsLoaded,loadJobs:this.loadJobs,openChat:this._openChatWindow.bind(this),conversationClose:this.state.close})),this.props.main.chatWindows.length>0&&y.createElement(l.a,null)))},t}(y.PureComponent),v=f(a.a,Object(c.b)(s))(g)},b6EZ:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},c=n("zi+W"),l=n("S/PF"),u=n("EvUg"),h=n("Z/oI"),d=n("pLky"),p=n("jPMo"),f=n("P+Qc"),y=function(e){function t(e){i(this,t);var n=e;if("string"==typeof e)n={body:e},(arguments.length<=1?0:arguments.length-1)>0?n.mimeType=arguments.length<=1?void 0:arguments[1]:n.mimeType="text/plain";else if(p.isBlob(e)||p.isBlob(e.body)){var o=e instanceof Blob?e:e.body,s=p.isBlob(e.body)?e.mimeType:o.type;n={mimeType:s,body:o,size:o.size,hasContent:!0}}var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));!a.size&&a.body&&(a.size=a.body.length),"base64"===e.encoding&&(a.body=p.base64ToBlob(a.body));var c=p.isBlob(a.body);return a.isTextualMimeType()||(!c&&a.body&&(a.body=new Blob([a.body],{type:a.mimeType})),a.body&&(a.url=URL.createObjectURL(a.body))),a}return o(t,e),s(t,[{key:"destroy",value:function(){this.__url&&(URL.revokeObjectURL(this.__url),this.__url=null),this.body=null,a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_getClient",value:function(){return h.get(this.clientId)}},{key:"_getMessage",value:function(){return this._getClient().getMessage(this.id.replace(/\/parts.*$/,""))}},{key:"fetchContent",value:function(e){var t=this;if(this._content&&!this.isFiring){this.isFiring=!0;var n="image/jpeg+preview"===this.mimeType?"image/jpeg":this.mimeType;this._content.loadContent(n,function(n,i){t.isDestroyed||t._fetchContentCallback(n,i,e)})}return this}},{key:"_fetchContentCallback",value:function(e,t,n){var i=this;e?this.trigger("content-loaded-error",e):(this.isFiring=!1,this.isTextualMimeType()?p.fetchTextFromFile(t,function(e){return i._fetchContentComplete(e,n)}):(this.url=URL.createObjectURL(t),this._fetchContentComplete(t,n)))}},{key:"_fetchContentComplete",value:function(e,t){var n=this._getMessage();n&&(this.body=e,this.trigger("content-loaded"),n._triggerAsync("messages:change",{oldValue:n.parts,newValue:n.parts,property:"parts"}),t&&t(this.body))}},{key:"fetchStream",value:function(e){var t=this;if(!this._content)throw new Error(d.dictionary.contentRequired);return this._content.isExpired()?this._content.refreshContent(this._getClient(),function(n){return t._fetchStreamComplete(n,e)}):this._fetchStreamComplete(this._content.downloadUrl,e),this}},{key:"_fetchStreamComplete",value:function(e,t){var n=this._getMessage();this.trigger("url-loaded"),this._triggerAsync("messageparts:change",{oldValue:"",newValue:e,property:"url"}),n._triggerAsync("messages:change",{oldValue:n.parts,newValue:n.parts,property:"parts"}),t&&t(e)}},{key:"_send",value:function(e){this._content?this._sendWithContent():this.size>2048?this._generateContentAndSend(e):p.isBlob(this.body)?this._sendBlob(e):this._sendBody()}},{key:"_sendBody",value:function(){if("string"!=typeof this.body){var e="MessagePart.body must be a string in order to send it";throw f.error(e,{mimeType:this.mimeType,body:this.body}),new Error(e)}var t={mime_type:this.mimeType,body:this.body};this.trigger("parts:send",t)}},{key:"_sendWithContent",value:function(){this.trigger("parts:send",{mime_type:this.mimeType,content:{size:this.size,id:this._content.id}})}},{key:"_sendBlob",value:function(e){var t=this;p.blobToBase64(this.body,function(n){if(n.length<2048){var i=n.substring(n.indexOf(",")+1),r={body:i,mime_type:t.mimeType};r.encoding="base64",t.trigger("parts:send",r)}else t._generateContentAndSend(e)})}},{key:"_generateContentAndSend",value:function(e){var t=this;this.hasContent=!0;var n=void 0;n=p.isBlob(this.body)?this.body:p.base64ToBlob(p.utoa(this.body),this.mimeType),e.xhr({url:"/content",method:"POST",headers:{"Upload-Content-Type":this.mimeType,"Upload-Content-Length":n.size,"Upload-Origin":"undefined"!=typeof location?location.origin:""},sync:{}},function(i){return t._processContentResponse(i.data,n,e)})}},{key:"_processContentResponse",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._content=new l(e.id),this.hasContent=!0,u({url:e.upload_url,method:"PUT",data:t,headers:{"Upload-Content-Length":this.size,"Upload-Content-Type":this.mimeType}},function(o){return i._processContentUploadResponse(o,e,n,t,r)})}},{key:"_processContentUploadResponse",value:function(e,n,i,r,o){e.success?this.trigger("parts:send",{mime_type:this.mimeType,content:{size:this.size,id:this._content.id}}):i.onlineManager.isOnline?o<t.MaxRichContentRetryCount?this._processContentResponse(n,r,i,o+1):(f.error("Failed to upload rich content; triggering message:sent-error event; status of ",e.status,this),this._getMessage().trigger("messages:sent-error",{error:new d({message:"Upload of rich content failed",httpStatus:e.status,code:0,data:e.xhr}),part:this})):i.onlineManager.once("connected",this._processContentResponse.bind(this,n,i),this)}},{key:"getText",value:function(){return this.isTextualMimeType()?this.body:""}},{key:"_populateFromServer",value:function(e){var t=this;e.content&&this._content?(this._content.downloadUrl=e.content.download_url,this._content.expiration=new Date(e.content.expiration)):this.isTextualMimeType()?this.body=e.body:e.body?p.blobToBase64(this.body,function(n){n!==p.btoa(e.body)&&(t.body=new Blob([e.body],{type:t.mimeType}),t.body&&(t.url=URL.createObjectURL(t.body)))}):(this.body=null,this.url="")}},{key:"isTextualMimeType",value:function(){var e=0;for(e=0;e<t.TextualMimeTypes.length;e++){var n=t.TextualMimeTypes[e];if("string"==typeof n){if(n===this.mimeType)return!0}else if(n instanceof RegExp&&this.mimeType.match(n))return!0}return!1}},{key:"__updateBody",value:function(e,t){this._triggerAsync("messageparts:change",{property:"body",newValue:e,oldValue:t})}},{key:"__updateMimeType",value:function(e,t){this._triggerAsync("messageparts:change",{property:"mimeType",newValue:e,oldValue:t})}},{key:"_updateUrl",value:function(e,t){t&&URL.revokeObjectURL(t)}}],[{key:"_createFromServer",value:function(e){var n=e.content?l._createFromServer(e.content):null;return"base64"===e.encoding&&(e.body=p.base64ToBlob(e.body,e.mimeType)),new t({id:e.id,mimeType:e.mime_type,body:e.body||"",_content:n,hasContent:Boolean(n),size:e.size||0})}}]),t}(c);y.prototype.clientId="",y.prototype.id="",y.prototype.body=null,y.prototype._content=null,y.prototype.hasContent=!1,Object.defineProperty(y.prototype,"url",{enumerable:!0,get:function(){return this.__url?this.__url:this._content?this._content.isExpired()?"":this._content.downloadUrl:""},set:function(e){this.__url=e}}),y.prototype.mimeType="text/plain",y.prototype.size=0,y.TextualMimeTypes=[/^text\/.+$/,/^application\/json(\+.+)?$/],y.MaxRichContentRetryCount=3,y._supportedEvents=["parts:send","content-loaded","url-loaded","content-loaded-error","messageparts:change"].concat(c._supportedEvents),c.initClass.apply(y,[y,"MessagePart"]),e.exports=y},bD8U:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},c=n("zTev"),l=n("zi+W"),u=n("kesd"),h=u.SYNC_STATE,d=n("pLky"),p=n("jPMo"),f=p.strictEncodeURI,y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(i(this,t),e.fromServer?e.id=e.fromServer.id||"-":!e.id&&e.userId?e.id=t.prefixUUID+f(e.userId):e.id&&!e.userId&&(e.userId=decodeURIComponent(e.id.substring(t.prefixUUID.length))),e.client&&(e.clientId=e.client.appId),!e.clientId)throw new Error(d.dictionary.clientMissing);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.metadata||(n.metadata={}),"-"===n.id&&(n.id=""),n.isInitializing=!0,n._presence||(n._presence={status:null,lastSeenAt:null}),e&&e.fromServer&&n._populateFromServer(e.fromServer),!n.url&&n.id?n.url=n.getClient().url+"/"+n.id.substring(9):n.url||(n.url=""),n.getClient()._addIdentity(n),n.getClient().on("online",function(e){e.isOnline||n._updateValue(["_presence","status"],t.STATUS.OFFLINE)},n),n.isInitializing=!1,n}return o(t,e),s(t,[{key:"destroy",value:function(){var e=this.getClient();e&&e._removeIdentity(this),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_triggerAsync",value:function(e,n){this._clearObject(),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_triggerAsync",this).call(this,e,n)}},{key:"trigger",value:function(e,n){this._clearObject(),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"trigger",this).call(this,e,n)}},{key:"_populateFromServer",value:function(e){var t=this,n=this.getClient();this._disableEvents=this.syncState===h.NEW,this._setSynced(),this.userId=e.user_id||"",this._updateValue(["avatarUrl"],e.avatar_url),this._updateValue(["displayName"],e.display_name),"metadata"in e&&(this.url=e.url,this.type=e.type,this._updateValue(["emailAddress"],e.email_address),this._updateValue(["lastName"],e.last_name),this._updateValue(["firstName"],e.first_name),this._updateValue(["metadata"],e.metadata||{}),this._updateValue(["publicKey"],e.public_key),this._updateValue(["phoneNumber"],e.phone_number),this.isFullIdentity=!0),!this.url&&this.id&&(this.url=this.getClient().url+this.id.substring(8)),this._disableEvents=!1,!this.isFullIdentity&&n.isAuthenticated&&n.dbManager.getObjects("identities",[this.id],function(e){e.length&&t._populateFromServer(e[0])})}},{key:"_updateValue",value:function(e,t){null!==t&&void 0!==t||(t="");for(var n=this,i=0;i<e.length-1;i++)n=n[e[i]];var r=e[e.length-1];n[r]!==t&&(this.isInitializing||("_presence"===e[0]&&(e=[e[1]]),this._triggerAsync("identities:change",{property:e.join("."),oldValue:n[r],newValue:t})),n[r]=t)}},{key:"_handlePatchEvent",value:function(e,t,n){var i=this,r=[];n.forEach(function(n){var o=e,s=t;if("presence.last_seen_at"===n)i._presence.lastSeenAt=new Date(o.last_seen_at),o=i._presence.lastSeenAt,s=s.lastSeenAt,delete i._presence.last_seen_at;else if("presence.status"===n&&(o=i._presence.status,s=s.status,o===s))return;var a=n.replace(/_(.)/g,function(e,t){return t.toUpperCase()}).replace(/^presence\./,"");r.push({property:a,oldValue:s,newValue:o})}),1===r.length&&"lastSeenAt"===r[0].property||r.forEach(function(e){return i._triggerAsync("identities:change",e)})}},{key:"follow",value:function(){var e=this;this.isFullIdentity||(this._xhr({method:"PUT",url:this.url.replace(/identities/,"following/users"),syncable:{}},function(t){t.success&&e._load()}),this.syncState=h.LOADING)}},{key:"unfollow",value:function(){this._xhr({url:this.url.replace(/identities/,"following/users"),method:"DELETE",syncable:{}})}},{key:"setStatus",value:function(e){var n=this;if(e=(e||"").toLowerCase(),!t.STATUS[e.toUpperCase()])throw new Error(d.dictionary.valueNotSupported);if(this!==this.getClient().user)throw new Error(d.dictionary.permissionDenied);e===t.STATUS.INVISIBLE&&(e=t.STATUS.OFFLINE);var i=this._presence.status;this.getClient().sendSocketRequest({method:"PATCH",body:{method:"Presence.update",data:[{operation:"set",property:"status",value:e}]},sync:{depends:[this.id],target:this.id}},function(e){e.success||"authentication_required"===e.data.id||n._updateValue(["_presence","status"],i)}),e===t.STATUS.OFFLINE&&(e=t.STATUS.INVISIBLE),this._updateValue(["_presence","status"],e)}},{key:"_setUserId",value:function(e){var n=this.getClient();n._removeIdentity(this),this.__userId=e;var i=f(e);this.id=t.prefixUUID+i,this.url=this.getClient().url+"/identities/"+i,n._addIdentity(this)}},{key:"__adjustUserId",value:function(e){if(this.__userId)throw new Error(d.dictionary.cantChangeUserId)}},{key:"_handleWebsocketDelete",value:function(e){var t=this;this.getClient().dbManager.deleteObjects("identities",[this]),["firstName","lastName","emailAddress","phoneNumber","metadata","publicKey","isFullIdentity","type"].forEach(function(e){return delete t[e]}),this._triggerAsync("identities:unfollow")}}],[{key:"_createFromServer",value:function(e,n){return new t({client:n,fromServer:e,_fromDB:e._fromDB})}}]),t}(c);y.prototype.displayName="",y.prototype.sessionOwner=!1,y.prototype.clientId="",y.prototype.isFullIdentity=!1,y.prototype.userId="",y.prototype.avatarUrl="",y.prototype.firstName="",y.prototype.lastName="",y.prototype.emailAddress="",y.prototype.phoneNumber="",y.prototype.metadata=null,y.prototype.publicKey="",y.UserType="user",y.BotType="bot",y.prototype.type=y.UserType,y.prototype._presence=null,Object.defineProperty(y.prototype,"status",{enumerable:!0,get:function(){return this._presence&&this._presence.status||y.STATUS.OFFLINE}}),Object.defineProperty(y.prototype,"lastSeenAt",{enumerable:!0,get:function(){return this._presence&&this._presence.lastSeenAt}}),Object.defineProperty(y.prototype,"isBot",{enumerable:!0,get:function(){return this.type===y.BotType}}),y.STATUS={AVAILABLE:"available",AWAY:"away",OFFLINE:"offline",BUSY:"busy",INVISIBLE:"invisible"},y.inObjectIgnore=l.inObjectIgnore,y.bubbleEventParent="getClient",y._supportedEvents=["identities:change","identities:loaded","identities:loaded-error","identities:unfollow"].concat(c._supportedEvents),y.eventPrefix="identities",y.prefixUUID="layer:///identities/",y.enableOpsIfNew=!0,l.initClass.apply(y,[y,"Identity"]),c.subclasses.push(y),e.exports=y},bONa:function(e,t,n){"use strict";var i=n("zTev"),r=(n("ogE9"),n("pLky").dictionary);e.exports={events:["members:loaded","members:change","members:add","members:remove"],lifecycle:{constructor:function(e){this._models.members={}},cleanup:function(){var e=this;Object.keys(this._models.members).forEach(function(t){var n=e._models.members[t];n&&!n.isDestroyed&&n.destroy()}),this._models.members=null},reset:function(){this._models.members={}}},methods:{getMember:function(e,t){if("string"!=typeof e)throw new Error(r.idParamRequired);return this._models.members[e]?this._models.members[e]:t?i.load(e,this):null},_addMembership:function(e){this._models.members[e.id]||(this._models.members[e.id]=e,this._triggerAsync("members:add",{members:[e]}),this._scheduleCheckAndPurgeCache(e))},_removeMembership:function(e){var t="string"==typeof e?e:e.id;(e=this._models.members[t])&&(delete this._models.members[t],this._inCleanup||(e.off(null,null,this),this._triggerAsync("members:remove",{members:[e]})))}}}},dGzY:function(e,t,n){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n("zi+W"),l=n("pLky"),u=n("jPMo"),h=n("P+Qc"),d=n("4wNg"),p=new RegExp(/^conversation.id\s*=\s*['"]((layer:\/\/\/conversations\/)?.{8}-.{4}-.{4}-.{4}-.{12})['"]$/),f=new RegExp(/^channel.id\s*=\s*['"]((layer:\/\/\/channels\/)?.{8}-.{4}-.{4}-.{4}-.{12})['"]$/),y=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),a(t,[{key:"_fixPredicate",value:function(e){if(""===e)return"";if(-1!==e.indexOf("conversation.id")){var t=e.match(p)?e.replace(p,"$1"):null;if(!t)throw new Error(l.dictionary.invalidPredicate);return 0!==t.indexOf("layer:///conversations/")&&(t="layer:///conversations/"+t),"conversation.id = '"+t+"'"}if(-1!==e.indexOf("channel.id")){var n=e.match(f)?e.replace(f,"$1"):null;if(!n)throw new Error(l.dictionary.invalidPredicate);return 0!==n.indexOf("layer:///channels/")&&(n="layer:///channels/"+n),"channel.id = '"+n+"'"}throw new Error(l.dictionary.invalidPredicate)}},{key:"_fetchData",value:function(e){var t=this._getConversationPredicateIds();if(!t)return void(this.predicate&&!this.predicate.match(/['"]/)&&h.error("This query may need to quote its value"));switch(t.type){case d.Conversation:this._fetchConversationMessages(e,t);break;case d.Channel:this._fetchChannelMessages(e,t)}}},{key:"_getSortField",value:function(){return"position"}},{key:"_getConversationPredicateIds",value:function(){if(-1!==this.predicate.indexOf("conversation.id")){if(this.predicate.match(p)){var e=this.predicate.replace(p,"$1"),t=(this._predicate||e).replace(/^layer:\/\/\/conversations\//,"");if(t)return{uuid:t,id:e,type:d.Conversation}}}else if(-1!==this.predicate.indexOf("channel.id")&&this.predicate.match(f)){var n=this.predicate.replace(f,"$1"),i=(this._predicate||n).replace(/^layer:\/\/\/channels\//,"");if(i)return{uuid:i,id:n,type:d.Channel}}}},{key:"_fetchConversationMessages",value:function(e,t){var n=this,i="layer:///conversations/"+t.uuid;this._predicate||(this._predicate=t.id);var r=this.client.getConversation(i);this.client.dbManager.loadMessages(i,this._nextDBFromId,e,function(e){e.length&&n._appendResults({data:e},!0)});var o="conversations/"+t.uuid+"/messages?page_size="+e+(this._nextServerFromId?"&from_id="+this._nextServerFromId:"");r&&!r.isSaved()||o===this._firingRequest||(this.isFiring=!0,this._firingRequest=o,this.client.xhr({telemetry:{name:"message_query_time"},url:o,method:"GET",sync:!1},function(t){return n._processRunResults(t,o,e)})),r&&!r.isSaved()&&(this.pagedToEnd=!0),0===this.data.length&&r&&r.lastMessage&&(this.data=[this._getData(r.lastMessage)],this._triggerChange({type:"data",data:[this._getData(r.lastMessage)],query:this,target:this.client}))}},{key:"_fetchChannelMessages",value:function(e,t){var n=this,i="layer:///channels/"+t.uuid;this._predicate||(this._predicate=t.id);var r=this.client.getChannel(i);this.client.dbManager.loadMessages(i,this._nextDBFromId,e,function(e){e.length&&n._appendResults({data:e},!0)});var o="channels/"+t.uuid+"/messages?page_size="+e+(this._nextServerFromId?"&from_id="+this._nextServerFromId:"");r&&!r.isSaved()||o===this._firingRequest||(this.isFiring=!0,this._firingRequest=o,this.client.xhr({url:o,method:"GET",sync:!1},function(t){return n._processRunResults(t,o,e)})),r&&!r.isSaved()&&(this.pagedToEnd=!0)}},{key:"_appendResultsSplice",value:function(e){var t=this.data,n=this._getInsertIndex(e,t);t.splice(n,0,this._getData(e))}},{key:"_getInsertIndex",value:function(e,t){var n=void 0;for(n=0;n<t.length&&!(e.position>t[n].position);n++);return n}},{key:"_handleEvents",value:function(e,t){switch(e){case"conversations:change":this._handleConvIdChangeEvent(t);break;case"messages:change":case"messages:read":this._handleChangeEvent("messages",t);break;case"messages:add":this._handleAddEvent("messages",t);break;case"messages:remove":this._handleRemoveEvent("messages",t)}}},{key:"_handleConvIdChangeEvent",value:function(e){var t=e.getChangesFor("id");t.length&&this._predicate===t[0].oldValue&&(this._predicate=t[0].newValue,this.predicate="conversation.id = '"+this._predicate+"'",this._run())}},{key:"_handlePositionChange",value:function(e,t){if(-1===t)return!1;var n=[].concat(i(this.data.slice(0,t)),i(this.data.slice(t+1))),r=this._getInsertIndex(e.target,n);return r!==t&&(n.splice(r,0,this._getData(e.target)),this.data=n,this._triggerChange({type:"property",target:this._getData(e.target),query:this,isChange:!0,changes:e.changes}),!0)}},{key:"_handleChangeEvent",value:function(e,t){var n=this._getIndex(t.target.id),r=t.getChangesFor("position");if(r.length&&this._handlePositionChange(t,n)){if(r.length===t.changes.length)return;n=this._getIndex(t.target.id)}-1!==n&&(this.dataType===d.ObjectDataType&&(this.data=[].concat(i(this.data.slice(0,n)),[t.target.toObject()],i(this.data.slice(n+1)))),this._triggerChange({type:"property",target:this._getData(t.target),query:this,isChange:!0,changes:t.changes}))}},{key:"_handleAddEvent",value:function(e,t){var n=this,i=t[e].filter(function(e){var t=u.typeFromID(e.id);return"messages"===t&&n.model===d.Message||"announcements"===t&&n.model===d.Announcement}).filter(function(e){return"announcements"===u.typeFromID(e.id)||e.conversationId===n._predicate}).filter(function(e){return-1===n._getIndex(e.id)}).map(function(e){return n._getData(e)});if(i.length){var r=this.data=this.dataType===d.ObjectDataType?[].concat(this.data):this.data;i.forEach(function(e){var t=n._getInsertIndex(e,r);r.splice(t,0,e),0!==t&&h.warn("Index of "+e.id+" is "+t+"; position is "+e.position+"; compared to "+r[0].position),n.totalSize+=1,n._triggerChange({type:"insert",target:e,query:n,index:t})})}}},{key:"_handleRemoveEvent",value:function(e,t){var n=this,r=[];t[e].forEach(function(e){var t=n._getIndex(e.id);-1!==t&&(e.id===n._nextDBFromId&&(n._nextDBFromId=n._updateNextFromId(t)),e.id===n._nextServerFromId&&(n._nextServerFromId=n._updateNextFromId(t)),r.push({data:e,index:t}),n.dataType===d.ObjectDataType?n.data=[].concat(i(n.data.slice(0,t)),i(n.data.slice(t+1))):n.data.splice(t,1))}),this.totalSize-=r.length,r.forEach(function(e){n._triggerChange({type:"remove",target:n._getData(e.data),index:e.index,query:n})})}}]),t}(d);y._supportedEvents=[].concat(d._supportedEvents),y.MaxPageSize=100,y.prototype.model=d.Message,c.initClass.apply(y,[y,"MessagesQuery"]),e.exports=y},fYnd:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n("jPMo"),s=n("P+Qc"),a=n("pLky"),c=function(){function e(t){i(this,e),this.client=t.client,this.socketManager=t.socketManager,this.socketManager.on({message:this._handleResponse,disconnected:this._reset},this),this._requestCallbacks={}}return r(e,[{key:"_reset",value:function(){this._requestCallbacks={}}},{key:"cancelOperation",value:function(e){var t=this;Object.keys(this._requestCallbacks).forEach(function(n){t._requestCallbacks[n].method===e&&delete t._requestCallbacks[n]})}},{key:"_handleResponse",value:function(e){if("response"===e.data.type){var t=e.data.body,n=t.request_id;s.debug("Websocket response "+n+" "+(t.success?"Successful":"Failed")),n&&this._requestCallbacks[n]&&this._processResponse(n,e)}}},{key:"_processResponse",value:function(e,t){var n=this._requestCallbacks[e],i=t.data.body,r=(i.success?i.data:new a(i.data))||{};i.success&&(n.isChangesArray&&this._handleChangesArray(r.changes),"batch"in r&&(n.batchTotal=r.batch.count,n.batchIndex=r.batch.index,n.isChangesArray?n.results=n.results.concat(r.changes):"results"in r&&Array.isArray(r.results)&&(n.results=n.results.concat(r.results)),r.batch.index<r.batch.count-1))||(n.callback({success:i.success,fullData:"batch"in r?n.results:t.data,data:r}),delete this._requestCallbacks[e])}},{key:"_handleChangesArray",value:function(e){var t=this;e.forEach(function(e){return t.client.socketChangeManager._processChange(e)})}},{key:"sendRequest",value:function(e){var t=e.data,n=e.callback,i=e.isChangesArray,r=void 0!==i&&i;if(!this._isOpen())return n?n(new a({success:!1,data:{id:"not_connected",code:0,message:"WebSocket not connected"}})):void 0;var c=o.clone(t);return c.request_id="r"+this._nextRequestId++,s.debug("Request "+c.request_id+" is sending"),n&&(this._requestCallbacks[c.request_id]={request_id:c.request_id,date:Date.now(),callback:n,isChangesArray:r,method:t.method,batchIndex:-1,batchTotal:-1,results:[]}),this.socketManager.send({type:"request",body:c}),this._scheduleCallbackCleanup(),c.request_id?this._requestCallbacks[c.request_id]:void 0}},{key:"_scheduleCallbackCleanup",value:function(){this._callbackCleanupId||(this._callbackCleanupId=setTimeout(this._runCallbackCleanup.bind(this),15050))}},{key:"_runCallbackCleanup",value:function(){var e=this;if(this._callbackCleanupId=0,!this.isDestroyed&&this._isOpen()){var t=0,n=!1,i=Date.now();Object.keys(this._requestCallbacks).forEach(function(r){var o=e._requestCallbacks[r];n||(o&&i<o.date+15e3?t++:i>e.socketManager._lastDataFromServerTimestamp+15e3?(n=!0,e._failAll(),e.socketManager._reconnect(!1)):e._timeoutRequest(r))}),t&&this._scheduleCallbackCleanup()}}},{key:"_failAll",value:function(){var e=this;Object.keys(this._requestCallbacks).forEach(function(t){try{s.warn("Websocket request aborted due to reconnect"),e._requestCallbacks[t].callback({success:!1,status:503,data:new a({id:"socket_dead",message:"Websocket appears to be dead. Reconnecting.",url:"https:/developer.layer.com/docs/websdk",code:0,status:503,httpStatus:503})})}catch(e){}delete e._requestCallbacks[t]})}},{key:"_timeoutRequest",value:function(e){try{s.warn("Websocket request timeout"),this._requestCallbacks[e].callback({success:!1,data:new a({id:"request_timeout",message:"The server is not responding. We know how much that sucks.",url:"https:/developer.layer.com/docs/websdk",code:0,status:408,httpStatus:408})})}catch(e){}delete this._requestCallbacks[e]}},{key:"_isOpen",value:function(){return this.socketManager._isOpen()}},{key:"destroy",value:function(){this.isDestroyed=!0,this._callbackCleanupId&&clearTimeout(this._callbackCleanupId),this._requestCallbacks=null}}]),e}();c.prototype._nextRequestId=1,c.prototype.client=null,c.prototype._requestCallbacks=null,c.prototype._callbackCleanupId=0,c.prototype.socketManager=null,e.exports=c},g5D4:function(e,t,n){"use strict";(function(t){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n("zi+W"),l=n("EvUg"),u=n("jPMo"),h=function(e){function n(e){i(this,n);var o=r(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));if(o.client=e.client,o.state={id:o.id,records:[]},o.tempState={},o.storageKey="layer-telemetry-"+o.client.appId,t.localStorage)try{var s=localStorage[o.storageKey];s?o.state=JSON.parse(s):localStorage.setItem(o.storageKey,JSON.stringify(o.state))}catch(e){o.enabled=!1}else o.enabled=!1;return o.client.on("state-change",o.trackEvent,o),l.addConnectionListener(o.trackRestPerformance.bind(o)),o.setupReportingInterval(),o}return o(n,e),a(n,[{key:"trackEvent",value:function(e){if(this.enabled){var t=e.telemetryId+"-"+(e.id||"noid");if(e.started)this.tempState[t]=Date.now();else if(e.ended){var n=this.tempState[t];if(n){delete this.tempState[t];var i=Date.now()-n;this.writePerformance(e.telemetryId,i)}}}}},{key:"clearEvents",value:function(){var e=this,t=Date.now();Object.keys(this.tempState).forEach(function(n){e.tempState[n]+e.reportingInterval<t&&delete e.tempState[n]})}},{key:"trackRestPerformance",value:function(e){this.enabled&&e.request.telemetry&&this.writePerformance(e.request.telemetry.name,e.duration)}},{key:"writePerformance",value:function(e,t){var n=this.getCurrentStateObject().performance;n[e]||(n[e]={count:0,time:0,max:0}),n[e].count++,n[e].time+=t,t>n[e].max&&(n[e].max=t),this.writeState()}},{key:"writeUsage",value:function(e){var t=this.getCurrentStateObject().usage;t[e]||(t[e]=0),t[e]++,this.writeState()}},{key:"getEnvironment",value:function(){var e={platform:"web",locale:(navigator.language||"").replace(/-/g,"_"),layer_sdk_version:this.client.constructor.version,domain:location.hostname};return this.trigger("telemetry-environment",{environment:e}),e}},{key:"getDevice",value:function(){return{user_agent:navigator.userAgent,screen:{width:void 0===("undefined"==typeof screen?"undefined":s(screen))?0:screen.width,height:void 0===("undefined"==typeof screen?"undefined":s(screen))?0:screen.height},window:{width:window.innerWidth,height:window.innerHeight}}}},{key:"getCurrentStateObject",value:function(e){var t=new Date;t.setUTCHours(0,0,0,0);var n=new Date(t),i=Date.now();if(this.reportingInterval<864e5)for(;n.getTime()<i;)n.setMilliseconds(n.getMilliseconds()+this.reportingInterval);var r=n.toISOString(),o=new Date(n);o.setMilliseconds(o.getMilliseconds()+this.reportingInterval);var s=this.state.records.filter(function(e){return e.period.start===r})[0];return s||e||(s={period:{start:r,end:o.toISOString()},environment:this.getEnvironment(),device:this.getDevice(),usage:{},performance:{},errors:{}},this.state.records.push(s)),s}},{key:"writeState",value:function(){var e=this;this.enabled&&!this._writeTimeoutId&&(this._writeTimeoutId=setTimeout(function(){localStorage.setItem(e.storageKey,JSON.stringify(e.state)),e._writeTimeoutId=0},1e3))}},{key:"convertRecord",value:function(e){var t={period:e.period,device:e.device,environment:e.environment,usage:e.usage,performance:{}};return Object.keys(e.performance).forEach(function(n){var i=e.performance[n];t.performance[n]={max:Math.round(i.max),count:i.count,mean:Math.round(i.time/i.count)}}),t}},{key:"sendData",value:function(){var e=this,t=this.getCurrentStateObject(!0),n=this.state.records.filter(function(e){return e!==t});n.length&&l({sync:!1,method:"POST",url:this.telemetryUrl,headers:{"content-type":"application/json"},data:{id:u.uuid(this.state.id),layer_app_id:this.client.appId,records:n.map(function(t){return e.convertRecord(t)})}},function(t){t.success&&(e.state.records=e.state.records.filter(function(e){return-1===n.indexOf(e)}),e.writeState())}),this.clearEvents()}},{key:"setupReportingInterval",value:function(){this.enabled&&(this.sendData(),this._intervalId=setInterval(this.sendData.bind(this),this.reportingInterval))}},{key:"__updateEnabled",value:function(){this._intervalId&&(clearInterval(this._intervalId),this._intervalId=0),this.enabled&&this.setupReportingInterval()}}]),n}(c);h.prototype.telemetryUrl="https://telemetry.layer.com",h.prototype._intervalId=0,h.prototype.reportingInterval=36e5,h.prototype._writeTimeoutId=0,h.prototype.storageKey="",h.prototype.state=null,h.prototype.tempState=null,h.prototype.enabled=!0,h.prototype.client=null,h.prefixUUID="layer:///telemetry/",h._supportedEvents=c._supportedEvents.concat(["telemetry-environment"]),c.initClass.apply(h,[h,"TelemetryMonitor"]),e.exports=h}).call(t,n("DuR2"))},iZkC:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n("zi+W"),c=n("4wNg"),l=n("dGzY"),u=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),s(t,[{key:"_fixPredicate",value:function(e){return c.prototype._fixPredicate.apply(this,[e])}},{key:"_fetchData",value:function(e){var t=this;this.client.dbManager.loadAnnouncements(this._nextDBFromId,e,function(e){e.length&&t._appendResults({data:e},!0)});var n="announcements?page_size="+e+(this._nextServerFromId?"&from_id="+this._nextServerFromId:"");n!==this._firingRequest&&(this.isFiring=!0,this._firingRequest=n,this.client.xhr({telemetry:{name:"announcement_query_time"},url:n,method:"GET",sync:!1},function(i){return t._processRunResults(i,n,e)}))}}]),t}(l);u._supportedEvents=[].concat(l._supportedEvents),u.MaxPageSize=100,u.prototype.model=c.Announcement,a.initClass.apply(u,[u,"AnnouncementsQuery"]),e.exports=u},iqth:function(e,t,n){"use strict";var i=n("bD8U"),r=n("pLky").dictionary,o=(n("jPMo"),n("jTMd")),s=o.WebsocketSyncEvent;e.exports={events:["identities:loaded","identities:loaded-error","identities:change","identities:add","identities:remove","identities:unfollow"],lifecycle:{constructor:function(e){this._models.identities={},this._loadPresenceIds=[]},cleanup:function(){var e=this;Object.keys(this._models.identities).forEach(function(t){var n=e._models.identities[t];n&&!n.isDestroyed&&n.destroy()}),this._models.identities=null},reset:function(){this._models.identities={}}},methods:{getIdentity:function(e,t){if("string"!=typeof e)throw new Error(r.idParamRequired);return i.isValidId(e)||(e=i.prefixUUID+encodeURIComponent(e)),this._models.identities[e]?this._models.identities[e]:t?i.load(e,this):null},_addIdentity:function(e){var t=this,n=e.id;n&&!this._models.identities[n]&&(this._models.identities[n]=e,this._triggerAsync("identities:add",{identities:[e]}),e.id&&null===e._presence.status&&!e.sessionOwner&&(this._loadPresenceIds.push(n),1===this._loadPresenceIds.length&&setTimeout(function(){t.isDestroyed||t._loadPresence()},150)))},_removeIdentity:function(e){e.off(null,null,this);var t=e.id;this._models.identities[t]&&(delete this._models.identities[t],this._triggerAsync("identities:remove",{identities:[e]}))},followIdentity:function(e){i.isValidId(e)||(e=i.prefixUUID+encodeURIComponent(e));var t=this.getIdentity(e);return t||(t=new i({id:e,clientId:this.appId,userId:e.substring(20)})),t.follow(),t},unfollowIdentity:function(e){i.isValidId(e)||(e=i.prefixUUID+encodeURIComponent(e));var t=this.getIdentity(e);return t||(t=new i({id:e,clientId:this.appId,userId:e.substring(20)})),t.unfollow(),t},_loadPresence:function(){var e=this._loadPresenceIds;this._loadPresenceIds=[],this.syncManager.request(new s({data:{method:"Presence.sync",data:{ids:e}},returnChangesArray:!0,operation:"READ",target:null,depends:[]}))}}}},jPMo:function(e,t,n){"use strict";(function(e){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n("pqqx");t.atob="undefined"==typeof atob?e.getNativeSupport("atob"):atob.bind(window),t.btoa="undefined"==typeof btoa?e.getNativeSupport("btoa"):btoa.bind(window);var o="undefined"==typeof FileReader?e.getNativeSupport("FileReader"):FileReader;t.generateUUID=r.v4,t.typeFromID=function(e){var t=e.match(/([^\/]*)(\/[^\/]*)$/);return t?t[1]:""},t.uuid=function(e){return(e||"").replace(/^.*\//,"")},t.isEmpty=function(e){return"[object Object]"===Object.prototype.toString.apply(e)&&0===Object.keys(e).length},t.sortBy=function(e,t,n){return n=n?-1:1,e.sort(function(e,i){var r=t(e),o=t(i);return void 0===r&&void 0===o?0:void 0===r&&void 0!==o?1:void 0!==r&&void 0===o?-1:r>o?1*n:r<o?-1*n:0})},t.clone=function(e){return JSON.parse(JSON.stringify(e))},t.strictEncodeURI=function(e){return encodeURIComponent(e).replace(/[!~'()]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})},t.decode=function(e){var n=new RegExp("_","g"),i=new RegExp("-","g"),r=e.replace(i,"+").replace(n,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("Illegal base64url string!")}return t.atob(r)},t.getExponentialBackoffSeconds=function(e,t){var n=Math.pow(2,t)/10,i=Math.random();return n>=e&&(n=e),t<2?i/=4:t<6?i/=2:i*=.5*n,n+i},t.isBlob=function(e){return"undefined"!=typeof Blob&&e instanceof Blob},t.blobToBase64=function(e,t){var n=new o;n.readAsDataURL(e),n.onloadend=function(){return t(n.result.replace(/^.*?,/,""))}},t.base64ToBlob=function(e,n){try{var i=t.atob(e),r=[],o=void 0;for(o=0;o<i.length;o+=512){var s=void 0,a=i.slice(o,o+512),c=new Array(a.length);for(s=0;s<a.length;s++)c[s]=a.charCodeAt(s);var l=new Uint8Array(c);r.push(l)}return new Blob(r,{type:n})}catch(e){}return null},t.utoa=function(e){return t.btoa(unescape(encodeURIComponent(e)))},t.atou=function(e){return decodeURIComponent(escape(t.atob(e)))},t.fetchTextFromFile=function(e,t){if("string"==typeof e)return t(e);var n=new o;n.addEventListener("loadend",function(){t(n.result)}),n.readAsText(e)},t.defer=n("Er7U"),t.layerParse=n("aAY6"),t.doesObjectMatch=function(e,n){if(!e&&n||e&&!n)return!1;var r=Object.keys(e).sort(),o=Object.keys(n).sort();if(r.length!==o.length)return!1;for(var s=0;s<r.length;s++){var a=r[s],c=o[s],l=e[a],u=n[c];if(a!==c)return!1;if(l&&"object"===(void 0===l?"undefined":i(l))){if(Array.isArray(l))throw new Error("Array comparison not handled yet");if(!t.doesObjectMatch(l,u))return!1}else if(l!==u)return!1}return!0},t.includes=function(e,t){return-1!==e.indexOf(t)},t.asciiInit=function(e){if(!e)return"Missing version";var t=e.split("-"),n=t[0]||"",i=t[1]||"";return n+=new Array(13-n.length).join(" "),i+=new Array(14-i.length).join(" "),"\n    /hNMMMMMMMMMMMMMMMMMMMms.\n  hMMy+/////////////////omMN-\n  MMN                    oMMo\n  MMN        Layer       oMMo\n  MMN       Web SDK      oMMo\n  MMM-                   oMMo\n  MMMy      v"+n+"oMMo\n  MMMMo     "+i+"oMMo\n  MMMMMy.                oMMo\n  MMMMMMNy:'             oMMo\n  NMMMMMMMMmy+:-.'      'yMM/\n  :dMMMMMMMMMMMMNNNNNNNNNMNs\n   -/+++++++++++++++++++:'"}}).call(t,n("DuR2"))},jTMd:function(e,t,n){"use strict";function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n("jPMo"),c=function(){function e(t){o(this,e);var n=void 0;for(n in t)n in this&&(this[n]=t[n]);this.depends||(this.depends=[]),this.id||(this.id="layer:///syncevents/"+a.generateUUID()),this.createdAt||(this.createdAt=Date.now())}return s(e,[{key:"destroy",value:function(){this.target=null,this.depends=null,this.callback=null,this.data=null}},{key:"_updateData",value:function(e){if(this.target){var t=e.getObject(this.target);t&&"POST"===this.operation&&t._getSendData&&(this.data=t._getSendData(this.data))}}},{key:"toObject",value:function(){return{data:this.data}}}]),e}();c.prototype.operation="",c.prototype.fromDB=!1,c.prototype.createdAt=0,Object.defineProperty(c.prototype,"isFiring",{enumerable:!0,set:function(e){this.__isFiring=e,e&&(this.__firedAt=Date.now())},get:function(){return Boolean(this.__isFiring&&Date.now()-this.__firedAt<c.FIRING_EXPIRATION)}}),Object.defineProperty(c.prototype,"_isValidating",{enumerable:!0,set:function(e){this.__isValidating=e,e&&(this.__validatedAt=Date.now())},get:function(){return Boolean(this.__isValidating&&Date.now()-this.__validatedAt<c.VALIDATION_EXPIRATION)}}),c.prototype.id="",c.prototype.success=null,c.prototype.callback=null,c.prototype.retryCount=0,c.prototype.target=null,c.prototype.depends=null,c.prototype.data=null,c.FIRING_EXPIRATION=15e3,c.VALIDATION_EXPIRATION=500;var l=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),s(t,[{key:"_getRequestData",value:function(e){return this._updateUrl(e),this._updateData(e),{url:this.url,method:this.method,headers:this.headers,data:this.data,telemetry:this.telemetry}}},{key:"_updateUrl",value:function(e){if(this.target){var t=e.getObject(this.target);t&&!this.url.match(/^https?:\/\//)&&(this.url=t._getUrl(this.url))}}},{key:"toObject",value:function(){return{data:this.data,url:this.url,method:this.method}}},{key:"_getCreateId",value:function(){return"POST"===this.operation&&this.data?this.data.id:""}}]),t}(c);l.prototype.timeout=15e3,l.prototype.url="",l.prototype.returnToOnlineCount=0,l.prototype.headers=null,l.prototype.method="GET",l.prototype.telemetry=null;var u=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),s(t,[{key:"_getRequestData",value:function(e){return this._updateData(e),this.data}},{key:"toObject",value:function(){return this.data}},{key:"_getCreateId",value:function(){return"POST"===this.operation&&this.data.data?this.data.data.id:""}}]),t}(c);u.prototype.returnChangesArray=!1,e.exports={SyncEvent:c,XHRSyncEvent:l,WebsocketSyncEvent:u}},jkNz:function(e,t,n){"use strict";(function(t){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},c=n("zi+W"),l=n("EvUg"),u=n("P+Qc"),h=n("jPMo"),d=n("kesd"),p=d.ACCEPT,f=function(e){function n(e){i(this,n);var o=r(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));if(l.addConnectionListener(function(e){return o._connectionListener(e)}),o.socketManager.on("message",function(){return o._connectionListener({status:"connection:success"})},o),"undefined"!=typeof window&&window.addEventListener)window.addEventListener("online",o._handleOnlineEvent.bind(o)),window.addEventListener("offline",o._handleOnlineEvent.bind(o));else{var s=t.getNativeSupport("OnlineEvents");s&&s.addEventListener("change",o._handleOnlineEvent.bind(o))}return o}return o(n,e),s(n,[{key:"start",value:function(){u.info("OnlineStateManager: start"),this.isClientReady=!0,this.isOnline=!0,this.checkOnlineStatus()}},{key:"stop",value:function(){u.info("OnlineStateManager: stop"),this.isClientReady=!1,this._clearCheck(),this._changeToOffline()}},{key:"_scheduleNextOnlineCheck",value:function(){if(!this.isDestroyed&&this.isClientReady&&!this.isOnline){this._clearCheck();var e=Math.min(10,this.offlineCounter+3);this.offlineCounter++;var t=h.getExponentialBackoffSeconds(this.maxOfflineWait,e);u.info("OnlineStateManager: Scheduled checkOnlineStatus "+t+" seconds"),this.onlineCheckId=setTimeout(this.checkOnlineStatus.bind(this),Math.floor(1e3*t))}}},{key:"_clearCheck",value:function(){this.onlineCheckId&&(clearTimeout(this.onlineCheckId),this.onlineCheckId=0)}},{key:"_handleOnlineEvent",value:function(e){this.offlineCounter=0,this.checkOnlineStatus()}},{key:"_onlineExpiring",value:function(){var e=this;u.info("OnlineStateManager: Online State Expiring; pinging to verify"),this._isOnlineExpiring=!0,this.checkOnlineStatus(function(t){!t&&e._isOnlineExpiring&&e._onlineExpired(),e._isOnlineExpiring=!1})}},{key:"_onlineExpired",value:function(){u.info("OnlineStateManager: Online State Expired"),this._clearCheck(),this._changeToOffline(),this._scheduleNextOnlineCheck()}},{key:"checkOnlineStatus",value:function(e){if(!this.isDestroyed){this._clearCheck();var t=this.socketManager.client;u.info("OnlineStateManager: Firing XHR for online check"),this._lastCheckOnlineStatus=new Date,l({url:t.url+"/ping?client="+t.constructor.version,method:"HEAD",headers:{accept:p}},function(t){var n=t.status;e&&e(408!==n)})}}},{key:"_changeToOffline",value:function(){this.isOnline&&(u.info("OnlineStateManager: Connection lost"),this.isOnline=!1,this.trigger("disconnected"))}},{key:"_connectionListener",value:function(e){if("connection:success"===e.status){this._isOnlineExpiring=!1;var t=this.lastMessageTime;this.lastMessageTime=new Date,this.isOnline||(this.isOnline=!0,this.offlineCounter=0,this.trigger("connected",{offlineDuration:t?Date.now()-t:0}),void 0===this.connectedCounter&&(this.connectedCounter=0),this.connectedCounter++,u.info("OnlineStateManager: Connected restored")),this._clearCheck(),this.onlineCheckId=setTimeout(this._onlineExpiring.bind(this),this.pingFrequency)}else this.isOnline?this._onlineExpiring():this._scheduleNextOnlineCheck()}},{key:"destroy",value:function(){this._clearCheck(),this.socketManager=null,a(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"destroy",this).call(this)}}]),n}(c);f.prototype.isClientReady=!1,f.prototype.socketManager=null,f.prototype.offlineCounter=0,f.prototype.maxOfflineWait=60,f.prototype.minBackoffWait=100,f.prototype.lastMessageTime=null,f.prototype._lastCheckOnlineStatus=null,f.prototype.isOnline=!1,f.prototype.onlineCheckId=0,f.prototype._isOnlineExpiring=!1,f.prototype.pingFrequency=1e5,f._supportedEvents=["connected","disconnected"].concat(c._supportedEvents),c.initClass.apply(f,[f,"OnlineStateManager"]),e.exports=f}).call(t,n("DuR2"))},kAR7:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=window.interfaces.Virtual,a=function(e){function t(){return i(this,t),r(this,e.apply(this,arguments))}return o(t,e),t.prototype.render=function(){return s.createElement("div",{className:"_loader"},s.createElement("div",{className:"_inner"}))},t}(s.PureComponent);t.a=a},kesd:function(e,t,n){"use strict";e.exports={SYNC_STATE:{NEW:"NEW",SAVING:"SAVING",SYNCING:"SYNCING",SYNCED:"SYNCED",LOADING:"LOADING"},RECIPIENT_STATE:{NONE:"NONE",SOME:"SOME",ALL:"ALL"},RECEIPT_STATE:{SENT:"sent",DELIVERED:"delivered",READ:"read",PENDING:"pending"},LOCALSTORAGE_KEYS:{SESSIONDATA:"layer-session-data-"},ACCEPT:"application/vnd.layer+json; version=2.0",WEBSOCKET_PROTOCOL:"layer-2.0",LOG:{DEBUG:4,INFO:3,WARN:2,ERROR:1,NONE:0},DELETION_MODE:{ALL:"all_participants",MY_DEVICES:"my_devices"}}},l27T:function(e,t,n){"use strict";function i(e){var t=o.GET_LIVE_JOBS;return s(t,{headers:{"Cache-Control":"no-cache","Content-Type":"application/json",Accept:"application/json"},xhrFields:{withCredentials:!0}},"post")}t.a=i;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o={GET_LIVE_JOBS:tr_api_url+"/recruiterGnb/getChatJobs"},s=function(e,t,n){return new Promise(function(i,r){a[n](e,t,function(e){i(e)},function(e){r(e)})})},a={post:function(e,t,n,i){var o=r({},t,{success:n,error:i,type:"POST"});$.ajax(e,o)},get:function(e,t,n,i){$.ajax(e,r({},t,{success:n,error:i,type:"GET"}))}}},muYO:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=window.interfaces.Virtual,a=function(e){function t(){i(this,t);var n=r(this,e.call(this));return n._outsideHandler=null,n._dropdown=null,n.state={isShown:!1},n._outsideHandler=n._onOutsideClick.bind(n),n}return o(t,e),t.prototype.toggle=function(){var e=this;this.setState({isShown:!this.state.isShown},function(){e.state.isShown&&document.body.addEventListener("click",e._outsideHandler,!1)})},t.prototype._onOutsideClick=function(e){var t=this;this._dropdown&&this._dropdown.contains(e.target)||this.setState({isShown:!1},function(){document.body.removeEventListener("click",t._outsideHandler,!1)})},t.prototype.render=function(e){var t=this;return s.createElement("div",{className:"_dropdown "+e.cls},s.createElement("a",{ref:function(e){return t._dropdown=e},href:"javascript:void(0)",onClick:this.toggle.bind(this),className:"_trigger"},e.label&&!e.icon&&s.createElement("span",null,e.label),e.icon&&!e.label&&s.createElement("i",{className:"fontIcon "+e.iconCls})),this.state.isShown&&s.createElement("div",{className:"_panel "+e.panelCls,onClick:this.toggle.bind(this)},e.children))},t}(s.PureComponent);t.a=a},nFsS:function(e,t,n){"use strict";var i=(n("bD8U"),n("pLky").dictionary,n("jPMo")),r=n("kesd"),o=r.RECEIPT_STATE;n("jTMd").WebsocketSyncEvent,e.exports={lifecycle:{constructor:function(e){this.on("websocket:operation",this._handleWebsocketOperation,this)}},methods:{_handleWebsocketOperation:function(e){switch(e.data.method){case"Conversation.mark_all_read":return this._handleMarkAllReadOperation(e.data)}},_handleMarkAllReadOperation:function(e){var t=e.data.position,n=this.getObject(e.object.id);if(n){var r=e.data.identity.id,s=this.user.id===r;n._inMarkAllAsRead=!0,this.forEachMessage(function(e){if(e.conversationId===n.id&&e.position<=t)if(s)e.recipientStatus[r]=o.READ,e.isRead=!0;else if(e.recipientStatus[r]!==o.READ){var a=i.clone(e.recipientStatus);a[r]=o.READ,e.recipientStatus=a}}),n._inMarkAllAsRead=!1}}}}},oXlP:function(e,t,n){"use strict";var i=n("H8F6"),r=n("pLky").dictionary;e.exports={events:["conversations:add","conversations:remove","conversations:sent","conversations:sent-error","conversations:change","conversations:loaded","conversations:delete"],lifecycle:{constructor:function(e){this._models.conversations={}},cleanup:function(){var e=this;Object.keys(this._models.conversations).forEach(function(t){var n=e._models.conversations[t];n&&!n.isDestroyed&&n.destroy()}),this._models.conversations=null},reset:function(){this._models.conversations={}}},methods:{getConversation:function(e,t){if("string"!=typeof e)throw new Error(r.idParamRequired);return i.isValidId(e)||(e=i.prefixUUID+e),this._models.conversations[e]?this._models.conversations[e]:t?i.load(e,this):null},_addConversation:function(e){var t=e.id;this._models.conversations[t]||(this._models.conversations[t]=e,e.clientId!==this.appId&&(e.clientId=this.appId),this._triggerAsync("conversations:add",{conversations:[e]}))},_removeConversation:function(e){var t=this;e.off(null,null,this),this._models.conversations[e.id]&&(delete this._models.conversations[e.id],this._triggerAsync("conversations:remove",{conversations:[e]})),Object.keys(this._models.messages).forEach(function(n){t._models.messages[n].conversationId===e.id&&t._models.messages[n].destroy()})},_updateConversationId:function(e,t){var n=this;this._models.conversations[t]&&(this._models.conversations[e.id]=e,delete this._models.conversations[t],Object.keys(this._models.messages).filter(function(e){return n._models.messages[e].conversationId===t}).forEach(function(t){return n._models.messages[t].conversationId=e.id}))},findCachedConversation:function(e,t){for(var n=t?e.bind(t):e,i=Object.keys(this._models.conversations),r=i.length,o=0;o<r;o++){var s=i[o],a=this._models.conversations[s];if(n(a,o))return a}return null},createConversation:function(e){if(!this.isAuthenticated)throw new Error(r.clientMustBeReady);return"distinct"in e||(e.distinct=!0),e.client=this,i.create(e)}}}},ogE9:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},c=n("zTev"),l=n("zi+W"),u=n("kesd"),h=n("pLky"),d=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(i(this,t),e.fromServer?e.id=e.fromServer.id:e.id&&!e.userId&&(e.userId=e.id.replace(/^.*\//,"")),e.client&&(e.clientId=e.client.appId),!e.clientId)throw new Error(h.dictionary.clientMissing);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isInitializing=!0,e&&e.fromServer&&n._populateFromServer(e.fromServer),!n.url&&n.id?n.url=n.getClient().url+"/"+n.id.substring(9):n.url||(n.url=""),n.getClient()._addMembership(n),n.isInitializing=!1,n}return o(t,e),s(t,[{key:"destroy",value:function(){var e=this.getClient();e&&e._removeMembership(this),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_triggerAsync",value:function(e,n){this._clearObject(),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_triggerAsync",this).call(this,e,n)}},{key:"trigger",value:function(e,n){this._clearObject(),a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"trigger",this).call(this,e,n)}},{key:"_populateFromServer",value:function(e){var t=this,n=this.getClient();this._disableEvents=this.syncState===u.SYNC_STATE.NEW,this._setSynced(),this.userId=e.identity?e.identity.user_id||"":n.user.userId,this.channelId=e.channel.id,this.identity=e.identity?n._createObject(e.identity):n.user,this.identity.on("identities:change",function(e){t.trigger("members:change",{property:"identity"})},this),!this.url&&this.id&&(this.url=this.getClient().url+this.id.substring(8)),this._disableEvents=!1}},{key:"_updateValue",value:function(e,t){null!==t&&void 0!==t||(t=""),this[e]!==t&&(this.isInitializing||this._triggerAsync("members:change",{property:e,oldValue:this[e],newValue:t}),this[e]=t)}},{key:"__getUserId",value:function(){return this.identity?this.identity.userId:""}},{key:"__updateIdentity",value:function(e,t){t&&t.off(null,null,this)}}],[{key:"_createFromServer",value:function(e,n){return new t({client:n,fromServer:e,_fromDB:e._fromDB})}}]),t}(c);d.prototype.userId="",d.prototype.channelId="",d.prototype.role=null,d.prototype.identity="",d.inObjectIgnore=l.inObjectIgnore,d.bubbleEventParent="getClient",d._supportedEvents=["members:change","members:loaded","members:loaded-error"].concat(c._supportedEvents),d.eventPrefix="members",d.prefixUUID="/members/",l.initClass.apply(d,[d,"Membership"]),c.subclasses.push(d),e.exports=d},ozQU:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},l=n("zi+W"),u=n("zTev"),h=n("b6EZ"),d=n("pLky"),p=n("kesd"),f=n("jPMo"),y=n("bD8U"),g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(i(this,t),e.fromServer?e.id=e.fromServer.id:"isUnread"in e?(e.isRead=!e.isUnread&&!e.is_unread,delete e.isUnread):e.isRead=!0,e.client&&(e.clientId=e.client.appId),!e.clientId)throw new Error(d.dictionary.clientMissing);var n=e.parts;e.parts=null;var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));o.parts=n;var s=o.getClient();return o.isInitializing=!0,e&&e.fromServer?o._populateFromServer(e.fromServer):(s&&(o.sender=s.user),o.sentAt=new Date),o.parts||(o.parts=[]),o}return o(t,e),a(t,[{key:"__adjustParts",value:function(e){var t=this,n=void 0;return"string"==typeof e?n=[new h({body:e,mimeType:"text/plain",clientId:this.clientId})]:Array.isArray(e)?n=e.map(function(e){var n=void 0;return n=e instanceof h?e:new h(e),n.clientId=t.clientId,n}):e&&"object"===(void 0===e?"undefined":s(e))&&(e.clientId=this.clientId,n=[new h(e)]),this._setupPartIds(n),n&&n.forEach(function(e){e.off("messageparts:change",t._onMessagePartChange,t),e.on("messageparts:change",t._onMessagePartChange,t)}),n}},{key:"addPart",value:function(e){if(e){e.clientId=this.clientId,e instanceof h?this.parts.push(e):"object"===(void 0===e?"undefined":s(e))&&this.parts.push(new h(e));var t=this.parts.length-1,n=this.parts[t];n.off("messageparts:change",this._onMessagePartChange,this),n.on("messageparts:change",this._onMessagePartChange,this),e.id||(e.id=this.id+"/parts/"+t)}return this}},{key:"_onMessagePartChange",value:function(e){var t=this;e.changes.forEach(function(n){t._triggerAsync("messages:change",{property:"parts."+n.property,oldValue:n.oldValue,newValue:n.newValue,part:e.target})})}},{key:"presend",value:function(){var e=this,t=this.getClient();if(!t)throw new Error(d.dictionary.clientMissing);var n=this.getConversation(!1);if(!n)throw new Error(d.dictionary.conversationMissing);if(this.syncState!==p.SYNC_STATE.NEW)throw new Error(d.dictionary.alreadySent);return n._setupMessage(this),this._readAllBlobs(function(){t._addMessage(e)}),this}},{key:"send",value:function(e){var t=this,n=this.getClient();if(!n)throw new Error(d.dictionary.clientMissing);var i=this.getConversation(!0);if(!i)throw new Error(d.dictionary.conversationMissing);if(this.syncState!==p.SYNC_STATE.NEW)throw new Error(d.dictionary.alreadySent);if(i.isLoading)return i.once(i.constructor.eventPrefix+":loaded",function(){return t.send(e)}),i._setupMessage(this),this;if(!this.parts||!this.parts.length)throw new Error(d.dictionary.partsMissing);return this._setSyncing(),i.send(this),this._readAllBlobs(function(){n._addMessage(t),t.trigger("messages:sending");var i={parts:new Array(t.parts.length),id:t.id};e&&t.conversationId&&(i.notification=e),t._preparePartsForSending(i)}),this}},{key:"_readAllBlobs",value:function(e){var t=0,n=this.parts.filter(function(e){return f.isBlob(e.body)&&e.isTextualMimeType()});n.forEach(function(i){f.fetchTextFromFile(i.body,function(r){i.body=r,++t===n.length&&e()})}),n.length||e()}},{key:"_preparePartsForSending",value:function(e){var t=this,n=this.getClient(),i=0;this.parts.forEach(function(r,o){r.once("parts:send",function(n){e.parts[o]={mime_type:n.mime_type},n.content&&(e.parts[o].content=n.content),n.body&&(e.parts[o].body=n.body),n.encoding&&(e.parts[o].encoding=n.encoding),++i===t.parts.length&&t._send(e)},t),r._send(n)})}},{key:"_send",value:function(e){var t=this,n=this.getClient(),i=this.getConversation(!1);this.getClient()._triggerAsync("state-change",{started:!0,type:"send_"+f.typeFromID(this.id),telemetryId:"send_"+f.typeFromID(this.id)+"_time",id:this.id}),this.sentAt=new Date,n.sendSocketRequest({method:"POST",body:{method:"Message.create",object_id:i.id,data:e},sync:{depends:[this.conversationId,this.id],target:this.id}},function(e,n){return t._sendResult(e,n)})}},{key:"_getSendData",value:function(e){return e.object_id=this.conversationId,e}},{key:"_sendResult",value:function(e){var t=e.success,n=e.data;this.getClient()._triggerAsync("state-change",{ended:!0,type:"send_"+f.typeFromID(this.id),telemetryId:"send_"+f.typeFromID(this.id)+"_time",result:t,id:this.id}),this.isDestroyed||(t?(this._populateFromServer(n),this._triggerAsync("messages:sent"),this._triggerAsync("messages:change",{property:"syncState",oldValue:p.SYNC_STATE.SAVING,newValue:p.SYNC_STATE.SYNCED})):(this.trigger("messages:sent-error",{error:n}),this.destroy()),this._setSynced())}},{key:"on",value:function(e,n,i){if(("messages:loaded"===e||e&&"object"===(void 0===e?"undefined":s(e))&&e["messages:loaded"])&&!this.isLoading){var r="messages:loaded"===e?n:e["messages:loaded"];f.defer(function(){return r.apply(i)})}return c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).call(this,e,n,i),this}},{key:"destroy",value:function(){var e=this.getClient();e&&e._removeMessage(this),this.parts.forEach(function(e){return e.destroy()}),this.__parts=null,c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_setupPartIds",value:function(e){var t=this;e&&e.forEach(function(e,n){e.id||(e.id=t.id+"/parts/"+n)})}},{key:"_populateFromServer",value:function(e){var t=this;this._inPopulateFromServer=!0;var n=this.getClient();this.id=e.id,this.url=e.url;var i=this.position;this.position=e.position,this._setupPartIds(e.parts),this.parts=e.parts.map(function(e){var n=t.getPartById(e.id);return n?(n._populateFromServer(e),n):h._createFromServer(e)}),this.recipientStatus=e.recipient_status||{},this.isRead=!("is_unread"in e&&e.is_unread),this.sentAt=new Date(e.sent_at),this.receivedAt=e.received_at?new Date(e.received_at):void 0;var r=void 0;e.sender.id&&(r=n.getIdentity(e.sender.id)),r||(r=y._createFromServer(e.sender,n)),this.sender=r,this._setSynced(),i&&i!==this.position&&this._triggerAsync("messages:change",{oldValue:i,newValue:this.position,property:"position"}),this._inPopulateFromServer=!1}},{key:"getPartById",value:function(e){return(this.parts?this.parts.filter(function(t){return t.id===e})[0]:null)||null}},{key:"_handlePatchEvent",value:function(e,t,n){this._inLayerParser=!1,0===n[0].indexOf("recipient_status")&&this.__updateRecipientStatus(this.recipientStatus,t),this._inLayerParser=!0}},{key:"_getUrl",value:function(e){return this.url+(e||"")}},{key:"_setupSyncObject",value:function(e){return!1!==e&&(e=c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_setupSyncObject",this).call(this,e),e.depends?-1===e.depends.indexOf(this.id)&&e.depends.push(this.conversationId):e.depends=[this.conversationId]),e}},{key:"getText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:". ",t=this.parts.filter(function(e){return"text/plain"===e.mimeType}).map(function(e){return e.body});return t=t.filter(function(e){return e}),t.join(e)}},{key:"toObject",value:function(){return this._toObject||(this._toObject=c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toObject",this).call(this)),this._toObject}},{key:"_triggerAsync",value:function(e,n){this._clearObject(),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_triggerAsync",this).call(this,e,n)}},{key:"trigger",value:function(e,n){this._clearObject(),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"trigger",this).call(this,e,n)}}],[{key:"_loadResourceForPatch",value:function(e){return!1}}]),t}(u);g.prototype.clientId="",g.prototype.conversationId="",g.prototype.parts=null,g.prototype.sentAt=null,g.prototype.receivedAt=null,g.prototype.sender=null,g.prototype.position=0,g.prototype._notify=!1,Object.defineProperty(g.prototype,"isUnread",{enumerable:!0,get:function(){return!this.isRead}}),g.prototype._toObject=null,g.prototype._inPopulateFromServer=!1,g.eventPrefix="messages",g.eventPrefix="messages",g.prefixUUID="layer:///messages/",g.inObjectIgnore=u.inObjectIgnore,g.bubbleEventParent="getClient",g.imageTypes=["image/gif","image/png","image/jpeg","image/jpg"],g._supportedEvents=["messages:loaded","messages:loaded-error","messages:delete","messages:sending","messages:sent","messages:sent-error","messages:change"].concat(u._supportedEvents),l.initClass.apply(g,[g,"Message"]),u.subclasses.push(g),e.exports=g},pLky:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n("P+Qc"),a=function(){function e(t){var n=this;i(this,e),t instanceof e?t={errType:t.errType,httpStatus:t.httpStatus,message:t.message,code:t.code,url:t.url,data:t.data}:t&&"object"===(void 0===t?"undefined":r(t))?t.errType=t.id:t={message:t},Object.keys(t).forEach(function(e){return n[e]=t[e]}),this.data||(this.data={})}return o(e,[{key:"getNonce",value:function(){return this.data&&this.data.nonce?this.data.nonce:""}},{key:"toString",value:function(){return this.code+" ("+this.id+"): "+this.message+"; (see "+this.url+")"}},{key:"log",value:function(){s.error("Layer-Error: "+this.toString())}}]),e}();a.prototype.errType="",a.prototype.code=0,a.prototype.url="",a.prototype.message="",a.prototype.httpStatus=0,a.prototype.request=null,a.prototype.data=null,a.prototype.xhr=null,a.dictionary={appIdMissing:"Property missing: appId is required",identityTokenMissing:"Identity Token missing: answerAuthenticationChallenge requires an identity token",sessionTokenMissing:"Session Token missing: _authComplete requires a {session_token: value} input",clientMissing:"Property missing: client is required",conversationMissing:"Property missing: conversation is required",partsMissing:"Property missing: parts is required",moreParticipantsRequired:"Conversation needs participants other than the current user",isDestroyed:"Object is destroyed",urlRequired:"Object needs a url property",invalidUrl:"URL is invalid",invalidId:"Identifier is invalid",idParamRequired:"The ID Parameter is required",wrongClass:"Parameter class error; should be: ",inProgress:"Operation already in progress",cantChangeIfConnected:"You can not change value after connecting",cantChangeUserId:"You can not change the userId property",alreadySent:"Already sent or sending",contentRequired:"MessagePart requires rich content for this call",alreadyDestroyed:"This object has already been destroyed",deletionModeUnsupported:"Call to deletion was made with an unsupported deletion mode",sessionAndUserRequired:"connectWithSession requires both a userId and a sessionToken",invalidUserIdChange:"The prn field in the Identity Token must match the requested UserID",predicateNotSupported:"The predicate is not supported for this value of model",invalidPredicate:"The predicate does not match the expected format",appIdImmutable:"The appId property cannot be changed",clientMustBeReady:'The Client must have triggered its "ready" event before you can call this',modelImmutable:"The model property cannot be changed",valueNotSupported:"The value provided is not a supported value",permissionDenied:"Operation not allowed on that object"},e.exports=a},"pnr+":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=window.interfaces.Virtual,a=function(e){function t(){return i(this,t),r(this,e.apply(this,arguments))}return o(t,e),t.prototype.componentDidMount=function(){var e=this;setTimeout(function(){e.props.hideAttachmentError()},5e4)},t.prototype.render=function(){return s.createElement("div",{class:"attachment-error"},s.createElement("div",{class:"attachment-error-icon"},s.createElement("i",{className:"fontIcon wf-chat-cross",onClick:this.props.hideAttachmentError})),s.createElement("div",{className:"attachment-error-text"},this.props.attachmentError.attachementErrorText))},t}(s.PureComponent);t.a=a},pop0:function(e,t,n){"use strict";(function(t){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n("EvUg"),l=n("zi+W"),u=n("IIOl"),h=n("6hGd"),d=n("fYnd"),p=n("pLky"),f=n("jkNz"),y=n("UD6+"),g=n("2Jz9"),v=n("bD8U"),_=n("jTMd"),m=_.XHRSyncEvent,b=_.WebsocketSyncEvent,E=n("kesd"),w=E.ACCEPT,k=E.LOCALSTORAGE_KEYS,O=n("P+Qc"),C=n("jPMo"),S=function(e){function n(e){if(i(this,n),!e.appId)throw new Error(p.dictionary.appIdMissing);return r(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}return o(n,e),a(n,[{key:"_initComponents",value:function(){var e=this;this.socketManager=new u({client:this}),this.socketManager.on("connecting",function(t){return e.trigger("websocket:connecting")}),this.socketManager.on("disconnecting",function(t){return e.trigger("websocket:disconnecting",{from:t.from,why:t.why})}),this.socketManager.on("replaying-events",function(t){return e.trigger("websocket:replaying-events",{from:t.from,why:t.why})}),this.socketManager.on("schedule-reconnect",function(t){return e.trigger("websocket:schedule-reconnect",{from:t.from,why:t.why})}),this.socketManager.on("scheduling-reconnect",function(t){return e.trigger("websocket:scheduling-reconnect",{counter:t.counter,delay:t.delay})}),this.socketManager.on("ignore-skipped-counter",function(t){return e.trigger("websocket:ignore-skipped-counter",{from:t.from,why:t.why})}),this.socketChangeManager=new h({client:this,socketManager:this.socketManager}),this.socketRequestManager=new d({client:this,socketManager:this.socketManager}),this.onlineManager=new f({socketManager:this.socketManager}),this.onlineManager.on("connected",this._handleOnlineChange,this),this.onlineManager.on("disconnected",this._handleOnlineChange,this),this.syncManager=new y({onlineManager:this.onlineManager,socketManager:this.socketManager,requestManager:this.socketRequestManager,client:this})}},{key:"_destroyComponents",value:function(){this.syncManager.destroy(),this.onlineManager.destroy(),this.socketManager.destroy(),this.socketChangeManager.destroy(),this.socketRequestManager.destroy(),this.dbManager&&this.dbManager.destroy()}},{key:"_isPersistedSessionsDisabled",value:function(){return!t.localStorage||this.persistenceFeatures&&!this.persistenceFeatures.sessionToken}},{key:"_restoreLastSession",value:function(){if(!this._isPersistedSessionsDisabled())try{var e=t.localStorage[k.SESSIONDATA+this.appId];if(!e)return;var n=JSON.parse(e);n.expires<Date.now()?t.localStorage.removeItem(k.SESSIONDATA+this.appId):this.sessionToken=n.sessionToken}catch(e){}}},{key:"_restoreLastUser",value:function(){try{var e=t.localStorage[k.SESSIONDATA+this.appId];if(!e)return null;var n=JSON.parse(e).user;return new v({clientId:this.appId,sessionOwner:!0,fromServer:n})}catch(e){return null}}},{key:"_hasUserIdChanged",value:function(e){try{var n=t.localStorage[k.SESSIONDATA+this.appId];return!n||JSON.parse(n).user.user_id!==e}catch(e){return!0}}},{key:"_connect",value:function(){var e=this;this._triggerAsync("state-change",{started:!0,type:"authentication",telemetryId:"auth_time",id:null}),this.xhr({url:"/nonces",method:"POST",sync:!1},function(t){return e._connectionResponse(t)})}},{key:"connect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.isAuthenticated)return this;var t=void 0;return this.isConnected=!1,this._lastChallengeTime=0,this._wantsToBeAuthenticated=!0,this._wantsToBeConnected=!0,this.user=null,this.onlineManager.start(),this.isTrustedDevice&&e&&!this._isPersistedSessionsDisabled()&&!this._hasUserIdChanged(e)||this._clearStoredData(),this.isTrustedDevice&&e&&(this._restoreLastSession(e),(t=this._restoreLastUser())&&(this.user=t)),this.user||(this.user=new v({userId:e,sessionOwner:!0,clientId:this.appId,id:e?v.prefixUUID+encodeURIComponent(e):""})),this.sessionToken&&this.user.userId?this._sessionTokenRestored():this._connect(),this}},{key:"connectWithSession",value:function(e,t){var n=this;if(this.isAuthenticated)return this;var i=void 0;if(this.isConnected=!1,this.user=null,this._lastChallengeTime=0,this._wantsToBeAuthenticated=!0,this._wantsToBeConnected=!0,!e||!t)throw new Error(p.dictionary.sessionAndUserRequired);return(!this.isTrustedDevice||this._isPersistedSessionsDisabled()||this._hasUserIdChanged(e))&&this._clearStoredData(),this.isTrustedDevice&&(i=this._restoreLastUser())&&(this.user=i),this.onlineManager.start(),this.user||(this.user=new v({userId:e,sessionOwner:!0,clientId:this.appId})),this.isConnected=!0,setTimeout(function(){n.isAuthenticated||n._authComplete({session_token:t},!1)},1),this}},{key:"reconnect",value:function(){if(!this.isAuthenticated)return void(this.sessionToken&&this.user&&this.user.userId?this.connectWithSession(this.user.userId,this.sessionToken):this.connect());this._wantsToBeConnected=!0,this._clientReady(),this.onlineManager.start(),this.socketManager.connect()}},{key:"disconnect",value:function(){this.isReady=!1,this._wantsToBeConnected=!1,this.socketManager.close(),this.onlineManager.stop()}},{key:"_connectionResponse",value:function(e){e.success?this._connectionComplete(e.data):this._connectionError(e.data)}},{key:"_connectionComplete",value:function(e){this.isConnected=!0,this.trigger("connected"),this._authenticate(e.nonce)}},{key:"_connectionError",value:function(e){this.trigger("connected-error",{error:e})}},{key:"_authenticate",value:function(e){this._lastChallengeTime=Date.now(),e&&this.trigger("challenge",{nonce:e,callback:this.answerAuthenticationChallenge.bind(this)})}},{key:"answerAuthenticationChallenge",value:function(e){var t=this;if(!e)throw new Error(p.dictionary.identityTokenMissing);var n=C.decode(e.split(".")[1]),i=JSON.parse(n);if(!i.prn)throw new Error("Your identity token prn (user id) is empty");if(this.user.userId&&this.user.userId!==i.prn)throw new Error(p.dictionary.invalidUserIdChange);this.user._setUserId(i.prn),i.display_name&&(this.user.displayName=i.display_name),i.avatar_url&&(this.user.avatarUrl=i.avatar_url),this.xhr({url:"/sessions",method:"POST",sync:!1,data:{identity_token:e,app_id:this.appId}},function(n){return t._authResponse(n,e)})}},{key:"_authResponse",value:function(e,t){this._triggerAsync("state-change",{ended:!0,type:"authentication",telemetryId:"auth_time",result:e.success}),e.success?this._authComplete(e.data,!1):this._authError(e.data,t)}},{key:"_authComplete",value:function(e,n){if(!e||!e.session_token)throw new Error(p.dictionary.sessionTokenMissing);if(this.sessionToken=e.session_token,!this._isPersistedSessionsDisabled()&&!n)try{t.localStorage[k.SESSIONDATA+this.appId]=JSON.stringify({sessionToken:this.sessionToken||"",user:g.prototype._getIdentityData([this.user],!0)[0],expires:Date.now()+2592e6})}catch(e){}this._clientAuthenticated()}},{key:"_authError",value:function(e,t){this.trigger("authenticated-error",{error:e})}},{key:"_sessionTokenRestored",value:function(){this.isConnected=!0,this.trigger("connected"),this._clientAuthenticated()}},{key:"_clientAuthenticated",value:function(){var e=this;if(this.isAuthenticated=!0,this.trigger("authenticated"),this.isTrustedDevice||(this.isPersistenceEnabled=!1),!this.persistenceFeatures||!this.isPersistenceEnabled){var t=void 0;t=this.persistenceFeatures&&"sessionToken"in this.persistenceFeatures?Boolean(this.persistenceFeatures.sessionToken):this.isTrustedDevice,this.persistenceFeatures={conversations:this.isPersistenceEnabled,channels:this.isPersistenceEnabled,messages:this.isPersistenceEnabled,identities:this.isPersistenceEnabled,syncQueue:this.isPersistenceEnabled,sessionToken:t}}this.dbManager||(this.dbManager=new g({client:this,tables:this.persistenceFeatures,enabled:this.isPersistenceEnabled})),this.isPersistenceEnabled?this.dbManager.onOpen(function(){return e._loadUser()}):this._loadUser()}},{key:"_loadUser",value:function(){var e=this;this.user.isFullIdentity?this._clientReady():(this.user._load(),this.user.once("identities:loaded",function(){e._isPersistedSessionsDisabled()||(e._writeSessionOwner(),e.user.on("identities:change",e._writeSessionOwner,e)),e._clientReady()}).once("identities:loaded-error",function(){e.user.displayName||(e.user.displayName=e.defaultOwnerDisplayName),e._clientReady()}))}},{key:"_writeSessionOwner",value:function(){try{var e=JSON.parse(t.localStorage[k.SESSIONDATA+this.appId]);e.user=g.prototype._getIdentityData([this.user])[0],t.localStorage[k.SESSIONDATA+this.appId]=JSON.stringify(e)}catch(e){}}},{key:"_clientReady",value:function(){this.isReady||(this._wantsToBeConnected=!0,this._wantsToBeAuthenticated=!0,this.isReady=!0,this.trigger("ready"))}},{key:"logout",value:function(e){this._wantsToBeAuthenticated=!1,this._wantsToBeConnected=!0;var t=1,n=0;return this.isAuthenticated&&(t++,this.xhr({method:"DELETE",url:"/sessions/"+escape(this.sessionToken),sync:!1},function(){++n===t&&e&&e()})),this._clearStoredData(function(){++n===t&&e&&e()}),this._resetSession(),this}},{key:"_clearStoredData",value:function(e){t.localStorage&&localStorage.removeItem(k.SESSIONDATA+this.appId),this.dbManager?this.dbManager.deleteTables(e):e&&e()}},{key:"_resetSession",value:function(){this.isReady=!1,this.isConnected=!1,this.isAuthenticated=!1,this.sessionToken&&(this.sessionToken="",t.localStorage&&localStorage.removeItem(k.SESSIONDATA+this.appId)),this.trigger("deauthenticated"),this.onlineManager.stop()}},{key:"registerIOSPushToken",value:function(e,t){this.xhr({url:"push_tokens",method:"POST",sync:!1,data:{token:e.token,type:"apns",device_id:e.deviceId,ios_version:e.iosVersion,apns_bundle_id:e.bundleId}},function(e){return t(e.data)})}},{key:"registerAndroidPushToken",value:function(e,t){this.xhr({url:"push_tokens",method:"POST",sync:!1,data:{token:e.token,type:"gcm",device_id:e.deviceId,gcm_sender_id:e.senderId}},function(e){return t(e.data)})}},{key:"unregisterPushToken",value:function(e,t){this.xhr({url:"push_tokens/"+e,method:"DELETE"},function(e){return t(e.data)})}},{key:"__adjustAppId",value:function(){if(this.isConnected)throw new Error(p.dictionary.cantChangeIfConnected)}},{key:"__adjustUser",value:function(e){if(this.isConnected)throw new Error(p.dictionary.cantChangeIfConnected)}},{key:"_addIdentity",value:function(e){}},{key:"_removeIdentity",value:function(e){}},{key:"sendSocketRequest",value:function(e,t){var n=Boolean(e.isChangesArray);if(this._wantsToBeAuthenticated&&!this.isAuthenticated&&this._connect(),e.sync){var i=e.sync.target,r=e.sync.depends;i&&!r&&(r=[i]),this.syncManager.request(new b({data:e.body,operation:e.method,returnChangesArray:n,target:i,depends:r,callback:t}))}else"function"==typeof e.data&&(e.data=e.data()),this.socketRequestManager.sendRequest({data:e,isChangesArray:n,callback:t})}},{key:"_handleOnlineChange",value:function(e){if(this._wantsToBeAuthenticated&&this._wantsToBeConnected){var t=e.offlineDuration,i="connected"===e.eventName,r={isOnline:i};i&&(r.reset=t>n.ResetAfterOfflineDuration,this.isAuthenticated||this._connect()),this.trigger("online",r)}}},{key:"xhr",value:function(e,t){return e.sync&&e.sync.target||(e.url=this._xhrFixRelativeUrls(e.url||"")),e.withCredentials=!0,e.method||(e.method="GET"),e.headers||(e.headers={}),this._xhrFixHeaders(e.headers),this._xhrFixAuth(e.headers),!1===e.sync?this._nonsyncXhr(e,t,0):this._syncXhr(e,t),this}},{key:"_syncXhr",value:function(e,t){var n=this;e.sync||(e.sync={}),this._wantsToBeAuthenticated&&!this.isAuthenticated&&this._connect();var i=function(e){n._xhrResult(e,t)},r=e.sync.target,o=e.sync.depends;r&&!o&&(o=[r]),this.syncManager.request(new m({url:e.url,data:e.data,telemetry:e.telemetry,method:e.method,operation:e.sync.operation||e.method,headers:e.headers,callback:i,target:r,depends:o}))}},{key:"_nonsyncXhr",value:function(e,t,n){var i=this;c(e,function(r){-1!==[502,503,504].indexOf(r.status)&&n<3?setTimeout(function(){return i._nonsyncXhr(e,t,n+1)},1e3):i._xhrResult(r,t)})}},{key:"_xhrFixAuth",value:function(e){this.sessionToken&&!e.Authorization&&(e.authorization='Layer session-token="'+this.sessionToken+'"')}},{key:"_xhrFixRelativeUrls",value:function(e){var t=e;return-1===e.indexOf("https://")&&-1===e.indexOf("http://")&&(t="/"===e[0]?this.url+e:this.url+"/"+e),t}},{key:"_xhrFixHeaders",value:function(e){Object.keys(e).forEach(function(t){t!==t.toLowerCase()&&(e[t.toLowerCase()]=e[t],delete e[t])}),e.accept||(e.accept=w),e["content-type"]||(e["content-type"]="application/json"),e["layer-xdk-version"]||(e["layer-xdk-version"]=this.constructor.version),e["client-id"]||(e["client-id"]=this._tabId)}},{key:"_xhrResult",value:function(e,i){this.isDestroyed||(e.success||(e.data&&"object"===s(e.data)&&this._generateError(e),401===e.status&&this._wantsToBeAuthenticated&&(this.isAuthenticated?(O.warn("SESSION EXPIRED!"),this.isAuthenticated=!1,this.isReady=!1,t.localStorage&&localStorage.removeItem(k.SESSIONDATA+this.appId),this.trigger("deauthenticated"),this._authenticate(e.data.getNonce())):this._lastChallengeTime>Date.now()+n.TimeBetweenReauths&&this._authenticate(e.data.getNonce()))),i&&i(e))}},{key:"_generateError",value:function(e){e.data=new p(e.data),e.data.httpStatus||(e.data.httpStatus=e.status),e.data.log()}}]),n}(l);S.prototype.isAuthenticated=!1,S.prototype.isConnected=!1,S.prototype.isReady=!1,S.prototype._wantsToBeAuthenticated=!1,S.prototype._wantsToBeConnected=!1,S.prototype.isPresenceEnabled=!0,S.prototype.appId="",S.prototype.user=null,S.prototype.sessionToken="",S.prototype._lastChallengeTime=0,S.prototype.url="https://api.layer.com",S.prototype.websocketUrl="wss://websockets.layer.com",S.prototype.socketManager=null,S.prototype.socketRequestManager=null,S.prototype.socketChangeManager=null,S.prototype.syncManager=null,S.prototype.onlineManager=null,S.prototype.isTrustedDevice=!1,S.prototype.isPersistenceEnabled=!1,S.prototype.persistenceFeatures=null,S.prototype.dbManager=null,S.prototype.defaultOwnerDisplayName="You",Object.defineProperty(S.prototype,"isOnline",{enumerable:!0,get:function(){return this.onlineManager&&this.onlineManager.isOnline}}),Object.defineProperty(S.prototype,"logLevel",{enumerable:!1,get:function(){return O.level},set:function(e){O.level=e}}),Object.defineProperty(S.prototype,"userId",{enumerable:!0,get:function(){return this.user?this.user.userId:""},set:function(){}}),S.ResetAfterOfflineDuration=108e6,S.TimeBetweenReauths=3e4,S._supportedEvents=["ready","connected","connected-error","authenticated","authenticated-error","deauthenticated","challenge","session-terminated","online","state-change","websocket:operation","websocket:connecting","websocket:disconnecting","websocket:replaying-events","websocket:scheduling-reconnect","websocket:schedule-reconnect","websocket:ignore-skipped-counter"].concat(l._supportedEvents),l.initClass.apply(S,[S,"ClientAuthenticator"]),e.exports=S}).call(t,n("DuR2"))},pqqx:function(e,t,n){function i(e,t,n){var i=t&&n||0,r=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){r<16&&(t[i+r++]=l[e])});r<16;)t[i+r++]=0;return t}function r(e,t){var n=t||0,i=c;return i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]}function o(e,t,n){var i=t&&n||0,o=t||[];e=e||{};var s=void 0!==e.clockseq?e.clockseq:p,a=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:y+1,l=a-f+(c-y)/1e4;if(l<0&&void 0===e.clockseq&&(s=s+1&16383),(l<0||a>f)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");f=a,y=c,p=s,a+=122192928e5;var u=(1e4*(268435455&a)+c)%4294967296;o[i++]=u>>>24&255,o[i++]=u>>>16&255,o[i++]=u>>>8&255,o[i++]=255&u;var h=a/4294967296*1e4&268435455;o[i++]=h>>>8&255,o[i++]=255&h,o[i++]=h>>>24&15|16,o[i++]=h>>>16&255,o[i++]=s>>>8|128,o[i++]=255&s;for(var g=e.node||d,v=0;v<6;v++)o[i+v]=g[v];return t||r(o)}function s(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var o=e.random||(e.rng||a)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;s++)t[i+s]=o[s];return t||r(o)}for(var a=n("59JX"),c=[],l={},u=0;u<256;u++)c[u]=(u+256).toString(16).substr(1),l[c[u]]=u;var h=a(),d=[1|h[0],h[1],h[2],h[3],h[4],h[5]],p=16383&(h[6]<<8|h[7]),f=0,y=0,g=s;g.v1=o,g.v4=s,g.parse=i,g.unparse=r,e.exports=g},sDhs:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},c=n("zi+W"),l=n("ozQU"),u=n("Z/oI"),h=n("pLky"),d=n("kesd"),p=n("jPMo"),f=function(e){function t(e){i(this,t),e.conversation&&(e.conversationId=e.conversation.id);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n._disableEvents=!0,e.fromServer?n.__updateRecipientStatus(n.recipientStatus):n.recipientStatus={},n._disableEvents=!1;var o=n.getClient();if(n.isInitializing=!1,e&&e.fromServer){o._addMessage(n);var s=n.recipientStatus[o.user.id];s&&s!==d.RECEIPT_STATE.READ&&s!==d.RECEIPT_STATE.DELIVERED&&p.defer(function(){return n._sendReceipt("delivery")})}return n}return o(t,e),s(t,[{key:"getConversation",value:function(e){return this.conversationId?u.get(this.clientId).getConversation(this.conversationId,e):null}},{key:"_loaded",value:function(e){this.conversationId=e.conversation.id,this.getClient()._addMessage(this)}},{key:"__getRecipientStatus",value:function(e){var t=this[e]||{},n=this.getClient();if(n){var i=n.user.id,r=this.getConversation(!1);r&&r.participants.forEach(function(e){t[e.id]||(t[e.id]=e.id===i?d.RECEIPT_STATE.READ:d.RECEIPT_STATE.PENDING)})}return t}},{key:"__updateRecipientStatus",value:function(e,t){var n=this.getConversation(!1),i=this.getClient();if(n&&!p.doesObjectMatch(e,t)){var r=i.user.id,o=this.sender.sessionOwner,s=e[r]===d.RECEIPT_STATE.READ;try{var a=n.participants.length-1;this.__isRead||!o&&!s||(this.__isRead=!0);var c=this._getReceiptStatus(e,r),l=c.readCount,u=c.deliveredCount;this._setReceiptStatus(l,u,a)}catch(e){}!this.isInitializing&&t&&(s&&t[r]!==d.RECEIPT_STATE.READ||o)&&this._triggerAsync("messages:change",{oldValue:t,newValue:e,property:"recipientStatus"})}}},{key:"_getReceiptStatus",value:function(e,t){var n=0,i=0;return Object.keys(e).filter(function(e){return e!==t}).forEach(function(t){e[t]===d.RECEIPT_STATE.READ?(n++,i++):e[t]===d.RECEIPT_STATE.DELIVERED&&i++}),{readCount:n,deliveredCount:i}}},{key:"_setReceiptStatus",value:function(e,t,n){this.readStatus=e===n?d.RECIPIENT_STATE.ALL:e>0?d.RECIPIENT_STATE.SOME:d.RECIPIENT_STATE.NONE,this.deliveryStatus=t===n?d.RECIPIENT_STATE.ALL:t>0?d.RECIPIENT_STATE.SOME:d.RECIPIENT_STATE.NONE}},{key:"__updateIsRead",value:function(e){if(e){this._inPopulateFromServer||this.getConversation()._inMarkAllAsRead||this._sendReceipt(d.RECEIPT_STATE.READ),this._triggerMessageRead();var t=this.getConversation(!1);t&&t.unreadCount--}}},{key:"_triggerMessageRead",value:function(){var e=this.isRead;this._triggerAsync("messages:change",{property:"isRead",oldValue:!e,newValue:e}),this._triggerAsync("messages:change",{property:"isUnread",oldValue:e,newValue:!e})}},{key:"sendReceipt",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.RECEIPT_STATE.READ;if(e===d.RECEIPT_STATE.READ){if(this.isRead)return this;this.__isRead=!0,this._triggerMessageRead();var t=this.getConversation(!1);t&&t.unreadCount--}return this._sendReceipt(e),this}},{key:"_sendReceipt",value:function(e){var t=this,n=this.getConversation(!1);n&&0===n.participants.length||(this._setSyncing(),this._xhr({url:"/receipts",method:"POST",data:{type:e},sync:{operation:"RECEIPT"}},function(){return t._setSynced()}))}},{key:"delete",value:function(e){if(this.isDestroyed)throw new Error(h.dictionary.isDestroyed);var t=void 0;switch(e){case d.DELETION_MODE.ALL:case!0:t="mode=all_participants";break;case d.DELETION_MODE.MY_DEVICES:t="mode=my_devices";break;default:throw new Error(h.dictionary.deletionModeUnsupported)}var n=this.id,i=this.getClient();this._xhr({url:"?"+t,method:"DELETE"},function(e){e.success||e.data&&("not_found"===e.data.id||"authentication_required"===e.data.id)||l.load(n,i)}),this._deleted(),this.destroy()}},{key:"toObject",value:function(){return this._toObject||(this._toObject=a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toObject",this).call(this),this._toObject.recipientStatus=p.clone(this.recipientStatus)),this._toObject}}],[{key:"_createFromServer",value:function(e,n){var i=e.fromWebsocket,r=void 0;return r=e.conversation?e.conversation.id:e.conversationId,new t({conversationId:r,fromServer:e,clientId:n.appId,_fromDB:e._fromDB,_notify:i&&e.is_unread&&e.sender.user_id!==n.user.userId})}}]),t}(l);f.prototype.isRead=!1,f.prototype.recipientStatus=null,f.prototype.readStatus=d.RECIPIENT_STATE.NONE,f.prototype.deliveryStatus=d.RECIPIENT_STATE.NONE,f.inObjectIgnore=l.inObjectIgnore,f._supportedEvents=[].concat(l._supportedEvents),c.initClass.apply(f,[f,"ConversationMessage"]),e.exports=f},sh6c:function(e,t,n){!function(){var n,i=Array.prototype.forEach,r=Object.prototype.hasOwnProperty,o=Array.prototype.slice,s=0,a=function(){return{keys:Object.keys||function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("keys() called on a non-object");var t,n=[];for(t in e)e.hasOwnProperty(t)&&(n[n.length]=t);return n},uniqueId:function(e){var t=++s+"";return e?e+t:t},has:function(e,t){return r.call(e,t)},each:function(e,t,n){if(null!=e)if(i&&e.forEach===i)e.forEach(t,n);else if(e.length===+e.length)for(var r=0,o=e.length;r<o;r++)t.call(n,e[r],r,e);else for(var s in e)this.has(e,s)&&t.call(n,e[s],s,e)},once:function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}}}}();n={on:function(e,t,n){return l(this,"on",e,[t,n])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this}),this):this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var i=this,r=a.once(function(){i.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,n)},off:function(e,t,n){var i,r,o,s,c,u,h,d;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(s=e?[e]:a.keys(this._events),c=0,u=s.length;c<u;c++)if(e=s[c],o=this._events[e]){if(this._events[e]=i=[],t||n)for(h=0,d=o.length;h<d;h++)r=o[h],(t&&t!==r.callback&&t!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&u(n,t),i&&u(i,arguments),this},stopListening:function(e,t,n){var i=this._listeners;if(!i)return this;var r=!t&&!n;"object"==typeof t&&(n=this),e&&((i={})[e._listenerId]=e);for(var o in i)i[o].off(t,n,this),r&&delete this._listeners[o];return this}};var c=/\s+/,l=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)e[t].apply(e,[r,n[r]].concat(i));return!1}if(c.test(n)){for(var o=n.split(c),s=0,a=o.length;s<a;s++)e[t].apply(e,[o[s]].concat(i));return!1}return!0},u=function(e,t){var n,i=-1,r=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,s);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,s,a);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};a.each(h,function(e,t){n[t]=function(t,n,i){return(this._listeners||(this._listeners={}))[t._listenerId||(t._listenerId=a.uniqueId("l"))]=t,"object"==typeof n&&(i=this),t[e](n,i,this),this}}),n.bind=n.on,n.unbind=n.off,n.mixin=function(e){var t=["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"];return a.each(t,function(t){e[t]=this[t]},this),e},void 0!==e&&e.exports&&(t=e.exports=n),t.BackboneEvents=n}()},"t+iR":function(e,t,n){"use strict";var i={};e.exports=i,i.Root=n("zi+W"),i.Client=n("wyU0"),i.ClientAuthenticator=n("pop0"),i.Syncable=n("zTev"),i.Conversation=n("H8F6"),i.Channel=n("VdYS"),i.Container=n("XsJf"),i.Message=n("ozQU"),i.Message.ConversationMessage=n("sDhs"),i.Message.ChannelMessage=n("PT5i"),i.Announcement=n("M3Kp"),i.MessagePart=n("b6EZ"),i.Content=n("S/PF"),i.Query=n("4wNg"),i.QueryBuilder=n("u9Qx"),i.xhr=n("EvUg"),i.Identity=n("bD8U"),i.Membership=n("ogE9"),i.LayerError=n("pLky"),i.LayerEvent=n("yUvy"),i.SyncManager=n("UD6+"),i.SyncEvent=n("jTMd").SyncEvent,i.XHRSyncEvent=n("jTMd").XHRSyncEvent,i.WebsocketSyncEvent=n("jTMd").WebsocketSyncEvent,i.Websockets={SocketManager:n("IIOl"),RequestManager:n("fYnd"),ChangeManager:n("6hGd")},i.OnlineStateManager=n("jkNz"),i.DbManager=n("2Jz9"),i.Constants=n("kesd"),i.Util=n("jPMo"),i.TypingIndicators=n("+uDm"),i.TypingIndicators.TypingListener=n("5WAC"),i.TypingIndicators.TypingPublisher=n("NOS6")},tag4:function(e,t,n){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n("zi+W"),l=n("Z/oI"),u=n("+uDm"),h=u.STARTED,d=u.PAUSED,p=u.FINISHED,f=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n._pollId=0,n._getClient().on("ready",function(){return n._clientReady()}),n}return s(t,e),a(t,[{key:"_clientReady",value:function(){var e=this._getClient();this.user=e.user,e.socketManager.on("message",this._handleSocketEvent,this),this._startPolling()}},{key:"_isRelevantEvent",value:function(e){return"signal"===e.type&&"typing_indicator"===e.body.type&&e.body.data.sender.id!==this.user.id}},{key:"_handleSocketEvent",value:function(e){var t=e.data;if(this._isRelevantEvent(t)){var n=this._getClient().getIdentity(t.body.data.sender.id)||this._getClient()._createObject(t.body.data.sender),i=t.body.data.action,r=t.body.object.id,o=this.state[r];o||(o=this.state[r]={users:{},typing:[],paused:[]}),o.users[n.id]={startTime:Date.now(),state:i,identity:n},o.users[n.id].state===p&&delete o.users[n.id],this._updateState(o,i,n.id),this.trigger("typing-indicator-change",{conversationId:r,typing:o.typing.map(function(e){return o.users[e].identity.toObject()}),paused:o.paused.map(function(e){return o.users[e].identity.toObject()})})}}},{key:"getState",value:function(e){var t=this.state[e];return t?{typing:t.typing.map(function(e){return t.users[e].identity.toObject()}),paused:t.paused.map(function(e){return t.users[e].identity.toObject()})}:{typing:[],paused:[]}}},{key:"_updateState",value:function(e,t,n){var r=e.typing.indexOf(n);t!==h&&-1!==r&&(e.typing=[].concat(i(e.typing.slice(0,r)),i(e.typing.slice(r+1))));var o=e.paused.indexOf(n);t!==d&&-1!==o&&(e.paused=[].concat(i(e.paused.slice(0,o)),i(e.paused.slice(o+1)))),t===h&&-1===r?e.typing=[].concat(i(e.typing),[n]):t===d&&-1===o&&(e.paused=[].concat(i(e.paused),[n]))}},{key:"_startPolling",value:function(){var e=this;this._pollId||(this._pollId=setInterval(function(){return e._poll()},5e3))}},{key:"_poll",value:function(){var e=this;Object.keys(this.state).forEach(function(t){var n=e.state[t];Object.keys(n.users).forEach(function(i){Date.now()>=n.users[i].startTime+6e3&&(e._updateState(n,p,i),delete n.users[i],e.trigger("typing-indicator-change",{conversationId:t,typing:n.typing.map(function(e){return n.users[e].identity.toObject()}),paused:n.paused.map(function(e){return n.users[e].identity.toObject()})}))})})}},{key:"_getClient",value:function(){return l.get(this.clientId)}}]),t}(c);f.prototype._pollId=0,f.prototype.clientId="",f.bubbleEventParent="_getClient",f._supportedEvents=["typing-indicator-change"].concat(c._supportedEvents),c.initClass.apply(f,[f,"TypingIndicatorListener"]),e.exports=f},u9Qx:function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n("4wNg"),l=function(){function e(t){s(this,e),this._query=t?{model:t.model,returnType:t.returnType,dataType:t.dataType,paginationWindow:t.paginationWindow}:{model:c.Message,returnType:"object",dataType:"object",paginationWindow:c.prototype.paginationWindow},this._conversationIdSet=!1}return a(e,[{key:"forConversation",value:function(e){return 0===e.indexOf("layer:///channels/")?(this._query.predicate="channel.id = '"+e+"'",this._conversationIdSet=!0):0===e.indexOf("layer:///conversations/")?(this._query.predicate="conversation.id = '"+e+"'",this._conversationIdSet=!0):(this._query.predicate="",this._conversationIdSet=!1),this}},{key:"paginationWindow",value:function(e){return this._query.paginationWindow=e,this}},{key:"build",value:function(){return this._query}}]),e}(),u=function(e){function t(e){s(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._query.model=c.Announcement,n}return o(t,e),a(t,[{key:"build",value:function(){return this._query}}]),t}(l),h=function(){function e(t){s(this,e),this._query=t?{model:t.model,returnType:t.returnType,dataType:t.dataType,paginationWindow:t.paginationWindow,sortBy:t.sortBy}:{model:c.Conversation,returnType:"object",dataType:"object",paginationWindow:c.prototype.paginationWindow,sortBy:null}}return a(e,[{key:"paginationWindow",value:function(e){return this._query.paginationWindow=e,this}},{key:"sortBy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._query.sortBy=[i({},e,t?"asc":"desc")],this}},{key:"build",value:function(){return this._query}}]),e}(),d=function(){function e(t){s(this,e),this._query=t?{model:t.model,returnType:t.returnType,dataType:t.dataType,paginationWindow:t.paginationWindow,sortBy:null}:{model:c.Channel,returnType:"object",dataType:"object",paginationWindow:c.prototype.paginationWindow,sortBy:null}}return a(e,[{key:"paginationWindow",value:function(e){return this._query.paginationWindow=e,this}},{key:"build",value:function(){return this._query}}]),e}(),p=function(){function e(t){s(this,e),this._query=t?{model:t.model,returnType:t.returnType,dataType:t.dataType,paginationWindow:t.paginationWindow,sortBy:null}:{model:c.Membership,returnType:"object",dataType:"object",paginationWindow:c.prototype.paginationWindow,sortBy:null}}return a(e,[{key:"paginationWindow",value:function(e){return this._query.paginationWindow=e,this}},{key:"forChannel",value:function(e){return 0===e.indexOf("layer:///channels/")?this._query.predicate="channel.id = '"+e+"'":this._query.predicate="",this}},{key:"build",value:function(){return this._query}}]),e}(),f=function(){function e(t){s(this,e),this._query=t?{model:t.model,returnType:t.returnType,dataType:t.dataType,paginationWindow:t.paginationWindow}:{model:c.Identity,returnType:"object",dataType:"object",paginationWindow:c.prototype.paginationWindow}}return a(e,[{key:"paginationWindow",value:function(e){return this._query.paginationWindow=e,this}},{key:"build",value:function(){return this._query}}]),e}(),y={messages:function(){return new l},announcements:function(){return new u},conversations:function(){return new h},channels:function(){return new d},members:function(){return new p},identities:function(){return new f},fromQueryObject:function(e){switch(e.model){case c.Message:return new l(e);case c.Announcement:return new u(e);case c.Conversation:return new h(e);case c.Channel:return new d(e);case c.Identity:return new f(e);case c.Membership:return new p(e);default:return null}}};e.exports=y},wyU0:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},l=n("pop0"),u=n("H8F6"),h=n("VdYS"),d=n("pLky").dictionary,p=n("sDhs"),f=n("PT5i"),y=n("M3Kp"),g=n("bD8U"),v=n("ogE9"),_=n("tag4"),m=n("jPMo"),b=n("zi+W"),E=n("Z/oI"),w=n("P+Qc"),k=n("5WAC"),O=n("NOS6"),C=n("g5D4"),S=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return E.register(n),n._models={},n._runMixins("constructor",[e]),n._scheduleCheckAndPurgeCacheItems=[],n._initComponents(),n.on("online",n._connectionRestored.bind(n)),w.info(m.asciiInit(t.version)),n}return o(t,e),a(t,[{key:"_initComponents",value:function(){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_initComponents",this).call(this),this._typingIndicators=new _({clientId:this.appId}),this.telemetryMonitor=new C({client:this,enabled:this.telemetryEnabled})}},{key:"_cleanup",value:function(){if(!this.isDestroyed){this._inCleanup=!0;try{this._runMixins("cleanup",[])}catch(e){w.error(e)}this.socketManager&&this.socketManager.close(),this._inCleanup=!1}}},{key:"destroy",value:function(){this._cleanup(),this._destroyComponents(),E.unregister(this),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this._inCleanup=!1}},{key:"__adjustAppId",value:function(){if(this.appId)throw new Error(d.appIdImmutable)}},{key:"_fixIdentities",value:function(e){var t=this;return e.map(function(e){if(e instanceof g)return e;if("string"==typeof e)return t.getIdentity(e,!0);if(e&&"object"===(void 0===e?"undefined":s(e))){if("userId"in e)return t.getIdentity(e.id||e.userId);if("user_id"in e)return t._createObject(e)}return null})}},{key:"getObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(m.typeFromID(e)){case"messages":case"announcements":return this.getMessage(e,t);case"conversations":return this.getConversation(e,t);case"channels":return this.getChannel(e,t);case"queries":return this.getQuery(e);case"identities":return this.getIdentity(e,t);case"members":return this.getMember(e,t)}return null}},{key:"_createObject",value:function(e){var t=this.getObject(e.id);if(t)return t._populateFromServer(e),t;switch(m.typeFromID(e.id)){case"messages":if(e.conversation)return p._createFromServer(e,this);if(e.channel)return f._createFromServer(e,this);break;case"announcements":return y._createFromServer(e,this);case"conversations":return u._createFromServer(e,this);case"channels":return h._createFromServer(e,this);case"identities":return g._createFromServer(e,this);case"members":return v._createFromServer(e,this)}return null}},{key:"_updateContainerId",value:function(e,t){e instanceof u?this._updateConversationId(e,t):this._updateChannelId(e,t)}},{key:"_processDelayedTriggers",value:function(){if(!this.isDestroyed){var e=this._delayedTriggers.filter(function(e){return"conversations:add"===e[0]}),n=this._delayedTriggers.filter(function(e){return"conversations:remove"===e[0]});this._foldEvents(e,"conversations",this),this._foldEvents(n,"conversations",this);var i=this._delayedTriggers.filter(function(e){return"messages:add"===e[0]}),r=this._delayedTriggers.filter(function(e){return"messages:remove"===e[0]});this._foldEvents(i,"messages",this),this._foldEvents(r,"messages",this);var o=this._delayedTriggers.filter(function(e){return"identities:add"===e[0]}),s=this._delayedTriggers.filter(function(e){return"identities:remove"===e[0]});this._foldEvents(o,"identities",this),this._foldEvents(s,"identities",this),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_processDelayedTriggers",this).call(this)}}},{key:"trigger",value:function(e,n){this._triggerLogger(e,n),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"trigger",this).call(this,e,n)}},{key:"_triggerLogger",value:function(e,t){if(-1!==["conversations:add","conversations:remove","conversations:change","messages:add","messages:remove","messages:change","identities:add","identities:remove","identities:change","challenge","ready"].indexOf(e)){if(t&&t.isChange)w.info("Client Event: "+e+" "+t.changes.map(function(e){return e.property}).join(", "));else{var n="";t&&(t.message&&(n=t.message.id),t.messages&&(n=t.messages.length+" messages"),t.conversation&&(n=t.conversation.id),t.conversations&&(n=t.conversations.length+" conversations"),t.channel&&(n=t.channel.id),t.channels&&(n=t.channels.length+" channels")),w.info("Client Event: "+e+" "+n)}t&&w.debug(t)}else w.debug(e,t)}},{key:"_resetSession",value:function(){return this._cleanup(),this._runMixins("reset",[]),c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_resetSession",this).call(this)}},{key:"_checkAndPurgeCache",value:function(e){var t=this;this._inCheckAndPurgeCache=!0,e.forEach(function(e){e.isDestroyed||t._isCachedObject(e)||(e instanceof b==0&&(e=t.getObject(e.id)),e&&e.destroy())}),this._inCheckAndPurgeCache=!1}},{key:"_scheduleCheckAndPurgeCache",value:function(e){var n=this;e.isSaved()&&(this._scheduleCheckAndPurgeCacheAt<Date.now()&&(this._scheduleCheckAndPurgeCacheAt=Date.now()+t.CACHE_PURGE_INTERVAL,setTimeout(function(){return n._runScheduledCheckAndPurgeCache()},t.CACHE_PURGE_INTERVAL)),this._scheduleCheckAndPurgeCacheItems.push(e))}},{key:"_runScheduledCheckAndPurgeCache",value:function(){var e=this._scheduleCheckAndPurgeCacheItems;this._scheduleCheckAndPurgeCacheItems=[],this._checkAndPurgeCache(e),this._scheduleCheckAndPurgeCacheAt=0}},{key:"_isCachedObject",value:function(e){for(var t=Object.keys(this._models.queries),n=0;n<t.length;n++)if(this._models.queries[t[n]]._getItem(e.id))return!0;return!1}},{key:"_connectionRestored",value:function(e){var t=this;e.reset&&(w.debug("Client Connection Restored; Resetting all Queries"),this.dbManager.deleteTables(function(){t.dbManager._open(),Object.keys(t._models.queries).forEach(function(e){var n=t._models.queries[e];n&&n.reset()})}))}},{key:"createTypingListener",value:function(e){return new k({clientId:this.appId,input:e})}},{key:"createTypingPublisher",value:function(){return new O({clientId:this.appId})}},{key:"getTypingState",value:function(e){return this._typingIndicators.getState(e)}}],[{key:"getClient",value:function(e){return E.get(e)}},{key:"destroyAllClients",value:function(){E.getAll().forEach(function(e){return e.destroy()})}},{key:"addListenerForNewClient",value:function(e){E.addListener(e)}},{key:"removeListenerForNewClient",value:function(e){E.removeListener(e)}}]),t}(l);S.prototype._scheduleCheckAndPurgeCacheItems=null,S.prototype._scheduleCheckAndPurgeCacheAt=0,S.prototype.telemetryEnabled=!0,S.prototype.telemetryMonitor=null,S.prototype._tabId=m.generateUUID(),S.version="3.4.13",S.CACHE_PURGE_INTERVAL=72e5,S._ignoredEvents=["conversations:loaded","conversations:loaded-error"],S._supportedEvents=["typing-indicator-change"].concat(l._supportedEvents),S.mixins=[n("XoSQ"),n("iqth"),n("bONa"),n("oXlP"),n("TGOB"),n("36Uf"),n("nFsS")],b.initClass.apply(S,[S,"Client"]),e.exports=S},xrGV:function(e,t){e.exports="//static.naukimg.com/s/5/102/i/chat-feedback.png"},yUvy:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,n){var r=this;i(this,e);var o=this;n.match(/:change$/)?(this.changes=[{}],o=this.changes[0],this.isChange=!0):this.isChange=!1,Object.keys(t).forEach(function(e){o!==r&&"target"===e?r.target=t.target:o[e]=t[e]}),this.eventName=n}return r(e,[{key:"hasProperty",value:function(e){return!!this.isChange&&Boolean(this.changes.filter(function(t){return t.property===e}).length)}},{key:"getChangesFor",value:function(e){return this.isChange?this.changes.filter(function(t){return t.property===e}):[]}},{key:"_mergeChanges",value:function(e){this.changes=this.changes.concat(e.changes)}}]),e}();o.prototype.isChange=!1,o.prototype.changes=null,o.prototype.target=null,o.prototype.eventName="",e.exports=o},zTev:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},c=n("zi+W"),l=n("kesd"),u=l.SYNC_STATE,h=n("pLky"),d=n("Z/oI"),p=n("kesd"),f=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.localCreatedAt=new Date,n}return o(t,e),s(t,[{key:"getClient",value:function(){return d.get(this.clientId)}},{key:"_xhr",value:function(e,t){var n=this;e.url||(e.url=""),e.method||(e.method="GET");var i=this.getClient();if(this.isDestroyed)throw new Error(h.dictionary.isDestroyed);if(!i)throw new Error(h.dictionary.clientMissing);return this.constructor.enableOpsIfNew||"POST"===e.method||"GET"===e.method||this.syncState!==p.SYNC_STATE.NEW?(e.url.match(/^https?:\/\//)||(e.url&&!e.url.match(/^(\/|\?)/)&&(e.url="/"+e.url),e.sync||(e.url=this.url+e.url)),e.sync=this._setupSyncObject(e.sync),"GET"!==e.method&&this._setSyncing(),i.xhr(e,function(i){i.success&&"GET"!==e.method&&!n.isDestroyed&&n._setSynced(),t&&t(i)}),this):this}},{key:"_setupSyncObject",value:function(e){return!1!==e&&(e||(e={}),e.target||(e.target=this.id)),e}},{key:"_handleWebsocketDelete",value:function(e){this._deleted(),this.destroy()}},{key:"_deleted",value:function(){this.trigger(this.constructor.eventPrefix+":delete")}},{key:"_load",value:function(){var e=this;this.syncState=u.LOADING,this._xhr({method:"GET",sync:!1},function(t){return e._loadResult(t)})}},{key:"_loadResult",value:function(e){var t=this;if(!this.isDestroyed){var n=this.constructor.eventPrefix;e.success?(this._populateFromServer(e.data),this._loaded(e.data),this.trigger(n+":loaded")):(this.syncState=u.NEW,this._triggerAsync(n+":loaded-error",{error:e.data}),setTimeout(function(){t.isDestroyed||t.destroy()},100))}}},{key:"_loaded",value:function(e){}},{key:"_setSyncing",value:function(){switch(this._clearObject(),this.syncState){case u.SYNCED:this.syncState=u.SYNCING;break;case u.NEW:this.syncState=u.SAVING}this._syncCounter++}},{key:"_setSynced",value:function(){this._clearObject(),this._syncCounter>0&&this._syncCounter--,this.syncState=0===this._syncCounter?u.SYNCED:u.SYNCING,this.isSending=!1}},{key:"_clearObject",value:function(){this._toObject=null}},{key:"toObject",value:function(){return this._toObject||(this._toObject=a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toObject",this).call(this),this._toObject.isNew=this.isNew(),this._toObject.isSaving=this.isSaving(),this._toObject.isSaved=this.isSaved(),this._toObject.isSynced=this.isSynced()),this._toObject}},{key:"isNew",value:function(){return this.syncState===u.NEW}},{key:"isSaving",value:function(){return this.syncState===u.SAVING}},{key:"isSaved",value:function(){return!(this.isNew()||this.isSaving())}},{key:"isSynced",value:function(){return this.syncState===u.SYNCED}}],[{key:"load",value:function(e,n){if(!(n&&n instanceof c))throw new Error(h.dictionary.clientMissing);var i={id:e,url:n.url+e.substring(8),clientId:n.appId};t.sortedSubclasses||(t.sortedSubclasses=t.subclasses.filter(function(e){return e.prefixUUID}).sort(function(e,t){return e.prefixUUID.length-t.prefixUUID.length}));var r=t.sortedSubclasses.filter(function(e){return 0===e.prefixUUID.indexOf("layer:///")?0===i.id.indexOf(e.prefixUUID):-1!==i.id.indexOf(e.prefixUUID)})[0],o=new r(i),s=r.eventPrefix;return s?n.dbManager?n.dbManager.getObject(s,e,function(e){o.isDestroyed||(e?(o._populateFromServer(e),o.trigger(s+":loaded")):n.isReady?o._load():(o.syncState=u.LOADING,n.once("ready",function(){return o._load()})))}):(o.syncState=u.LOADING,n.once("ready",function(){return o._load()})):o._load(),o.syncState=u.LOADING,o}}]),t}(c);f.prototype.id="",f.prototype.url="",f.prototype.localCreatedAt=null,f.prototype.clientId="",f.prototype._fromDB=!1,f.prototype.syncState=u.NEW,f.prototype._syncCounter=0,f.eventPrefix="",f.enableOpsIfNew=!1,Object.defineProperty(f.prototype,"isLoading",{enumerable:!0,get:function(){return this.syncState===u.LOADING}}),f.subclasses=[],f._supportedEvents=[].concat(c._supportedEvents),f.inObjectIgnore=c.inObjectIgnore,e.exports=f},"zi+W":function(e,t,n){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(){}function c(e,t){var n="__"+t,i=t.substring(0,1).toUpperCase()+t.substring(1);(e.prototype["__adjust"+i]||e.prototype["__update"+i]||e.prototype["__get"+i])&&(e.prototype[n]=e.prototype[t],Object.defineProperty(e.prototype,t,{enumerable:!0,get:function(){return this["__get"+i]?this["__get"+i](n):this[n]},set:function(e){if(!this.isDestroyed){var t=this[n];if(e!==t){if(this["__adjust"+i]){var r=this["__adjust"+i](e);void 0!==r&&(e=r)}this[n]=e}e!==t&&!this.isInitializing&&this["__update"+i]&&this["__update"+i](e,t)}}}))}function l(e,t){e.name||(e.name=t),e._supportedEvents||(e._supportedEvents=b._supportedEvents),e._ignoredEvents||(e._ignoredEvents=b._ignoredEvents),e.mixins&&e.mixins.forEach(function(t){t.events&&(e._supportedEvents=e._supportedEvents.concat(t.events)),t.properties&&Object.keys(t.properties).forEach(function(n){e.prototype[n]=t.properties[n]}),t.methods&&Object.keys(t.methods).forEach(function(n){e.prototype[n]=t.methods[n]})}),Object.keys(e.prototype).filter(function(t){return e.prototype.hasOwnProperty(t)&&!b.prototype.hasOwnProperty(t)&&"function"!=typeof e.prototype[t]}).forEach(function(t){return c(e,t)})}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),d=n("jPMo"),p=n("yUvy"),f=n("pLky"),y=n("sh6c"),g=n("P+Qc");a.prototype=y;var v=new a;"function"==typeof postMessage&&addEventListener("message",function(e){"layer-delayed-event"===e.data.type&&v.trigger(e.data.internalId+"-delayed-event")});var _={},m=/\s+/,b=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n._layerEventSubscriptions=[],n._delayedTriggers=[],n._lastDelayedTrigger=Date.now(),n._events={};var i=n.constructor.name;_[i]||(_[i]=0),n.internalId=i+_[i]++,v.on(n.internalId+"-delayed-event",n._processDelayedTriggers,n),n.id||e.id||!n.constructor.prefixUUID||(n.id=n.constructor.prefixUUID+d.generateUUID());var s=void 0;for(s in e)-1!==n.constructor._supportedEvents.indexOf(s)?n.on(s,e[s]):s in n&&"function"!=typeof n[s]&&(n[s]=e[s]);return n.isInitializing=!1,n}return s(t,e),h(t,[{key:"destroy",value:function(){var e=this;if(this.isDestroyed)throw new Error(f.dictionary.alreadyDestroyed);this.trigger("destroy"),v.off(this.internalId+"-delayed-event",null,this),this.off(),this._layerEventSubscriptions.forEach(function(t){return t.off(null,null,e)}),this._layerEventSubscriptions=null,this._delayedTriggers=null,this.isDestroyed=!0}},{key:"toObject",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.__inToObject=!0;var i={};try{var r=[],o=void 0;for(o in this.constructor.prototype)o in t.prototype||r.push(o);r.forEach(function(r){var o=e[r];0!==r.indexOf("_")&&"function"!=typeof o&&(Array.isArray(o)?(i[r]=[],o.forEach(function(e){e instanceof t?n?delete i[r]:e.__inToObject||i[r].push(e.toObject()):i[r].push(e)})):o instanceof t?o.__inToObject||n||(i[r]=o.toObject()):o instanceof Date?i[r]=new Date(o):i[r]=o)})}catch(e){}return this.__inToObject=!1,i}},{key:"_warnForEvent",value:function(e){if(!d.includes(this.constructor._supportedEvents,e))throw new Error("Event "+e+" not defined for "+this.toString())}},{key:"_prepareOn",value:function(e,n,i){var r=this;if(i){if(i instanceof t&&i.isDestroyed)throw new Error(f.dictionary.isDestroyed);i._layerEventSubscriptions&&i._layerEventSubscriptions.push(this)}if("string"==typeof e&&"all"!==e)if(m.test(e)){var o=e.split(m);o.forEach(function(e){return r._warnForEvent(e)})}else this._warnForEvent(e);else e&&"object"===(void 0===e?"undefined":u(e))&&Object.keys(e).forEach(function(e){return r._warnForEvent(e)})}},{key:"on",value:function(e,t,n){return this._prepareOn(e,t,n),y.on.apply(this,[e,t,n]),this}},{key:"once",value:function(e,t,n){return this._prepareOn(e,t,n),y.once.apply(this,[e,t,n]),this}},{key:"trigger",value:function(){return this._disableEvents?this:this._trigger.apply(this,arguments)}},{key:"_trigger",value:function(){if(!d.includes(this.constructor._supportedEvents,arguments.length<=0?void 0:arguments[0]))return void(d.includes(this.constructor._ignoredEvents,arguments.length<=0?void 0:arguments[0])||g.error(this.toString()+" ignored "+(arguments.length<=0?void 0:arguments[0])));var e=this._getTriggerArgs.apply(this,arguments);y.trigger.apply(this,e);var t=this.constructor.bubbleEventParent;if(t&&"destroy"!==(arguments.length<=0?void 0:arguments[0])){var n,r=this[t];(r="function"==typeof r?r.apply(this):r)&&(n=r).trigger.apply(n,i(e))}}},{key:"_getTriggerArgs",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=Array.prototype.slice.call(t);if(t[1]){var r={target:this};i[1]instanceof p||("object"===u(i[1])?Object.keys(i[1]).forEach(function(e){return r[e]=i[1][e]}):r.data=i[1],i[1]=new p(r,i[0]))}else i[1]=new p({target:this},i[0]);return i}},{key:"_triggerAsync",value:function(){var e=this,t=this._getTriggerArgs.apply(this,arguments);if(this._delayedTriggers.push(t),1===this._delayedTriggers.length||this._delayedTriggers.length&&this._lastDelayedTrigger+500<Date.now())if(this._lastDelayedTrigger=Date.now(),"function"==typeof postMessage&&"undefined"==typeof jasmine){var n={type:"layer-delayed-event",internalId:this.internalId};"undefined"!=typeof document?window.postMessage(n,"*"):window.postMessage(n)}else setTimeout(function(){return e._processDelayedTriggers()},0)}},{key:"_foldEvents",value:function(e,t,n){var i=this,r=e.length?e[0][1]:null,o=r?r[t]:null;e.forEach(function(e,n){n>0&&(o.push(e[1][t][0]),i._delayedTriggers.splice(i._delayedTriggers.indexOf(e),1))}),e.length&&n&&(e[0][1].target=n)}},{key:"_foldChangeEvents",value:function(){var e=this,t=this._delayedTriggers.filter(function(e){return e[1].isChange});t.forEach(function(n,i){i>0&&(t[0][1]._mergeChanges(n[1]),e._delayedTriggers.splice(e._delayedTriggers.indexOf(n),1))})}},{key:"_processDelayedTriggers",value:function(){this.isDestroyed||(this._foldChangeEvents(),this._delayedTriggers.forEach(function(e){this.trigger.apply(this,i(e))},this),this._delayedTriggers=[])}},{key:"_runMixins",value:function(e,t){var n=this;this.constructor.mixins.forEach(function(i){i.lifecycle[e]&&i.lifecycle[e].apply(n,t)})}},{key:"toString",value:function(){return this.internalId}}],[{key:"isValidId",value:function(e){return 0===e.indexOf(this.prefixUUID)}}]),t}(a);b.prototype.isDestroyed=!1,b.prototype.internalId="",b.prototype.isInitializing=!0,b.prototype._layerEventSubscriptions=null,b.prototype._disableEvents=!1,b._supportedEvents=["destroy","all"],b._ignoredEvents=[],e.exports=b,e.exports.initClass=l}});